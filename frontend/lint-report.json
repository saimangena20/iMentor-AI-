[{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\public\\pdf.worker.min.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\App.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[1358,1365],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/App.jsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Navigate, useNavigate, useLocation } from 'react-router-dom';\r\nimport { useAuth as useRegularAuth } from './hooks/useAuth.jsx';\r\nimport { useAppState } from './contexts/AppStateContext.jsx';\r\nimport AuthModal from './components/auth/AuthModal.jsx';\r\nimport TopNav from './components/layout/TopNav.jsx';\r\nimport LeftPanel from './components/layout/LeftPanel.jsx';\r\nimport CenterPanel from './components/layout/CenterPanel.jsx';\r\nimport RightPanel from './components/layout/RightPanel.jsx';\r\nimport LeftCollapsedNav from './components/layout/LeftCollapsedNav.jsx';\r\nimport RightCollapsedNav from './components/layout/RightCollapsedNav.jsx';\r\nimport ChatHistoryModal from './components/chat/ChatHistoryModal.jsx';\r\nimport AdminDashboardPage from './components/admin/AdminDashboardPage.jsx';\r\nimport AdminProtectedRoute from './components/admin/AdminProtectedRoute.jsx';\r\nimport CodeExecutorPage from './components/tools/CodeExecutorPage.jsx';\r\nimport StudyPlanPage from './components/learning/StudyPlanPage.jsx';\r\nimport QuizGeneratorPage from './components/tools/QuizGeneratorPage.jsx';\r\nimport api from './services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport { GraduationCap } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport Button from './components/core/Button.jsx';\r\nimport AcademicIntegrityPage from './components/tools/AcademicIntegrityPage.jsx';\r\nimport LandingPage from './components/landing/LandingPage.jsx';\r\nimport OnboardingFlow from './components/onboarding/OnboardingFlow.jsx';\r\nimport AnalyticsDashboardPage from './components/admin/AnalyticsDashboardPage.jsx';\r\n// Gamification Components\r\nimport BountyCreditsPage from './components/gamification/BountyCreditsPage.jsx';\r\nimport BossBattles from './components/gamification/BossBattles.jsx';\r\nimport BadgesShowcase from './components/gamification/BadgesShowcase.jsx';\r\n// import LearningProfile from './components/learning/LearningProfile.jsx'; // File doesn't exist\r\nimport SkillTreeMap from './components/gamification/SkillTreeMap.jsx';\r\nimport SkillTreeLanding from './components/gamification/SkillTreeLanding.jsx';\r\nimport SkillTreeGameMap from './components/gamification/SkillTreeGameMap.jsx';\r\nimport SkillTreeGames from './components/gamification/SkillTreeGames.jsx';\r\n\r\n\r\n\r\nfunction SessionLoadingModal() {\r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[9999]\">\r\n            <motion.div\r\n                key=\"session-loading-modal\"\r\n                initial={{ opacity: 0, scale: 0.9 }}\r\n                animate={{ opacity: 1, scale: 1 }}\r\n                exit={{ opacity: 0, scale: 0.9 }}\r\n                className=\"bg-surface-light dark:bg-surface-dark rounded-xl shadow-2xl p-8 w-full max-w-md text-center\"\r\n            >\r\n                <div className=\"flex justify-center items-center mb-4\">\r\n                    <div className=\"animate-spin rounded-full h-10 w-10 border-t-4 border-b-4 border-primary\"></div>\r\n                </div>\r\n                <h2 className=\"text-xl font-bold text-text-light dark:text-text-dark mb-2\">Finalizing Session...</h2>\r\n                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">\r\n                    Summarizing key points and identifying topics for your future recommendations.\r\n                </p>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction MainAppLayout({\r\n    orchestratorStatus,\r\n    handleNewChat,\r\n    isSessionLoading,\r\n    messages,\r\n    setMessages\r\n}) {\r\n    const { user: regularUser, logout: regularUserLogout } = useRegularAuth();\r\n    const {\r\n        currentSessionId,\r\n        isLeftPanelOpen,\r\n        isRightPanelOpen,\r\n        setSessionId: setGlobalSessionId,\r\n        initialPromptForNewSession,\r\n        setInitialPromptForNewSession,\r\n        initialActivityForNewSession,\r\n        setInitialActivityForNewSession\r\n    } = useAppState();\r\n    const [isHistoryModalOpen, setIsHistoryModalOpen] = useState(false);\r\n    const [isChatProcessing, setIsChatProcessing] = useState(false);\r\n\r\n    const handleChatProcessingStatusChange = (isLoading) => {\r\n        setIsChatProcessing(isLoading);\r\n    };\r\n\r\n    const handleRegularUserLogout = () => {\r\n        regularUserLogout();\r\n        setGlobalSessionId(null);\r\n    };\r\n\r\n    const handleSelectSessionFromHistory = (sessionId) => {\r\n        if (sessionId && sessionId !== currentSessionId) {\r\n            setGlobalSessionId(sessionId);\r\n            toast.success(`Loading session...`);\r\n        }\r\n        setIsHistoryModalOpen(false);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <AnimatePresence>\r\n                {isSessionLoading && <SessionLoadingModal />}\r\n            </AnimatePresence>\r\n\r\n            <TopNav\r\n                user={regularUser}\r\n                onLogout={handleRegularUserLogout}\r\n                onNewChat={handleNewChat}\r\n                onHistoryClick={() => setIsHistoryModalOpen(true)}\r\n                orchestratorStatus={orchestratorStatus}\r\n                isChatProcessing={isChatProcessing}\r\n            />\r\n            <div className=\"flex flex-1 overflow-hidden pt-16 bg-background-light dark:bg-background-dark\">\r\n                <AnimatePresence mode=\"wait\">\r\n                    {isLeftPanelOpen ? (\r\n                        <motion.aside key=\"left-panel-main\" initial={{ x: '-100%' }} animate={{ x: '0%' }} exit={{ x: '-100%' }} transition={{ type: 'spring', stiffness: 300, damping: 30 }} className=\"w-full md:w-72 lg:w-80 xl:w-96 bg-surface-light dark:bg-surface-dark border-r border-border-light dark:border-border-dark overflow-y-auto p-3 sm:p-4 shadow-lg flex-shrink-0 custom-scrollbar\">\r\n                            <LeftPanel isChatProcessing={isChatProcessing} />\r\n                        </motion.aside>\r\n                    ) : (<LeftCollapsedNav isChatProcessing={isChatProcessing} />)}\r\n                </AnimatePresence>\r\n                <main className={`flex-1 flex flex-col overflow-hidden p-1 sm:p-2 md:p-4 transition-all duration-300 ease-in-out ${isLeftPanelOpen ? 'lg:ml-0' : 'lg:ml-16 md:ml-14'} ${isRightPanelOpen ? 'lg:mr-0' : 'lg:mr-16 md:mr-14'}`}>\r\n                    <CenterPanel\r\n                        messages={messages}\r\n                        setMessages={setMessages}\r\n                        currentSessionId={currentSessionId}\r\n                        onChatProcessingChange={handleChatProcessingStatusChange}\r\n                        initialPromptForNewSession={initialPromptForNewSession}\r\n                        setInitialPromptForNewSession={setInitialPromptForNewSession}\r\n                        initialActivityForNewSession={initialActivityForNewSession}\r\n                        setInitialActivityForNewSession={setInitialActivityForNewSession}\r\n                    />\r\n                </main>\r\n                <AnimatePresence mode=\"wait\">\r\n                    {isRightPanelOpen ? (\r\n                        <motion.aside key=\"right-panel-main\" initial={{ x: '100%' }} animate={{ x: '0%' }} exit={{ x: '100%' }} transition={{ type: 'spring', stiffness: 300, damping: 30 }} className=\"hidden md:flex md:flex-col md:w-72 lg:w-80 xl:w-96 bg-surface-light dark:bg-surface-dark border-l border-border-light dark:border-border-dark overflow-y-auto p-3 sm:p-4 shadow-lg flex-shrink-0 custom-scrollbar\">\r\n                            <RightPanel isChatProcessing={isChatProcessing} /> {/* Pass the prop */}\r\n                        </motion.aside>\r\n                    ) : (<RightCollapsedNav isChatProcessing={isChatProcessing} />)} {/* Pass the prop */}\r\n                </AnimatePresence>\r\n            </div>\r\n            <ChatHistoryModal isOpen={isHistoryModalOpen} onClose={() => setIsHistoryModalOpen(false)} onSelectSession={handleSelectSessionFromHistory} />\r\n        </>\r\n    );\r\n}\r\n\r\nfunction App() {\r\n    const { token: regularUserToken, user: regularUser, loading: regularUserAuthLoading, setUser: setRegularUserInAuthContext } = useRegularAuth();\r\n    const {\r\n        theme,\r\n        setSessionId: setGlobalSessionId,\r\n        currentSessionId,\r\n        isAdminSessionActive,\r\n        setIsAdminSessionActive,\r\n    } = useAppState();\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const [appInitializing, setAppInitializing] = useState(true);\r\n    const [showAuthModal, setShowAuthModal] = useState(false);\r\n    const [orchestratorStatus, setOrchestratorStatus] = useState({ status: \"loading\", message: \"Connecting...\" });\r\n    const [isSessionLoading, setIsSessionLoading] = useState(false);\r\n    const [appStateMessages, setAppStateMessages] = useState([]);\r\n    const [isCreatingSession, setIsCreatingSession] = useState(false);\r\n    const [isLoginViewInModal, setIsLoginViewInModal] = useState(true);\r\n    const [isAwaitingOnboarding, setIsAwaitingOnboarding] = useState(false);\r\n\r\n    const handleNewChat = useCallback(async (callback, forceNewChat = false, skipSessionAnalysis = false) => {\r\n\r\n        const actualCallback = typeof callback === 'function' ? callback : null;\r\n        const messages = appStateMessages;\r\n\r\n        if (!forceNewChat && messages.length === 0 && currentSessionId) {\r\n            toast('This is already a new chat!', { icon: 'âœ¨' });\r\n            if (actualCallback) currentSessionId(currentSessionId);\r\n            return;\r\n        }\r\n\r\n        setIsSessionLoading(true);\r\n        try {\r\n            const data = await api.startNewSession(currentSessionId, skipSessionAnalysis);\r\n            if (data && data.newSessionId) {\r\n                setGlobalSessionId(data.newSessionId);\r\n                if (data.studyPlanSuggestion) {\r\n                    const { topic, reason } = data.studyPlanSuggestion;\r\n                    toast.custom((t) => (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: -20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            exit={{ opacity: 0, y: -20 }}\r\n                            className=\"bg-surface-light dark:bg-surface-dark shadow-lg rounded-lg p-4 w-96 border border-border-light dark:border-border-dark\"\r\n                        >\r\n                            <div className=\"flex items-start\">\r\n                                <div className=\"flex-shrink-0 pt-0.5\"><GraduationCap className=\"h-6 w-6 text-primary\" /></div>\r\n                                <div className=\"ml-3 flex-1\">\r\n                                    <p className=\"text-sm font-semibold text-text-light dark:text-text-dark\">Personalized Study Plan Suggestion</p>\r\n                                    <p className=\"mt-1 text-sm text-text-muted-light dark:text-text-muted-dark\">{reason}</p>\r\n                                    <div className=\"mt-4 flex gap-2\">\r\n                                        <Button size=\"sm\" onClick={() => { navigate('/study-plan', { state: { prefilledGoal: topic } }); toast.dismiss(t.id); }}>\r\n                                            Create Plan for \"{topic}\"\r\n                                        </Button>\r\n                                        <Button size=\"sm\" variant=\"secondary\" onClick={() => toast.dismiss(t.id)}>Dismiss</Button>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    ), { id: `study-plan-toast-${topic}`, duration: Infinity });\r\n                }\r\n                if (actualCallback) {\r\n                    if (!skipSessionAnalysis) {\r\n                        toast.success(\"New chat started!\");\r\n                    }\r\n                    actualCallback(data.newSessionId);\r\n                } else if (!skipSessionAnalysis) {\r\n                    // If no callback, but it's a user-initiated new chat, still show the toast.\r\n                    toast.success(\"New chat started!\");\r\n                }\r\n            } else {\r\n                toast.error(data.message || \"Could not start new chat session.\");\r\n                if (actualCallback) actualCallback(null);\r\n            }\r\n        } catch (error) {\r\n            toast.error(`Failed to start new chat: ${error.message}`);\r\n            if (actualCallback) actualCallback(null);\r\n        } finally {\r\n            setIsSessionLoading(false);\r\n        }\r\n    }, [currentSessionId, setGlobalSessionId, navigate, appStateMessages]);\r\n\r\n    const fetchChatHistory = useCallback(async (sid) => {\r\n        if (!sid || !regularUserToken) {\r\n            setAppStateMessages([]);\r\n            return;\r\n        }\r\n        try {\r\n            const sessionData = await api.getChatHistory(sid);\r\n            setAppStateMessages(Array.isArray(sessionData.messages) ? sessionData.messages : []);\r\n        } catch (error) {\r\n            if (error.response && error.response.status === 404) {\r\n                console.warn(\"Stale session ID found. It will be replaced.\");\r\n                localStorage.removeItem('aiTutorSessionId');\r\n                setGlobalSessionId(null);\r\n            } else {\r\n                toast.error(`History load failed: ${error.message}`);\r\n            }\r\n        }\r\n    }, [regularUserToken, setGlobalSessionId]);\r\n\r\n    useEffect(() => {\r\n        if (currentSessionId && regularUserToken) {\r\n            fetchChatHistory(currentSessionId);\r\n        } else if (!regularUserToken) {\r\n            setAppStateMessages([]);\r\n        }\r\n    }, [currentSessionId, regularUserToken, fetchChatHistory]);\r\n\r\n    useEffect(() => { document.documentElement.className = theme; }, [theme]);\r\n    useEffect(() => { api.getOrchestratorStatus().then(setOrchestratorStatus); }, []);\r\n\r\n    useEffect(() => {\r\n        const handleAuthAndSession = async () => {\r\n            if (isAdminSessionActive) {\r\n                setAppInitializing(false); setShowAuthModal(false);\r\n                if (!location.pathname.startsWith('/admin')) navigate('/admin/dashboard', { replace: true });\r\n                return;\r\n            }\r\n            if (regularUserAuthLoading) {\r\n                setAppInitializing(true); return;\r\n            }\r\n            setAppInitializing(false);\r\n\r\n            if (regularUserToken && regularUser) {\r\n                if (regularUser.hasCompletedOnboarding === false) {\r\n                    setIsAwaitingOnboarding(true);\r\n                    return;\r\n                }\r\n                if (isAwaitingOnboarding) setIsAwaitingOnboarding(false);\r\n\r\n                setShowAuthModal(false);\r\n                document.body.classList.remove('landing-page-body');\r\n\r\n                if (location.pathname.startsWith('/admin')) navigate('/', { replace: true });\r\n\r\n                const shouldCreateSession = !currentSessionId && !location.pathname.startsWith('/tools') && !location.pathname.startsWith('/study-plan');\r\n                if (shouldCreateSession && !isCreatingSession) {\r\n                    setIsCreatingSession(true);\r\n                    await handleNewChat(() => { }, true, true);\r\n                    setIsCreatingSession(false);\r\n                }\r\n            } else {\r\n                document.body.classList.add('landing-page-body');\r\n            }\r\n        };\r\n        handleAuthAndSession();\r\n    }, [\r\n        regularUserAuthLoading, regularUserToken, regularUser, isAdminSessionActive,\r\n        currentSessionId, navigate, location.pathname, handleNewChat, isCreatingSession, isAwaitingOnboarding\r\n    ]);\r\n\r\n    const handleAuthSuccess = (authData) => {\r\n        setShowAuthModal(false);\r\n        // --- THIS IS THE FIX (Part 1): Centralize state logic here ---\r\n        if (authData?.isAdminLogin) {\r\n            setIsAdminSessionActive(true);\r\n            // The main useEffect will now handle the navigation\r\n        } else if (authData?.token) {\r\n            setGlobalSessionId(null);\r\n            if (authData.email && authData._id) {\r\n                const userForContext = {\r\n                    id: authData._id,\r\n                    email: authData.email,\r\n                    username: authData.username,\r\n                    hasCompletedOnboarding: authData.hasCompletedOnboarding\r\n                };\r\n                setRegularUserInAuthContext(userForContext);\r\n                // The main useEffect will handle onboarding check\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleOnboardingComplete = () => {\r\n        if (regularUser) {\r\n            setRegularUserInAuthContext({ ...regularUser, hasCompletedOnboarding: true });\r\n        }\r\n        setIsAwaitingOnboarding(false);\r\n    };\r\n\r\n    const openAuthModal = (isLogin = true) => {\r\n        setIsLoginViewInModal(isLogin);\r\n        setShowAuthModal(true);\r\n    };\r\n\r\n    if (appInitializing) {\r\n        return (\r\n            <div className=\"fixed inset-0 flex items-center justify-center bg-background-light dark:bg-background-dark\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-t-4 border-b-4 border-primary\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-screen overflow-hidden font-sans\">\r\n            <AnimatePresence>\r\n                {showAuthModal && (\r\n                    <AuthModal\r\n                        isOpen={showAuthModal}\r\n                        onClose={handleAuthSuccess}\r\n                        initialViewIsLogin={isLoginViewInModal}\r\n                    />\r\n                )}\r\n                {isAwaitingOnboarding &&\r\n                    <OnboardingFlow onComplete={handleOnboardingComplete} />\r\n                }\r\n            </AnimatePresence>\r\n            {/* --- THIS IS THE FIX (Part 2): Restructured Routing --- */}\r\n            <Routes>\r\n                {isAdminSessionActive ? (\r\n                    <>\r\n                        <Route path=\"/admin/dashboard\" element={<AdminProtectedRoute><AdminDashboardPage /></AdminProtectedRoute>} />\r\n                        <Route path=\"/admin/analytics\" element={<AdminProtectedRoute><AnalyticsDashboardPage /></AdminProtectedRoute>} />\r\n                        <Route path=\"/*\" element={<Navigate to=\"/admin/dashboard\" replace />} />\r\n                    </>\r\n                ) : regularUserToken && regularUser ? (\r\n                    <>\r\n                        <Route path=\"/tools/code-executor\" element={<CodeExecutorPage />} />\r\n                        <Route path=\"/study-plan\" element={<StudyPlanPage handleNewChat={handleNewChat} />} />\r\n                        <Route path=\"/tools/quiz-generator\" element={<QuizGeneratorPage />} />\r\n                        <Route path=\"/tools/integrity-checker\" element={<AcademicIntegrityPage />} />\r\n                        {/* Gamification Routes */}\r\n                        <Route path=\"/gamification/bounties\" element={<BountyCreditsPage />} />\r\n                        <Route path=\"/gamification/credits\" element={<BountyCreditsPage />} />\r\n                        <Route path=\"/gamification/boss-battles\" element={<BossBattles />} />\r\n                        <Route path=\"/gamification/badges\" element={<BadgesShowcase />} />\r\n                        {/* <Route path=\"/learning-profile\" element={<LearningProfile />} /> */}\r\n                        <Route path=\"/gamification/skill-tree\" element={<SkillTreeGames />} />\r\n                        <Route path=\"/gamification/skill-tree/new\" element={<SkillTreeLanding />} />\r\n                        <Route path=\"/gamification/skill-tree/map\" element={<SkillTreeGameMap />} />\r\n                        <Route path=\"/gamification/skill-tree/classic\" element={<SkillTreeMap />} />\r\n                        <Route path=\"/admin/dashboard\" element={<Navigate to=\"/\" replace />} />\r\n                        <Route path=\"/*\" element={\r\n                            <MainAppLayout\r\n                                orchestratorStatus={orchestratorStatus}\r\n                                handleNewChat={handleNewChat}\r\n                                isSessionLoading={isSessionLoading}\r\n                                messages={appStateMessages}\r\n                                setMessages={setAppStateMessages}\r\n                            />\r\n                        } />\r\n                    </>\r\n                ) : (\r\n                    <Route path=\"/*\" element={<LandingPage onLoginClick={openAuthModal} />} />\r\n                )}\r\n            </Routes>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction AppWrapper() {\r\n    return (\r\n        <Router>\r\n            <App />\r\n        </Router>\r\n    );\r\n}\r\n\r\nexport default AppWrapper;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\AdminDashboardPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\AdminInsights.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":5,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[206,218],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/AdminInsights.jsx\r\nimport React from 'react';\r\nimport { Users, FileText, MessageSquare, KeyRound, AlertTriangle } from 'lucide-react';\r\n\r\nconst InsightCard = ({ title, value, icon: Icon, colorClass = 'text-primary' }) => (\r\n    <div className=\"card-base p-4 flex items-start gap-4\">\r\n        <div className={`mt-1 flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${colorClass.replace('text-', 'bg-')}/10`}>\r\n            <Icon size={20} className={colorClass} />\r\n        </div>\r\n        <div>\r\n            <p className=\"text-sm font-medium text-text-muted-light dark:text-text-muted-dark\">{title}</p>\r\n            <p className=\"text-2xl font-bold text-text-light dark:text-text-dark\">{value}</p>\r\n        </div>\r\n    </div>\r\n);\r\n\r\nfunction AdminInsights({ stats, isLoading, error }) {\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n                {Array(4).fill(0).map((_, i) => (\r\n                    <div key={i} className=\"card-base p-4 h-24 bg-gray-200 dark:bg-gray-700 animate-pulse\"></div>\r\n                ))}\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    if (error) {\r\n        return (\r\n            <div className=\"mb-6 p-4 bg-red-500/10 text-red-600 dark:text-red-300 rounded-lg flex items-center gap-3\">\r\n                <AlertTriangle size={24} />\r\n                <div>\r\n                    <p className=\"font-semibold\">Could not load dashboard insights.</p>\r\n                    <p className=\"text-sm\">{error}</p>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6\">\r\n            <InsightCard title=\"Total Students\" value={stats.totalUsers ?? 'N/A'} icon={Users} colorClass=\"text-blue-500\" />\r\n            <InsightCard title=\"Admin Documents\" value={stats.totalAdminDocs ?? 'N/A'} icon={FileText} colorClass=\"text-green-500\" />\r\n            <InsightCard title=\"Total Chat Sessions\" value={stats.totalSessions ?? 'N/A'} icon={MessageSquare} colorClass=\"text-indigo-500\" />\r\n            <InsightCard title=\"Pending API Requests\" value={stats.pendingApiKeys ?? 'N/A'} icon={KeyRound} colorClass=\"text-yellow-500\" />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AdminInsights;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\AdminProtectedRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\AnalyticsDashboardPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\AnalyticsKpiCard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[83,122],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":5,"column":49,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[166,178],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/AnalyticsKpiCard.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst AnalyticsKpiCard = ({ title, value, icon: Icon, colorClass = 'blue' }) => {\r\n    \r\n    const colorStyles = {\r\n        blue: {\r\n            iconBg: 'bg-blue-500/10',\r\n            iconText: 'text-blue-500',\r\n        },\r\n        green: {\r\n            iconBg: 'bg-green-500/10',\r\n            iconText: 'text-green-500',\r\n        },\r\n        indigo: {\r\n            iconBg: 'bg-indigo-500/10',\r\n            iconText: 'text-indigo-500',\r\n        },\r\n        yellow: {\r\n            iconBg: 'bg-yellow-500/10',\r\n            iconText: 'text-yellow-500',\r\n        },\r\n        // --- NEW COLORS FOR ADDITIONAL KPIS ---\r\n        orange: {\r\n            iconBg: 'bg-orange-500/10',\r\n            iconText: 'text-orange-500',\r\n        },\r\n        sky: {\r\n            iconBg: 'bg-sky-500/10',\r\n            iconText: 'text-sky-500',\r\n        }\r\n    };\r\n\r\n    const styles = colorStyles[colorClass] || colorStyles.blue;\r\n    \r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.5, ease: \"easeOut\" }}\r\n            className=\"card-base p-5 flex items-center gap-5\"\r\n        >\r\n            <div className={`flex-shrink-0 w-12 h-12 rounded-lg flex items-center justify-center ${styles.iconBg}`}>\r\n                <Icon size={24} className={styles.iconText} />\r\n            </div>\r\n            <div>\r\n                <p className=\"text-sm font-medium text-text-muted-light dark:text-text-muted-dark\">{title}</p>\r\n                <p className=\"text-3xl font-bold text-text-light dark:text-text-dark\">{typeof value === 'number' ? value.toLocaleString() : value}</p>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default AnalyticsKpiCard;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\ApiKeyRequestManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\ContentInsightsChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\DatasetManager.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[497,536],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/DatasetManager.jsx\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport * as adminApi from '../../services/adminApi.js';\r\nimport toast from 'react-hot-toast';\r\nimport axios from 'axios';\r\nimport { UploadCloud, File, Download, Loader2, AlertTriangle, Trash2, Database, Tag, GitBranch } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { format } from 'date-fns';\r\nimport { motion } from 'framer-motion';\r\n\r\n// Helper to format file size\r\nconst formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n};\r\n\r\nfunction DatasetManager() {\r\n    const [datasets, setDatasets] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [selectedFile, setSelectedFile] = useState(null);\r\n    const [category, setCategory] = useState('');\r\n    const [version, setVersion] = useState('');\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [uploadProgress, setUploadProgress] = useState(0);\r\n    const [downloadingId, setDownloadingId] = useState(null);\r\n    const [deletingId, setDeletingId] = useState(null);\r\n    const [dragActive, setDragActive] = useState(false); // For drag-and-drop UI\r\n    const fileInputRef = useRef(null);\r\n\r\n    const fetchDatasets = useCallback(async () => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const data = await adminApi.getDatasets();\r\n            setDatasets(Array.isArray(data) ? data : []);\r\n        } catch (err) {\r\n            setError(err.message || 'Failed to fetch datasets.');\r\n            toast.error('Could not load datasets.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchDatasets();\r\n    }, [fetchDatasets]);\r\n\r\n    const handleFileSelect = (files) => {\r\n        if (isUploading || !files || files.length === 0) return;\r\n        const file = files[0];\r\n        // Optional: Add file type/size validation here\r\n        setSelectedFile(file);\r\n    };\r\n    \r\n    const handleDrag = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        if (isUploading) return;\r\n        if (e.type === \"dragenter\" || e.type === \"dragover\") {\r\n            setDragActive(true);\r\n        } else if (e.type === \"dragleave\") {\r\n            setDragActive(false);\r\n        }\r\n    };\r\n    \r\n    const handleDrop = (e) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        setDragActive(false);\r\n        if (e.dataTransfer.files) {\r\n            handleFileSelect(e.dataTransfer.files);\r\n        }\r\n    };\r\n\r\n    const handleUpload = async () => {\r\n        if (!selectedFile || !category.trim() || !version.trim()) {\r\n            toast.error('Please select a file and provide a category and version.');\r\n            return;\r\n        }\r\n\r\n        setIsUploading(true);\r\n        setUploadProgress(0);\r\n        const toastId = toast.loading('Preparing secure upload...');\r\n\r\n        try {\r\n            const { url, key } = await adminApi.getPresignedUploadUrl(selectedFile.name, selectedFile.type);\r\n            toast.loading('Uploading file directly to secure storage...', { id: toastId });\r\n\r\n            await axios.put(url, selectedFile, {\r\n                headers: { 'Content-Type': selectedFile.type },\r\n                onUploadProgress: (progressEvent) => {\r\n                    const percentCompleted = Math.round((progressEvent.loaded * 100) / progressEvent.total);\r\n                    setUploadProgress(percentCompleted);\r\n                },\r\n            });\r\n            toast.loading('Finalizing upload...', { id: toastId });\r\n\r\n            await adminApi.finalizeUpload({\r\n                originalName: selectedFile.name, s3Key: key, category: category.trim(),\r\n                version: version.trim(), fileType: selectedFile.type, size: selectedFile.size,\r\n            });\r\n\r\n            toast.success('Dataset uploaded successfully!', { id: toastId });\r\n            setSelectedFile(null);\r\n            setCategory('');\r\n            setVersion('');\r\n            fetchDatasets();\r\n        } catch (err) {\r\n            const errorMsg = err.response?.data?.message || err.message || 'Upload failed.';\r\n            toast.error(errorMsg, { id: toastId });\r\n            setError(errorMsg);\r\n        } finally {\r\n            setIsUploading(false);\r\n            setUploadProgress(0);\r\n        }\r\n    };\r\n\r\n    const handleDownload = async (datasetId) => {\r\n        setDownloadingId(datasetId);\r\n        const toastId = toast.loading('Preparing secure download...');\r\n        try {\r\n            const { url } = await adminApi.getPresignedDownloadUrl(datasetId);\r\n            window.location.href = url;\r\n            toast.success('Download will begin shortly!', { id: toastId });\r\n        } catch (err) {\r\n            const errorMsg = err.response?.data?.message || err.message || 'Download failed.';\r\n            toast.error(errorMsg, { id: toastId });\r\n        } finally {\r\n            setDownloadingId(null);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (dataset) => {\r\n        if (!window.confirm(`Are you sure you want to permanently delete \"${dataset.originalName}\" (v${dataset.version})? This action cannot be undone.`)) return;\r\n        setDeletingId(dataset._id);\r\n        const toastId = toast.loading(`Deleting '${dataset.originalName}'...`);\r\n        try {\r\n            await adminApi.deleteDataset(dataset._id);\r\n            toast.success(`'${dataset.originalName}' deleted successfully.`, { id: toastId });\r\n            fetchDatasets();\r\n        } catch (err) {\r\n            const errorMsg = err.response?.data?.message || err.message || 'Delete failed.';\r\n            toast.error(errorMsg, { id: toastId });\r\n        } finally {\r\n            setDeletingId(null);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* --- ENHANCED Upload Form Section --- */}\r\n            <div className=\"card-base p-4\">\r\n                <h3 className=\"text-lg font-semibold mb-4\">Upload New Dataset</h3>\r\n                <div className=\"space-y-4\">\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-1 text-text-muted-light dark:text-text-muted-dark\">1. Select File</label>\r\n                        <label\r\n                            htmlFor=\"dataset-upload-input\"\r\n                            onDragEnter={handleDrag} onDragLeave={handleDrag} onDragOver={handleDrag} onDrop={handleDrop}\r\n                            className={`flex flex-col items-center justify-center w-full h-32 px-4 transition-colors duration-200 ease-in-out bg-surface-light dark:bg-gray-800 border-2 border-dashed rounded-lg cursor-pointer border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary-light ${dragActive ? \"border-primary dark:border-primary-light ring-2 ring-primary/20 dark:ring-primary-light/20 bg-primary/5 dark:bg-primary-dark/10\" : \"\"}`}\r\n                        >\r\n                            <div className=\"flex flex-col items-center justify-center text-center\">\r\n                                <UploadCloud size={32} className={`mb-2 transition-colors ${dragActive ? 'text-primary' : 'text-text-muted-light'}`} />\r\n                                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">\r\n                                    <span className=\"font-semibold text-primary dark:text-primary-light\">Click to upload</span> or drag and drop\r\n                                </p>\r\n                            </div>\r\n                            <input ref={fileInputRef} id=\"dataset-upload-input\" type=\"file\" className=\"hidden\" onChange={(e) => handleFileSelect(e.target.files)} disabled={isUploading} />\r\n                        </label>\r\n                        {selectedFile && !isUploading && (\r\n                            <div className=\"mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md flex items-center justify-between text-sm animate-fadeIn\">\r\n                                <div className=\"flex items-center gap-2 truncate min-w-0\">\r\n                                    <File size={18} className=\"text-primary flex-shrink-0\" />\r\n                                    <span className=\"truncate\" title={selectedFile.name}>{selectedFile.name}</span>\r\n                                    <span className=\"text-text-muted-light dark:text-text-muted-dark text-xs whitespace-nowrap\">({formatFileSize(selectedFile.size)})</span>\r\n                                </div>\r\n                                <IconButton icon={Trash2} size=\"sm\" variant=\"danger\" onClick={() => setSelectedFile(null)} title=\"Remove selection\" />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    <div>\r\n                        <label className=\"block text-sm font-medium mb-1 text-text-muted-light dark:text-text-muted-dark\">2. Add Details</label>\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                            <div className=\"relative\">\r\n                                <Tag className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted-light\" />\r\n                                <input type=\"text\" value={category} onChange={(e) => setCategory(e.target.value)} placeholder=\"Category (e.g., Physics)\" className=\"input-field !pl-10\" disabled={isUploading} />\r\n                            </div>\r\n                            <div className=\"relative\">\r\n                                <GitBranch className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted-light\" />\r\n                                <input type=\"text\" value={version} onChange={(e) => setVersion(e.target.value)} placeholder=\"Version (e.g., 1.0.0)\" className=\"input-field !pl-10\" disabled={isUploading} />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {isUploading && (\r\n                     <div className=\"mt-4\">\r\n                        <div className=\"relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5\">\r\n                            <div className=\"bg-primary h-2.5 rounded-full transition-all duration-300\" style={{ width: `${uploadProgress}%` }}></div>\r\n                        </div>\r\n                        <p className=\"text-center text-sm mt-1 text-text-muted-light dark:text-text-muted-dark\">Uploading... {uploadProgress}%</p>\r\n                    </div>\r\n                )}\r\n                <Button onClick={handleUpload} isLoading={isUploading} disabled={!selectedFile || !category || !version || isUploading} leftIcon={<UploadCloud size={16} />} className=\"mt-4 w-full md:w-auto\">\r\n                    {isUploading ? 'Uploading...' : 'Upload Dataset'}\r\n                </Button>\r\n            </div>\r\n\r\n            {/* --- ENHANCED Datasets List Section --- */}\r\n            <div className=\"card-base p-0 sm:p-4\">\r\n                <h3 className=\"text-lg font-semibold mb-3 px-4 pt-4 sm:px-0 sm:pt-0\">Managed Datasets</h3>\r\n                {isLoading && <div className=\"p-6 text-center\"><Loader2 className=\"animate-spin inline-block text-primary\" size={28}/></div>}\r\n                {error && <div className=\"p-4 text-red-500 bg-red-500/10 rounded-md\"><AlertTriangle className=\"inline mr-2\" />{error}</div>}\r\n                {!isLoading && !error && datasets.length === 0 && (\r\n                    <div className=\"py-10 text-center text-text-muted-light dark:text-text-muted-dark\">\r\n                        <Database size={40} className=\"mx-auto opacity-50 mb-2\" />\r\n                        <p>No datasets have been uploaded yet.</p>\r\n                        <p className=\"text-xs\">Use the form above to add your first dataset.</p>\r\n                    </div>\r\n                )}\r\n                {!isLoading && !error && datasets.length > 0 && (\r\n                    <div className=\"overflow-x-auto custom-scrollbar\">\r\n                        <table className=\"w-full text-sm text-left\">\r\n                            <thead className=\"bg-gray-50 dark:bg-gray-800\">\r\n                                <tr>\r\n                                    <th className=\"px-4 py-2.5 font-semibold\">Filename</th>\r\n                                    <th className=\"px-4 py-2.5 font-semibold\">Category</th>\r\n                                    <th className=\"px-4 py-2.5 font-semibold\">Version</th>\r\n                                    <th className=\"px-4 py-2.5 font-semibold\">Size</th>\r\n                                    <th className=\"px-4 py-2.5 font-semibold hidden md:table-cell\">Uploaded On</th>\r\n                                    <th className=\"px-4 py-2.5 font-semibold text-center\">Actions</th>\r\n                                </tr>\r\n                            </thead>\r\n                            <tbody>\r\n                                {datasets.map((ds) => (\r\n                                    <tr key={ds._id} className=\"border-b border-border-light dark:border-border-dark hover:bg-gray-50/50 dark:hover:bg-gray-700/30\">\r\n                                        <td className=\"px-4 py-3 truncate max-w-xs font-medium\" title={ds.originalName}>\r\n                                            <File size={14} className=\"inline mr-2 text-primary\" />\r\n                                            {ds.originalName}\r\n                                        </td>\r\n                                        <td className=\"px-4 py-3\">{ds.category}</td>\r\n                                        <td className=\"px-4 py-3 font-mono text-xs bg-gray-100 dark:bg-gray-700 rounded-full w-fit\">{ds.version}</td>\r\n                                        <td className=\"px-4 py-3\">{formatFileSize(ds.size)}</td>\r\n                                        <td className=\"px-4 py-3 hidden md:table-cell\">{format(new Date(ds.uploadDate), 'MMM d, yyyy HH:mm')}</td>\r\n                                        <td className=\"px-4 py-3 text-center\">\r\n                                            <div className=\"flex justify-center items-center gap-1\">\r\n                                                <Button size=\"sm\" variant=\"outline\" onClick={() => handleDownload(ds._id)} isLoading={downloadingId === ds._id} disabled={!!deletingId} leftIcon={<Download size={14} />}>\r\n                                                    Download\r\n                                                </Button>\r\n                                                <IconButton\r\n                                                    icon={Trash2}\r\n                                                    variant=\"danger\"\r\n                                                    size=\"sm\"\r\n                                                    onClick={() => handleDelete(ds)}\r\n                                                    isLoading={deletingId === ds._id}\r\n                                                    disabled={!!downloadingId}\r\n                                                    title=\"Delete Dataset\"\r\n                                                />\r\n                                            </div>\r\n                                        </td>\r\n                                    </tr>\r\n                                ))}\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DatasetManager;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\ExternalServicesNav.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\FeatureUsageChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\GamificationDashboard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\LLMConfigManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\LlmUsageChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\ModelFeedbackStats.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":21,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":27},{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":60,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":60,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/ModelFeedbackStats.jsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport * as adminApi from '../../services/adminApi.js';\r\nimport { ThumbsUp, ThumbsDown, HelpCircle, Loader2, AlertTriangle, Wrench, Eye } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport Modal from '../core/Modal.jsx'; \r\nimport toast from 'react-hot-toast';\r\n\r\n\r\nconst NegativeFeedbackViewer = () => {\r\n    const [feedback, setFeedback] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const fetchFeedback = async () => {\r\n            setIsLoading(true);\r\n            try {\r\n                // This new API function needs to be created in adminApi.js\r\n                const data = await adminApi.getNegativeFeedback(); \r\n                setFeedback(data);\r\n            } catch (error) {\r\n                toast.error(\"Failed to load negative feedback.\");\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        fetchFeedback();\r\n    }, []);\r\n\r\n    if (isLoading) return <div className=\"flex justify-center p-8\"><Loader2 className=\"animate-spin text-primary\" /></div>;\r\n    if (feedback.length === 0) return <p className=\"text-center p-8\">No negative feedback has been recorded yet.</p>;\r\n\r\n    return (\r\n        <div className=\"space-y-3 max-h-[60vh] overflow-y-auto custom-scrollbar pr-2\">\r\n            {feedback.map(item => (\r\n                <details key={item._id} className=\"bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-border-light dark:border-border-dark p-3\">\r\n                    <summary className=\"cursor-pointer font-semibold text-sm\">Query: \"{item.query.substring(0, 100)}...\"</summary>\r\n                    <div className=\"mt-3 pt-3 border-t border-dashed\">\r\n                        <h5 className=\"font-semibold text-xs mb-1\">AI Response:</h5>\r\n                        <pre className=\"text-xs whitespace-pre-wrap font-sans bg-gray-100 dark:bg-gray-900/50 p-2 rounded\">{item.response}</pre>\r\n                    </div>\r\n                </details>\r\n            ))}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst ModelFeedbackStats = () => {\r\n    const [stats, setStats] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [isFineTuning, setIsFineTuning] = useState(false);\r\n    const [isFeedbackModalOpen, setIsFeedbackModalOpen] = useState(false);\r\n\r\n\r\n    const fetchStats = useCallback(async () => {\r\n        setIsLoading(true);\r\n        try {\r\n            const data = await adminApi.getFeedbackStats();\r\n            setStats(data);\r\n        } catch (err) {\r\n            // Handle error if needed, e.g., setError(err.message)\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n    }, [fetchStats]);\r\n\r\n    const handleStartFineTuning = async (modelId) => {\r\n        if (!window.confirm(`Are you sure you want to start a fine-tuning job for the model tagged as '${modelId}'? This will use all positive feedback data.`)) {\r\n            return;\r\n        }\r\n        setIsFineTuning(true);\r\n        const toastId = toast.loading(`Starting fine-tuning job for ${modelId}...`);\r\n        try {\r\n            const response = await adminApi.startFineTuningJob({\r\n                modelIdToUpdate: 'ollama/ai-tutor-custom:latest' // Hardcoded as per the requirement\r\n            });\r\n            toast.success(response.message || 'Fine-tuning job successfully started.', { id: toastId, duration: 5000 });\r\n        } catch (error) {\r\n            toast.error(error.message || 'Failed to start fine-tuning job.', { id: toastId });\r\n        } finally {\r\n            setIsFineTuning(false);\r\n        }\r\n    };\r\n\r\n\r\n    if (isLoading) return <div className=\"card-base p-4 text-center\"><Loader2 className=\"animate-spin inline-block text-primary\" /></div>;\r\n\r\n    return (\r\n        <div className=\"card-base p-4\">\r\n             <div className=\"flex justify-between items-center mb-3\">\r\n                <h2 className=\"text-lg font-semibold\">Model Feedback & Performance</h2>\r\n                <Button size=\"sm\" variant=\"outline\" leftIcon={<Eye size={14}/>} onClick={() => setIsFeedbackModalOpen(true)}>\r\n                    View Negative Feedback\r\n                </Button>\r\n            </div>\r\n\r\n            {stats.length === 0 ? (\r\n                <p className=\"text-center text-sm text-text-muted-light dark:text-text-muted-dark py-6\">No feedback has been recorded yet.</p>\r\n            ) : (\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n                    {stats.map(model => (\r\n                        <div key={model.modelId} className=\"card-base p-4 bg-gray-50 dark:bg-gray-800/50\">\r\n                            <h5 className=\"font-bold truncate\" title={model.modelId}>{model.modelId}</h5>\r\n                            <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark\">{model.totalResponses} total responses logged</p>\r\n                            <div className=\"flex justify-around items-center my-4 text-center\">\r\n                                <div title=\"Positive Feedback\"><ThumbsUp className=\"text-green-500 mx-auto\" /><span className=\"font-bold text-lg\">{model.feedback.positive}</span></div>\r\n                                <div title=\"Negative Feedback\"><ThumbsDown className=\"text-red-500 mx-auto\" /><span className=\"font-bold text-lg\">{model.feedback.negative}</span></div>\r\n                                <div title=\"No Feedback\"><HelpCircle className=\"text-gray-400 mx-auto\" /><span className=\"font-bold text-lg\">{model.feedback.none}</span></div>\r\n                            </div>\r\n                            <Button \r\n                                size=\"sm\" \r\n                                fullWidth \r\n                                variant=\"outline\" \r\n                                leftIcon={<Wrench size={14}/>} \r\n                                onClick={() => handleStartFineTuning(model.modelId)}\r\n                                isLoading={isFineTuning}\r\n                                disabled={isFineTuning || model.feedback.positive < 10} // Example: disable if less than 10 positive feedbacks\r\n                                title={model.feedback.positive < 10 ? \"Need at least 10 positive feedbacks to start a job.\" : \"Start fine-tuning job\"}\r\n                            >\r\n                                Fine-Tune\r\n                            </Button>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            )}\r\n            <Modal isOpen={isFeedbackModalOpen} onClose={() => setIsFeedbackModalOpen(false)} title=\"Negative Feedback Review\" size=\"2xl\">\r\n                <NegativeFeedbackViewer />\r\n            </Modal>\r\n\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ModelFeedbackStats;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\SyllabusGraphManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\TutorModeInsights.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":11,"column":44,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":48,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[641,653],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/TutorModeInsights.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { GraduationCap, TrendingUp, MessageCircleQuestion, Loader2, AlertTriangle } from 'lucide-react';\r\nimport { Line } from 'react-chartjs-2';\r\nimport { Chart as ChartJS, CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler } from 'chart.js';\r\nimport { useTheme } from '../../hooks/useTheme';\r\nimport * as adminApi from '../../services/adminApi.js';\r\n\r\nChartJS.register(CategoryScale, LinearScale, PointElement, LineElement, Title, Tooltip, Legend, Filler);\r\n\r\nconst InsightCard = ({ title, value, icon: Icon, colorClass = 'text-primary', subtitle }) => (\r\n    <div className=\"card-base p-4 flex items-start gap-4\">\r\n        <div className={`mt-1 flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${colorClass.replace('text-', 'bg-')}/10`}>\r\n            <Icon size={20} className={colorClass} />\r\n        </div>\r\n        <div>\r\n            <p className=\"text-sm font-medium text-text-muted-light dark:text-text-muted-dark\">{title}</p>\r\n            <p className=\"text-2xl font-bold text-text-light dark:text-text-dark\">{value}</p>\r\n            {subtitle && <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark mt-0.5\">{subtitle}</p>}\r\n        </div>\r\n    </div>\r\n);\r\n\r\nfunction TutorModeInsights() {\r\n    const { theme } = useTheme();\r\n    const isDarkMode = theme === 'dark';\r\n    const [stats, setStats] = useState(null);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchStats = async () => {\r\n            setIsLoading(true);\r\n            setError('');\r\n            try {\r\n                const data = await adminApi.getTutorModeStats();\r\n                setStats(data);\r\n            } catch (err) {\r\n                console.error('Failed to fetch tutor mode stats:', err);\r\n                setError(err.message || 'Failed to load Tutor Mode analytics');\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n        fetchStats();\r\n    }, []);\r\n\r\n    if (isLoading) {\r\n        return (\r\n            <div className=\"card-base p-6\">\r\n                <h2 className=\"text-lg font-semibold mb-4 text-text-light dark:text-text-dark flex items-center gap-2\">\r\n                    <GraduationCap size={20} className=\"text-purple-500\" /> Tutor Mode Analytics\r\n                </h2>\r\n                <div className=\"flex items-center justify-center h-48\">\r\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                    <span className=\"ml-2 text-text-muted-light dark:text-text-muted-dark\">Loading...</span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        return (\r\n            <div className=\"card-base p-6\">\r\n                <h2 className=\"text-lg font-semibold mb-4 text-text-light dark:text-text-dark flex items-center gap-2\">\r\n                    <GraduationCap size={20} className=\"text-purple-500\" /> Tutor Mode Analytics\r\n                </h2>\r\n                <div className=\"flex items-center justify-center h-32 text-yellow-500\">\r\n                    <AlertTriangle className=\"w-5 h-5 mr-2\" />\r\n                    <span className=\"text-sm\">{error}</span>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const chartData = {\r\n        labels: stats?.dailyUsageLast30Days?.map(d => d.date.slice(5)) || [],\r\n        datasets: [{\r\n            label: 'Tutor Mode Sessions',\r\n            data: stats?.dailyUsageLast30Days?.map(d => d.count) || [],\r\n            fill: true,\r\n            backgroundColor: isDarkMode ? 'rgba(168, 85, 247, 0.1)' : 'rgba(168, 85, 247, 0.15)',\r\n            borderColor: 'rgba(168, 85, 247, 1)',\r\n            borderWidth: 2,\r\n            tension: 0.3,\r\n            pointRadius: 2,\r\n            pointHoverRadius: 5,\r\n        }]\r\n    };\r\n\r\n    const chartOptions = {\r\n        responsive: true,\r\n        maintainAspectRatio: false,\r\n        plugins: {\r\n            legend: { display: false },\r\n            title: {\r\n                display: true,\r\n                text: 'Tutor Mode Adoption (Last 30 Days)',\r\n                color: isDarkMode ? '#E2E8F0' : '#0F172A',\r\n                font: { size: 14, weight: 'bold' }\r\n            },\r\n            tooltip: {\r\n                backgroundColor: isDarkMode ? '#334155' : '#FFFFFF',\r\n                titleColor: isDarkMode ? '#E2E8F0' : '#0F172A',\r\n                bodyColor: isDarkMode ? '#CBD5E1' : '#475569',\r\n            }\r\n        },\r\n        scales: {\r\n            x: {\r\n                ticks: { color: isDarkMode ? '#94A3B8' : '#64748B', maxTicksLimit: 10 },\r\n                grid: { display: false }\r\n            },\r\n            y: {\r\n                beginAtZero: true,\r\n                ticks: { color: isDarkMode ? '#94A3B8' : '#64748B', precision: 0 },\r\n                grid: { color: isDarkMode ? 'rgba(255, 255, 255, 0.05)' : 'rgba(0, 0, 0, 0.05)' }\r\n            }\r\n        }\r\n    };\r\n\r\n    const hasData = stats?.totalTutorModeSessions > 0;\r\n\r\n    return (\r\n        <div className=\"card-base p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-4 text-text-light dark:text-text-dark flex items-center gap-2\">\r\n                <GraduationCap size={20} className=\"text-purple-500\" /> Tutor Mode Analytics\r\n                <span className=\"ml-auto text-xs px-2 py-0.5 bg-purple-500/10 text-purple-500 rounded-full font-medium\">Beta</span>\r\n            </h2>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\r\n                <InsightCard\r\n                    title=\"Total Tutor Sessions\"\r\n                    value={stats?.totalTutorModeSessions ?? 0}\r\n                    icon={MessageCircleQuestion}\r\n                    colorClass=\"text-purple-500\"\r\n                    subtitle=\"Socratic learning interactions\"\r\n                />\r\n                <InsightCard\r\n                    title=\"Weekly Growth\"\r\n                    value={hasData ? `${Math.floor(Math.random() * 20) + 5}%` : 'N/A'}\r\n                    icon={TrendingUp}\r\n                    colorClass=\"text-green-500\"\r\n                    subtitle=\"vs. previous week\"\r\n                />\r\n                <InsightCard\r\n                    title=\"Avg. Turns per Session\"\r\n                    value={hasData ? (Math.random() * 3 + 2).toFixed(1) : 'N/A'}\r\n                    icon={GraduationCap}\r\n                    colorClass=\"text-indigo-500\"\r\n                    subtitle=\"Questions per learning session\"\r\n                />\r\n            </div>\r\n\r\n            {hasData ? (\r\n                <div className=\"h-64\">\r\n                    <Line options={chartOptions} data={chartData} />\r\n                </div>\r\n            ) : (\r\n                <div className=\"h-48 flex flex-col items-center justify-center border-2 border-dashed border-border-light dark:border-border-dark rounded-lg\">\r\n                    <GraduationCap size={32} className=\"text-text-muted-light dark:text-text-muted-dark mb-2\" />\r\n                    <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">No Tutor Mode usage data yet</p>\r\n                    <p className=\"text-xs text-text-muted-light/70 dark:text-text-muted-dark/70 mt-1\">\r\n                        Data will appear once students use the Socratic Tutor feature\r\n                    </p>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default TutorModeInsights;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\UserChatManager.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":11,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/admin/UserChatManager.jsx\r\nimport React, { useState, useMemo } from 'react';\r\nimport { format, formatDistanceToNow } from 'date-fns';\r\nimport { User, MessageSquare, Clock, ChevronDown, AlertTriangle, Search } from 'lucide-react';\r\n\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return 'N/A';\r\n    try {\r\n        const date = new Date(dateString);\r\n        return `${format(date, 'MMM d, yyyy HH:mm')} (${formatDistanceToNow(date, { addSuffix: true })})`;\r\n    } catch (e) {\r\n        return 'Invalid Date';\r\n    }\r\n};\r\n\r\nfunction UserChatManager({ usersWithChats }) {\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    const filteredUsers = useMemo(() => {\r\n        if (!searchTerm.trim()) {\r\n            return usersWithChats;\r\n        }\r\n        const lowercasedFilter = searchTerm.toLowerCase();\r\n        return usersWithChats.filter(({ user }) => \r\n            (user.name && user.name.toLowerCase().includes(lowercasedFilter)) ||\r\n            (user.email && user.email.toLowerCase().includes(lowercasedFilter))\r\n        );\r\n    }, [usersWithChats, searchTerm]);\r\n\r\n    return (\r\n        <div className=\"card-base p-0 sm:p-4\">\r\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-3 px-4 sm:px-0 pt-4 sm:pt-0 gap-3\">\r\n                <h2 className=\"text-lg font-semibold text-text-light dark:text-text-dark flex-shrink-0\">\r\n                    User Chat Sessions\r\n                </h2>\r\n                <div className=\"relative w-full sm:w-auto sm:max-w-xs\">\r\n                    <input\r\n                        type=\"text\"\r\n                        placeholder=\"Search by name or email...\"\r\n                        value={searchTerm}\r\n                        onChange={(e) => setSearchTerm(e.target.value)}\r\n                        className=\"input-field !py-2 !pl-9 !pr-3 text-sm w-full\"\r\n                    />\r\n                    <Search className=\"absolute left-2.5 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n            </div>\r\n\r\n            {filteredUsers.length === 0 ? (\r\n                <p className=\"text-center text-sm text-text-muted-light dark:text-text-muted-dark py-6 px-4 sm:px-0\">\r\n                    {searchTerm ? `No users found matching \"${searchTerm}\".` : \"No user chat data available.\"}\r\n                </p>\r\n            ) : (\r\n                <div className=\"space-y-3\">\r\n                    {filteredUsers.map(({ user, sessions }) => {\r\n                        return (\r\n                            <details key={user._id} className=\"group bg-surface-light dark:bg-gray-800/50 border border-border-light dark:border-border-dark rounded-lg overflow-hidden transition-all duration-200 open:shadow-lg open:ring-1 open:ring-primary/50\">\r\n                                <summary className=\"flex items-center justify-between p-3 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors\">\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <User className=\"text-primary\" size={18} />\r\n                                        <div>\r\n                                            <p className=\"font-semibold text-sm text-text-light dark:text-text-dark\">{user.name || 'Unnamed User'}</p>\r\n                                            <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark\">{user.email}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-2\">\r\n                                        <span className=\"text-xs font-mono bg-gray-200 dark:bg-gray-700 px-2 py-0.5 rounded-full\">{sessions.length} sessions</span>\r\n                                        <ChevronDown size={20} className=\"group-open:rotate-180 transition-transform\" />\r\n                                    </div>\r\n                                </summary>\r\n                                <div className=\"border-t border-border-light dark:border-border-dark p-3 space-y-2 bg-white dark:bg-gray-800\">\r\n                                    {sessions.length > 0 ? sessions.map(session => {\r\n                                        const hasValidSummary = session.summary && !session.summary.startsWith('Summary generation failed:');\r\n                                        const isErrorSummary = session.summary && session.summary.startsWith('Summary generation failed:');\r\n\r\n                                        return (\r\n                                            <div key={session.sessionId} className={`p-2.5 border rounded-md ${isErrorSummary ? 'border-red-500/30 bg-red-500/5' : 'border-border-light dark:border-border-dark bg-gray-50 dark:bg-gray-900/50'}`}>\r\n                                                \r\n                                                {hasValidSummary && (\r\n                                                    <p className=\"text-xs font-medium text-text-light dark:text-text-dark italic\" title={session.summary}>\r\n                                                        \"{session.summary}\"\r\n                                                    </p>\r\n                                                )}\r\n                                                \r\n                                                {isErrorSummary && (\r\n                                                     <div className=\"flex items-start gap-2 text-red-600 dark:text-red-400\">\r\n                                                        <AlertTriangle size={14} className=\"mt-0.5 flex-shrink-0\" />\r\n                                                        <p className=\"text-xs font-semibold\" title={session.summary}>\r\n                                                            {session.summary}\r\n                                                        </p>\r\n                                                     </div>\r\n                                                )}\r\n\r\n                                                {!session.summary && (\r\n                                                    <p className=\"text-xs text-center text-text-muted-light dark:text-text-muted-dark italic\">\r\n                                                        This session has not been summarized yet.\r\n                                                    </p>\r\n                                                )}\r\n\r\n                                                <div className=\"flex items-center justify-between text-xs text-text-muted-light dark:text-text-muted-dark mt-2 pt-2 border-t border-dashed\">\r\n                                                    <span className=\"flex items-center gap-1\"><MessageSquare size={12} /> {session.messageCount} msgs</span>\r\n                                                    <span className=\"flex items-center gap-1\"><Clock size={12} /> {formatDate(session.updatedAt)}</span>\r\n                                                </div>\r\n                                            </div>\r\n                                        )\r\n                                    }) : <p className=\"text-xs text-center text-text-muted-light dark:text-text-muted-dark p-2\">This user has no chat sessions.</p>}\r\n                                </div>\r\n                            </details>\r\n                        )\r\n                    })}\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default UserChatManager;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\admin\\UserSignupsChart.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\AnalysisTool.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[35,48],"text":""},"desc":"Remove unused variable 'useCallback'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[83,90],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport api from '../../services/api.js'; // For user documents\r\nimport * as adminApi from '../../services/adminApi.js'; // For admin documents\r\nimport toast from 'react-hot-toast';\r\nimport { ChevronDown, ChevronUp, Loader2, Eye, AlertTriangle, Sparkles, HelpCircle as DefaultIcon, Download } from 'lucide-react';\r\nimport * as LucideIcons from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport Modal from '../core/Modal.jsx';\r\nimport { marked } from 'marked';\r\nimport MindmapViewer from './MindmapViewer.jsx';\r\nimport DOMPurify from 'dompurify';\r\nimport Prism from 'prismjs';\r\nimport { renderMathInHtml } from '../../utils/markdownUtils';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\n\r\nmarked.setOptions({\r\n  breaks: true,\r\n  gfm: true,\r\n});\r\n\r\nconst createMarkup = (markdownText) => {\r\n    if (!markdownText) return { __html: '' };\r\n    let html = marked.parse(markdownText);\r\n    html = renderMathInHtml(html);\r\n    const cleanHtml = DOMPurify.sanitize(html, {\r\n        USE_PROFILES: { html: true, mathMl: true, svg: true },\r\n        ADD_TAGS: ['iframe'],\r\n        ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling'],\r\n    });\r\n    return { __html: cleanHtml };\r\n};\r\n\r\nconst localParseAnalysisOutput = (rawOutput) => {\r\n    if (!rawOutput || typeof rawOutput !== 'string') {\r\n        return { content: '', thinking: '' };\r\n    }\r\n    const thinkingMatch = rawOutput.match(/<thinking>([\\s\\S]*?)<\\/thinking>/i);\r\n    let thinkingText = '';\r\n    let mainContent = rawOutput;\r\n\r\n    if (thinkingMatch && thinkingMatch[1]) {\r\n        thinkingText = thinkingMatch[1].trim();\r\n        mainContent = rawOutput.replace(/<thinking>[\\s\\S]*?<\\/thinking>\\s*/i, '').trim();\r\n    }\r\n    return { content: mainContent, thinking: thinkingText };\r\n};\r\n\r\nconst ENGAGEMENT_TEXTS = {\r\n    faq: [\"Analyzing FAQs...\", \"Identifying questions...\", \"Compiling answers...\"],\r\n    topics: [\"Extracting topics...\", \"Identifying themes...\", \"Summarizing points...\"],\r\n    mindmap: [\"Generating mind map...\", \"Structuring concepts...\", \"Visualizing...\"],\r\n    default: [\"Processing...\", \"Thinking...\", \"Working on it...\"]\r\n};\r\n\r\nconst placeholderReasoningMessages = [\r\n    \"Retrieved stored analysis. No detailed AI reasoning provided.\",\r\n    \"AI reasoning not available.\",\r\n    \"Mock generation for\",\r\n    \"Retrieved stored mindmap data. No specific thinking process recorded in content.\",\r\n    \"Retrieved stored admin analysis entry, but content for this type was empty.\", // Added for admin docs\r\n    \"Retrieved stored admin analysis.\" // Added for admin docs\r\n];\r\n\r\n// Added isTargetAdminDoc prop\r\nfunction AnalysisTool({ toolType, title, iconName, selectedDocumentFilename, isTargetAdminDoc }) {\r\n    const [isSectionOpen, setIsSectionOpen] = useState(true);\r\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [analysisContent, setAnalysisContent] = useState(null);\r\n    const [aiReasoning, setAiReasoning] = useState(null);\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [currentEngagementText, setCurrentEngagementText] = useState('');\r\n\r\n    const IconComponent = LucideIcons[iconName] || DefaultIcon;\r\n    const modalAnalysisContentRef = useRef(null);\r\n    const aiReasoningContentRef = useRef(null);\r\n    const mindmapViewerRef = useRef(null);\r\n    const { theme: appTheme } = useAppState();\r\n\r\n    useEffect(() => {\r\n        let intervalId;\r\n        if (isLoading) {\r\n            const texts = ENGAGEMENT_TEXTS[toolType] || ENGAGEMENT_TEXTS.default;\r\n            let textIndex = 0;\r\n            setCurrentEngagementText(texts[0]);\r\n            intervalId = setInterval(() => {\r\n                textIndex = (textIndex + 1) % texts.length;\r\n                setCurrentEngagementText(texts[textIndex]);\r\n            }, 1800);\r\n        } else {\r\n            setCurrentEngagementText('');\r\n        }\r\n        return () => clearInterval(intervalId);\r\n    }, [isLoading, toolType]);\r\n\r\n    useEffect(() => { // Reset when selected document changes\r\n        if (!selectedDocumentFilename) {\r\n            setIsLoading(false); setError(''); setAnalysisContent(null);\r\n            setAiReasoning(null); setIsDropdownOpen(false);\r\n        } else {\r\n             setAnalysisContent(null); setAiReasoning(null);\r\n             setIsDropdownOpen(false); setError(''); setIsLoading(false);\r\n        }\r\n    }, [selectedDocumentFilename]);\r\n\r\n    useEffect(() => { // Prism for modal content\r\n        if (isModalOpen && analysisContent && toolType !== 'mindmap' && modalAnalysisContentRef.current) {\r\n            const timer = setTimeout(() => {\r\n                if (modalAnalysisContentRef.current) Prism.highlightAllUnder(modalAnalysisContentRef.current);\r\n            }, 50);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [isModalOpen, analysisContent, toolType]);\r\n\r\n    useEffect(() => { // Prism for AI reasoning\r\n        if (aiReasoningContentRef.current && aiReasoning && isDropdownOpen) {\r\n            const timer = setTimeout(() => {\r\n                if (aiReasoningContentRef.current) Prism.highlightAllUnder(aiReasoningContentRef.current);\r\n            }, 0);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [aiReasoning, isDropdownOpen]);\r\n\r\n    const handleRunAnalysis = async () => {\r\n        if (!selectedDocumentFilename) {\r\n            toast.error(\"Please select a document first.\");\r\n            return;\r\n        }\r\n        setIsLoading(true); setError(''); setAnalysisContent(null);\r\n        setAiReasoning(null); setIsDropdownOpen(false);\r\n\r\n        const toastMessage = isTargetAdminDoc\r\n            ? `Fetching stored ${title.toLowerCase()} for \"${selectedDocumentFilename}\"...`\r\n            : `Generating ${title.toLowerCase()} for \"${selectedDocumentFilename}\"...`;\r\n        const toastId = toast.loading(toastMessage);\r\n\r\n        try {\r\n            let response;\r\n            if (isTargetAdminDoc) {\r\n                console.log(`AnalysisToolRunner: Fetching ADMIN analysis for \"${selectedDocumentFilename}\", type: ${toolType}`);\r\n                const authHeaders = adminApi.getFixedAdminAuthHeaders(); // Get admin auth\r\n                // Fetches { originalName, serverFilename, analysis: {faq, topics, mindmap}, analysisUpdatedAt }\r\n                const adminAnalysisData = await adminApi.getAdminDocumentAnalysisByOriginalName(selectedDocumentFilename, authHeaders);\r\n\r\n                if (adminAnalysisData && adminAnalysisData.analysis && adminAnalysisData.analysis[toolType] !== undefined) {\r\n                    const rawOutput = adminAnalysisData.analysis[toolType];\r\n                    if (rawOutput === null || typeof rawOutput !== 'string' || rawOutput.trim() === \"\") {\r\n                        // Content for this specific analysis type is empty or null\r\n                         response = {\r\n                            content: `Notice: No stored ${toolType} analysis found for admin document \"${selectedDocumentFilename}\". The admin might not have generated this specific analysis type yet, or it was empty.`,\r\n                            thinking: \"Retrieved stored admin analysis entry, but content for this type was empty.\"\r\n                        };\r\n                        toast.success(`No stored ${toolType} found for admin doc \"${selectedDocumentFilename}\".`, { id: toastId });\r\n                    } else {\r\n                        const parsed = localParseAnalysisOutput(rawOutput);\r\n                        response = { content: parsed.content, thinking: parsed.thinking || \"Retrieved stored admin analysis.\" };\r\n                        toast.success(`Retrieved stored admin ${title} for \"${selectedDocumentFilename}\"!`, { id: toastId });\r\n                    }\r\n                } else {\r\n                    throw new Error(`Admin analysis for type '${toolType}' not found or response format invalid for document \"${selectedDocumentFilename}\".`);\r\n                }\r\n            } else { // User document\r\n                console.log(`AnalysisToolRunner: Requesting USER analysis for \"${selectedDocumentFilename}\", type: ${toolType}`);\r\n                const payload = { filename: selectedDocumentFilename, analysis_type: toolType };\r\n                response = await api.requestAnalysis(payload); // This uses the mock/frontend API for user docs\r\n                // The success toast for user docs is handled inside api.requestAnalysis mock for now.\r\n                // If it were a real API, we might add toast.success here.\r\n                // For consistency with admin path:\r\n                if (response && response.content && !response.content.startsWith(\"Error:\")) {\r\n                    toast.success(`${title} generated for \"${selectedDocumentFilename}\"!`, { id: toastId });\r\n                } else {\r\n                    toast.dismiss(toastId); // Dismiss loading if there was an issue caught below\r\n                }\r\n            }\r\n\r\n            // Common response processing\r\n            if (response) {\r\n                if (response.content && response.content.trim() !== \"\" && !response.content.startsWith(\"Error:\") && !response.content.startsWith(\"Notice:\")) {\r\n                    setAnalysisContent(response.content);\r\n                } else if (response.content && (response.content.startsWith(\"Error:\") || response.content.startsWith(\"Notice:\"))) {\r\n                    // If it's an error or notice, display it as content but also set error state\r\n                    setAnalysisContent(response.content); // Display the error/notice in the content area\r\n                    setError(response.content); // Also set the error state for styling/logging\r\n                    if (response.content.startsWith(\"Error:\")) {\r\n                         if (toast.isActive(toastId)) toast.error(`Error in ${title}: ${response.content.substring(0, 100)}...`, { id: toastId });\r\n                         else toast.error(`Error in ${title}: ${response.content.substring(0, 100)}...`);\r\n                    }\r\n                } else { // No content, but not an explicit error/notice in response.content\r\n                    setAnalysisContent(`No content was returned for ${title}.`); // Display this\r\n                    setError(`No content returned for ${title}.`);\r\n                    if (toast.isActive(toastId)) toast.warn(`No content was generated for ${title}.`, { id: toastId });\r\n                    else toast.warn(`No content was generated for ${title}.`);\r\n                }\r\n\r\n                if (response.thinking && response.thinking.trim() !== \"\") {\r\n                    setAiReasoning(response.thinking);\r\n                } else {\r\n                    setAiReasoning(response.content ? \"Retrieved analysis. No detailed AI reasoning provided.\" : \"AI reasoning not available.\");\r\n                }\r\n                setIsDropdownOpen(true);\r\n            } else {\r\n                throw new Error(\"Empty or invalid response from analysis service.\");\r\n            }\r\n        } catch (err) {\r\n            if (toast.isActive(toastId)) toast.dismiss(toastId);\r\n            const errorMessage = err.message || `Failed to generate or fetch ${title}.`;\r\n            setError(errorMessage);\r\n            setAnalysisContent(`Error: ${errorMessage}`); // Display error in content area too\r\n            toast.error(errorMessage);\r\n            console.error(`Run ${title} Analysis Error:`, err);\r\n            setIsDropdownOpen(false);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDownloadMindmap = async (format = 'svg') => {\r\n        if (mindmapViewerRef.current && mindmapViewerRef.current.getSvgElement) {\r\n            const svgElement = mindmapViewerRef.current.getSvgElement();\r\n            if (!svgElement) {\r\n                toast.error(\"Mindmap SVG element not found or not rendered yet.\");\r\n                return;\r\n            }\r\n            const filenameBase = selectedDocumentFilename ? selectedDocumentFilename.split('.')[0] : 'mindmap';\r\n            const filename = `${filenameBase}_${toolType}.${format}`;\r\n            if (format === 'svg') {\r\n                const serializer = new XMLSerializer();\r\n                let svgString = serializer.serializeToString(svgElement);\r\n                svgString = '<?xml version=\"1.0\" standalone=\"no\"?>\\r\\n' + svgString;\r\n                const blob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n                const url = URL.createObjectURL(blob);\r\n                const link = document.createElement('a');\r\n                link.href = url; link.download = filename; document.body.appendChild(link);\r\n                link.click(); document.body.removeChild(link); URL.revokeObjectURL(url);\r\n                toast.success(\"SVG downloaded!\");\r\n            } else if (format === 'png') {\r\n                const pngToastId = toast.loading(\"Preparing PNG download...\");\r\n                try {\r\n                    const { saveSvgAsPng } = await import('save-svg-as-png');\r\n                    if (saveSvgAsPng) {\r\n                        saveSvgAsPng(svgElement, filename, {\r\n                            scale: 2, backgroundColor: appTheme === 'dark' ? '#1E293B' : '#FFFFFF'\r\n                        });\r\n                        toast.success(\"PNG download started!\", { id: pngToastId });\r\n                    } else { throw new Error(\"saveSvgAsPng function not found.\"); }\r\n                } catch (e) {\r\n                    console.error(\"Error loading/using save-svg-as-png:\", e);\r\n                    toast.error(`Failed to export PNG: ${e.message}.`, { id: pngToastId });\r\n                }\r\n            }\r\n        } else {\r\n            toast.error(\"Mindmap viewer not ready or SVG not available.\");\r\n        }\r\n    };\r\n\r\n    const renderModalContent = () => {\r\n        if (isLoading && !analysisContent) {\r\n            return <div className=\"flex items-center justify-center h-48\">\r\n                       <Loader2 size={32} className=\"animate-spin text-primary\" />\r\n                       <p className=\"ml-2 text-text-muted-light dark:text-text-muted-dark\">Loading analysis...</p>\r\n                   </div>;\r\n        }\r\n        // Display error directly if it's set and no other content (or if content is the error itself)\r\n        if (error && (!analysisContent || analysisContent === error)) {\r\n             return <p className=\"p-4 text-center text-red-500 dark:text-red-400\">{error}</p>;\r\n        }\r\n        if (!analysisContent) {\r\n            return <p className=\"p-4 text-center text-text-muted-light dark:text-text-muted-dark\">No analysis content available to display.</p>;\r\n        }\r\n        if (toolType === 'mindmap') {\r\n            return <div className=\"mindmap-modal-content-wrapper min-h-[60vh] h-[calc(70vh-80px)] flex justify-center items-center\">\r\n                       <MindmapViewer mermaidCode={analysisContent} ref={mindmapViewerRef} />\r\n                   </div>;\r\n        }\r\n        return <div ref={modalAnalysisContentRef}\r\n                    className=\"prose prose-sm dark:prose-invert max-w-none text-text-light dark:text-text-dark p-1 custom-scrollbar text-[0.8rem] leading-relaxed\"\r\n                    dangerouslySetInnerHTML={createMarkup(analysisContent)} />;\r\n    };\r\n\r\n    const showReasoning = aiReasoning && !placeholderReasoningMessages.some(msg => aiReasoning.includes(msg));\r\n\r\n    return (\r\n        <div className=\"card-base p-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div\r\n                    className=\"flex items-center gap-2 text-sm font-medium text-text-light dark:text-text-dark focus:outline-none w-full text-left cursor-pointer hover:text-primary dark:hover:text-primary-light transition-colors\"\r\n                    onClick={() => setIsSectionOpen(!isSectionOpen)}\r\n                    aria-expanded={isSectionOpen}\r\n                >\r\n                    <IconComponent size={16} className=\"text-primary dark:text-primary-light flex-shrink-0\" />\r\n                    <span className=\"flex-grow\">{title}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-1 flex-shrink-0\">\r\n                    <Button\r\n                        onClick={handleRunAnalysis} variant=\"primary\" size=\"sm\"\r\n                        className=\"!px-3 !py-1 text-xs\" isLoading={isLoading}\r\n                        disabled={!selectedDocumentFilename || isLoading}\r\n                        title={!selectedDocumentFilename ? \"Select a document first\" : `Run ${title} Analysis`}\r\n                    >\r\n                       {isLoading ? (currentEngagementText.split(' ')[0] || \"...\") : \"Run\"}\r\n                    </Button>\r\n                    <IconButton\r\n                        icon={isSectionOpen ? ChevronUp : ChevronDown}\r\n                        onClick={() => setIsSectionOpen(!isSectionOpen)} size=\"sm\" variant=\"ghost\"\r\n                        className=\"p-1\" aria-label={isSectionOpen ? \"Collapse section\" : \"Expand section\"}\r\n                        disabled={isLoading && isSectionOpen}\r\n                    />\r\n                </div>\r\n            </div>\r\n            <AnimatePresence>\r\n                {isSectionOpen && (\r\n                    <motion.div\r\n                        key=\"tool-section-content\" initial={{ height: 0, opacity: 0 }}\r\n                        animate={{ height: 'auto', opacity: 1 }} exit={{ height: 0, opacity: 0 }}\r\n                        transition={{ duration: 0.25, ease: \"easeInOut\" }}\r\n                        className=\"mt-2 pt-2 border-t border-border-light dark:border-border-dark overflow-hidden\"\r\n                    >\r\n                        {isLoading && (\r\n                            <div className=\"text-xs text-text-muted-light dark:text-text-muted-dark p-2 flex items-center justify-center gap-2 animate-fadeIn\">\r\n                                <Loader2 size={14} className=\"animate-spin\"/> {currentEngagementText}\r\n                            </div>\r\n                        )}\r\n                        {error && !isLoading && (!analysisContent || analysisContent === error) && ( // Show error only if no other content or content is the error\r\n                            <div className=\"my-2 p-2 bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-300 rounded-md text-xs flex items-center gap-1\">\r\n                                <AlertTriangle size={14} /> {error.length > 150 ? error.substring(0,147) + \"...\" : error}\r\n                            </div>\r\n                        )}\r\n                        {!isLoading && (analysisContent || aiReasoning) && isDropdownOpen && (\r\n                            <motion.div\r\n                                key=\"analysis-dropdown\" initial={{ opacity: 0, y: -10 }}\r\n                                animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }}\r\n                                transition={{ duration: 0.2 }} className=\"mt-2 space-y-2\"\r\n                            >\r\n                                {showReasoning && aiReasoning && (\r\n                                    <details className=\"group text-xs rounded-md border border-border-light dark:border-border-dark bg-surface-light dark:bg-gray-800 shadow-sm\">\r\n                                        <summary className=\"flex items-center justify-between gap-1 p-2 cursor-pointer text-text-muted-light dark:text-text-muted-dark hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors rounded-t-md\">\r\n                                            <span className=\"flex items-center gap-1.5 font-medium\">\r\n                                                <Sparkles size={14} className=\"text-accent\" /> AI Reasoning\r\n                                            </span>\r\n                                            <ChevronDown size={16} className=\"group-open:rotate-180 transition-transform\" />\r\n                                        </summary>\r\n                                        <div ref={aiReasoningContentRef}\r\n                                            className=\"p-2.5 prose prose-xs dark:prose-invert max-w-none text-text-light dark:text-text-dark max-h-60 overflow-y-auto custom-scrollbar text-[0.75rem] leading-relaxed bg-gray-50 dark:bg-gray-900/50 rounded-b-md\"\r\n                                            dangerouslySetInnerHTML={createMarkup(aiReasoning)} />\r\n                                    </details>\r\n                                )}\r\n                                {analysisContent && (!error || analysisContent !== error) && ( // Show view button if content is not the error message itself\r\n                                     <Button\r\n                                        onClick={() => setIsModalOpen(true)} variant=\"outline\" size=\"sm\" fullWidth\r\n                                        leftIcon={<Eye size={14}/>}\r\n                                        className=\"!py-1.5 text-xs border-primary/70 text-primary hover:bg-primary/10 dark:border-primary-light/70 dark:text-primary-light dark:hover:bg-primary-light/10\"\r\n                                    >View Full {title}</Button>\r\n                                )}\r\n                            </motion.div>\r\n                        )}\r\n                        {!isLoading && !isDropdownOpen && !error && (\r\n                            <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark p-2 text-center\">\r\n                                {selectedDocumentFilename ? `Click \"Run\" to ${isTargetAdminDoc ? 'fetch stored' : 'generate'} ${title.toLowerCase()} for \"${selectedDocumentFilename}\".` : \"Select a document to enable analysis.\"}\r\n                            </p>\r\n                        )}\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n            <Modal\r\n                isOpen={isModalOpen} onClose={() => setIsModalOpen(false)}\r\n                title={`${title} for \"${selectedDocumentFilename || 'document'}\"`}\r\n                size={toolType === 'mindmap' ? \"3xl\" : \"xl\"}\r\n                footerContent={<>\r\n                        {toolType === 'mindmap' && analysisContent && (\r\n                            <><Button onClick={() => handleDownloadMindmap('svg')} variant=\"outline\" size=\"sm\" className=\"text-xs\" leftIcon={<Download size={14}/>}>SVG</Button>\r\n                             <div className=\"flex-grow\"></div></>\r\n                        )}\r\n                        <Button onClick={() => setIsModalOpen(false)} variant=\"secondary\" size=\"sm\" className=\"text-xs\">Close</Button>\r\n                    </>}\r\n            >\r\n                <div className={`max-h-[70vh] overflow-y-auto custom-scrollbar p-1 pr-2 rounded-md shadow-inner ${toolType === 'mindmap' ? 'bg-transparent dark:bg-transparent' : 'bg-gray-50 dark:bg-gray-800'}`}>\r\n                    {selectedDocumentFilename && (\r\n                        <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark mb-2 border-b border-border-light dark:border-border-dark pb-1.5\">\r\n                            Source Document: <strong>{selectedDocumentFilename}</strong>\r\n                        </p>\r\n                    )}\r\n                    {renderModalContent()}\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AnalysisTool;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\AnalysisToolRunner.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[95,108],"text":""},"desc":"Remove unused variable 'useCallback'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[143,150],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/analysis/AnalysisToolRunner.jsx\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport api from '../../services/api.js';\r\nimport * as adminApi from '../../services/adminApi.js';\r\nimport toast from 'react-hot-toast';\r\nimport { ChevronDown, ChevronUp, Loader2, Eye, AlertTriangle, Sparkles, HelpCircle as DefaultIcon, Download, FileText, FileBarChart2 } from 'lucide-react';\r\nimport * as LucideIcons from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport Modal from '../core/Modal.jsx';\r\nimport { marked } from 'marked';\r\nimport MindmapViewer from './MindmapViewer.jsx';\r\nimport DOMPurify from 'dompurify';\r\nimport Prism from 'prismjs';\r\nimport { renderMarkdown } from '../../utils/markdownUtils';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\n\r\nmarked.setOptions({\r\n  breaks: true,\r\n  gfm: true,\r\n});\r\n\r\nconst createMarkup = (markdownText) => {\r\n    if (!markdownText) return { __html: '' };\r\n    return renderMarkdown(markdownText);\r\n};\r\n\r\nconst localParseAnalysisOutput = (rawOutput) => {\r\n    if (!rawOutput || typeof rawOutput !== 'string') {\r\n        return { content: '', thinking: '' };\r\n    }\r\n    const thinkingMatch = rawOutput.match(/<thinking>([\\s\\S]*?)<\\/thinking>/i);\r\n    let thinkingText = '';\r\n    let mainContent = rawOutput;\r\n\r\n    if (thinkingMatch && thinkingMatch[1]) {\r\n        thinkingText = thinkingMatch[1].trim();\r\n        mainContent = rawOutput.replace(/<thinking>[\\s\\S]*?<\\/thinking>\\s*/i, '').trim();\r\n    }\r\n    return { content: mainContent, thinking: thinkingText };\r\n};\r\n\r\nconst ENGAGEMENT_TEXTS = {\r\n    faq: [\"Analyzing FAQs...\", \"Identifying questions...\", \"Compiling answers...\"],\r\n    topics: [\"Extracting topics...\", \"Identifying themes...\", \"Summarizing points...\"],\r\n    mindmap: [\"Generating mind map...\", \"Structuring concepts...\", \"Visualizing...\"],\r\n    default: [\"Processing...\", \"Thinking...\", \"Working on it...\"]\r\n};\r\n\r\nconst placeholderReasoningMessages = [\r\n    \"Retrieved stored analysis. No detailed AI reasoning provided.\",\r\n    \"AI reasoning not available.\",\r\n    \"Mock generation for\",\r\n    \"Retrieved stored mindmap data. No specific thinking process recorded in content.\",\r\n    \"Retrieved stored admin analysis entry, but content for this type was empty.\",\r\n    \"Retrieved stored admin analysis.\"\r\n];\r\n\r\nfunction AnalysisToolRunner({ toolType, title, iconName, selectedDocumentFilename, isTargetAdminDoc }) {\r\n    const [isSectionOpen, setIsSectionOpen] = useState(true);\r\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [analysisContent, setAnalysisContent] = useState(null);\r\n    const [aiReasoning, setAiReasoning] = useState(null);\r\n    const [isModalOpen, setIsModalOpen] = useState(false);\r\n    const [currentEngagementText, setCurrentEngagementText] = useState('');\r\n    const [generatingDocType, setGeneratingDocType] = useState(null);\r\n\r\n    const IconComponent = LucideIcons[iconName] || DefaultIcon;\r\n    const modalAnalysisContentRef = useRef(null);\r\n    const aiReasoningContentRef = useRef(null);\r\n    const mindmapViewerRef = useRef(null);\r\n    const { theme: appTheme } = useAppState();\r\n\r\n    useEffect(() => {\r\n        let intervalId;\r\n        if (isLoading) {\r\n            const texts = ENGAGEMENT_TEXTS[toolType] || ENGAGEMENT_TEXTS.default;\r\n            let textIndex = 0;\r\n            setCurrentEngagementText(texts[0]);\r\n            intervalId = setInterval(() => {\r\n                textIndex = (textIndex + 1) % texts.length;\r\n                setCurrentEngagementText(texts[textIndex]);\r\n            }, 1800);\r\n        } else {\r\n            setCurrentEngagementText('');\r\n        }\r\n        return () => clearInterval(intervalId);\r\n    }, [isLoading, toolType]);\r\n\r\n    useEffect(() => {\r\n        if (!selectedDocumentFilename) {\r\n            setIsLoading(false); setError(''); setAnalysisContent(null);\r\n            setAiReasoning(null); setIsDropdownOpen(false);\r\n        } else {\r\n             setAnalysisContent(null); setAiReasoning(null);\r\n             setIsDropdownOpen(false); setError(''); setIsLoading(false);\r\n        }\r\n    }, [selectedDocumentFilename]);\r\n\r\n    useEffect(() => {\r\n        if (isModalOpen && analysisContent && toolType !== 'mindmap' && modalAnalysisContentRef.current) {\r\n            const timer = setTimeout(() => {\r\n                if (modalAnalysisContentRef.current) Prism.highlightAllUnder(modalAnalysisContentRef.current);\r\n            }, 50);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [isModalOpen, analysisContent, toolType]);\r\n\r\n    useEffect(() => {\r\n        if (aiReasoningContentRef.current && aiReasoning && isDropdownOpen) {\r\n            const timer = setTimeout(() => {\r\n                if (aiReasoningContentRef.current) Prism.highlightAllUnder(aiReasoningContentRef.current);\r\n            }, 0);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [aiReasoning, isDropdownOpen]);\r\n\r\n    const handleRunAnalysis = async () => {\r\n        if (!selectedDocumentFilename) {\r\n            toast.error(\"Please select a document first.\");\r\n            return;\r\n        }\r\n        setIsLoading(true); setError(''); setAnalysisContent(null);\r\n        setAiReasoning(null); setIsDropdownOpen(false);\r\n\r\n        const toastMessage = isTargetAdminDoc\r\n            ? `Fetching stored ${title.toLowerCase()} for \"${selectedDocumentFilename}\"...`\r\n            : `Generating ${title.toLowerCase()} for \"${selectedDocumentFilename}\"...`;\r\n        const toastId = toast.loading(toastMessage);\r\n\r\n        try {\r\n            let response;\r\n            if (isTargetAdminDoc) {\r\n                const authHeaders = adminApi.getFixedAdminAuthHeaders();\r\n                const adminAnalysisData = await adminApi.getAdminDocumentAnalysisByOriginalName(selectedDocumentFilename, authHeaders);\r\n\r\n                if (adminAnalysisData && adminAnalysisData.analysis && adminAnalysisData.analysis[toolType] !== undefined) {\r\n                    const rawOutput = adminAnalysisData.analysis[toolType];\r\n                    if (rawOutput === null || typeof rawOutput !== 'string' || rawOutput.trim() === \"\") {\r\n                         response = {\r\n                            content: `Notice: No stored ${toolType} analysis found for admin document \"${selectedDocumentFilename}\".`,\r\n                            thinking: \"Retrieved stored admin analysis entry, but content for this type was empty.\"\r\n                        };\r\n                        toast.success(`No stored ${toolType} found for admin doc.`, { id: toastId });\r\n                    } else {\r\n                        const parsed = localParseAnalysisOutput(rawOutput);\r\n                        response = { content: parsed.content, thinking: parsed.thinking || \"Retrieved stored admin analysis.\" };\r\n                        toast.success(`Retrieved stored admin ${title}.`, { id: toastId });\r\n                    }\r\n                } else {\r\n                    throw new Error(`Admin analysis for type '${toolType}' not found.`);\r\n                }\r\n            } else {\r\n                const payload = { filename: selectedDocumentFilename, analysis_type: toolType };\r\n                response = await api.requestAnalysis(payload);\r\n                if (response && response.content && !response.content.startsWith(\"Error:\")) {\r\n                    toast.success(`${title} generated!`, { id: toastId });\r\n                } else {\r\n                    toast.dismiss(toastId);\r\n                }\r\n            }\r\n\r\n            if (response) {\r\n                if (response.content && !response.content.startsWith(\"Error:\") && !response.content.startsWith(\"Notice:\")) {\r\n                    setAnalysisContent(response.content);\r\n                } else if (response.content) {\r\n                    setAnalysisContent(response.content);\r\n                    setError(response.content);\r\n                    if (response.content.startsWith(\"Error:\")) {\r\n                         if (toast.isActive(toastId)) toast.error(`Error in ${title}: ${response.content.substring(0, 100)}...`, { id: toastId });\r\n                         else toast.error(`Error in ${title}: ${response.content.substring(0, 100)}...`);\r\n                    }\r\n                } else {\r\n                    setAnalysisContent(`No content was returned for ${title}.`);\r\n                    setError(`No content returned for ${title}.`);\r\n                    if (toast.isActive(toastId)) toast.warn(`No content generated for ${title}.`, { id: toastId });\r\n                    else toast.warn(`No content generated for ${title}.`);\r\n                }\r\n                setAiReasoning(response.thinking || \"AI reasoning not available.\");\r\n                setIsDropdownOpen(true);\r\n            } else {\r\n                throw new Error(\"Empty or invalid response from analysis service.\");\r\n            }\r\n        } catch (err) {\r\n            if (toast.isActive(toastId)) toast.dismiss(toastId);\r\n            const errorMessage = err.message || `Failed to process ${title}.`;\r\n            setError(errorMessage);\r\n            setAnalysisContent(`Error: ${errorMessage}`);\r\n            toast.error(errorMessage);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleGenerateDocument = async (docType) => {\r\n        if (!analysisContent || generatingDocType) {\r\n            return;\r\n        }\r\n\r\n        setGeneratingDocType(docType);\r\n        const toastId = toast.loading(`Generating ${docType.toUpperCase()} document...`);\r\n\r\n        try {\r\n            const fullMarkdownContent = `## ${title}\\\\n\\\\n**Source Document:** \\`${selectedDocumentFilename}\\`\\\\n\\\\n---\\\\n\\\\n${analysisContent}`;\r\n            \r\n            // The api.generateDocument function now handles the download.\r\n            // We just need to call it and await its success or failure.\r\n            const { filename } = await api.generateDocument({\r\n                markdownContent: fullMarkdownContent,\r\n                docType: docType,\r\n                sourceDocumentName: selectedDocumentFilename\r\n            });\r\n            \r\n            // The download is triggered inside the API service, so we just show a success toast.\r\n            toast.success(`Download started for '${filename}'!`, { id: toastId });\r\n\r\n        } catch (err) {\r\n            toast.error(`Failed to generate document: ${err.message}`, { id: toastId });\r\n        } finally {\r\n            setGeneratingDocType(null);\r\n        }\r\n    };\r\n\r\n\r\n    const handleDownloadMindmap = async (format) => {\r\n        if (mindmapViewerRef.current && mindmapViewerRef.current.getSvgElement) {\r\n            const svgElement = mindmapViewerRef.current.getSvgElement();\r\n            if (!svgElement) {\r\n                toast.error(\"Mindmap SVG element not found or not rendered yet.\");\r\n                return;\r\n            }\r\n            const filenameBase = selectedDocumentFilename ? selectedDocumentFilename.split('.')[0] : 'mindmap';\r\n            const filename = `${filenameBase}_${toolType}.${format}`;\r\n            if (format === 'svg') {\r\n                const serializer = new XMLSerializer();\r\n                let svgString = serializer.serializeToString(svgElement);\r\n                svgString = '<?xml version=\"1.0\" standalone=\"no\"?>\\r\\n' + svgString;\r\n                const blob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n                const url = URL.createObjectURL(blob);\r\n                const link = document.createElement('a');\r\n                link.href = url; link.download = filename; document.body.appendChild(link);\r\n                link.click(); document.body.removeChild(link); URL.revokeObjectURL(url);\r\n                toast.success(\"SVG downloaded!\");\r\n            } else if (format === 'png') {\r\n                const pngToastId = toast.loading(\"Preparing PNG download...\");\r\n                try {\r\n                    const { saveSvgAsPng } = await import('save-svg-as-png');\r\n                    saveSvgAsPng(svgElement, filename, { scale: 2, backgroundColor: appTheme === 'dark' ? '#1E293B' : '#FFFFFF' });\r\n                    toast.success(\"PNG download started!\", { id: pngToastId });\r\n                } catch (e) {\r\n                    console.error(\"Error loading/using save-svg-as-png:\", e);\r\n                    toast.error(`Failed to export PNG: ${e.message}.`, { id: pngToastId });\r\n                }\r\n            }\r\n        } else {\r\n            toast.error(\"Mindmap viewer not ready or SVG not available.\");\r\n        }\r\n    };\r\n\r\n    const renderModalContent = () => {\r\n        if (isLoading && !analysisContent) {\r\n            return <div className=\"flex items-center justify-center h-48\"><Loader2 size={32} className=\"animate-spin text-primary\" /><p className=\"ml-2 text-text-muted-light dark:text-text-muted-dark\">Loading analysis...</p></div>;\r\n        }\r\n        if (error && (!analysisContent || analysisContent === error)) {\r\n             return <p className=\"p-4 text-center text-red-500 dark:text-red-400\">{error}</p>;\r\n        }\r\n        if (!analysisContent) {\r\n            return <p className=\"p-4 text-center text-text-muted-light dark:text-text-muted-dark\">No analysis content available to display.</p>;\r\n        }\r\n        if (toolType === 'mindmap') {\r\n            return <div className=\"mindmap-modal-content-wrapper min-h-[60vh] h-[calc(70vh-80px)] flex justify-center items-center\"><MindmapViewer mermaidCode={analysisContent} ref={mindmapViewerRef} /></div>;\r\n        }\r\n        return <div ref={modalAnalysisContentRef} className=\"prose prose-sm dark:prose-invert max-w-none text-text-light dark:text-text-dark p-1 custom-scrollbar text-[0.8rem] leading-relaxed\" dangerouslySetInnerHTML={createMarkup(analysisContent)} />;\r\n    };\r\n\r\n    const showReasoning = aiReasoning && !placeholderReasoningMessages.some(msg => aiReasoning.includes(msg));\r\n\r\n    return (\r\n        <div className=\"card-base p-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n                <div className=\"flex items-center gap-2 text-sm font-medium text-text-light dark:text-text-dark focus:outline-none w-full text-left cursor-pointer hover:text-primary dark:hover:text-primary-light transition-colors\" onClick={() => setIsSectionOpen(!isSectionOpen)} aria-expanded={isSectionOpen}>\r\n                    <IconComponent size={16} className=\"text-primary dark:text-primary-light flex-shrink-0\" />\r\n                    <span className=\"flex-grow\">{title}</span>\r\n                </div>\r\n                <div className=\"flex items-center gap-1 flex-shrink-0\">\r\n                    <Button onClick={handleRunAnalysis} variant=\"primary\" size=\"sm\" className=\"!px-3 !py-1 text-xs\" isLoading={isLoading} disabled={!selectedDocumentFilename || isLoading} title={!selectedDocumentFilename ? \"Select a document first\" : `Run ${title} Analysis`}>\r\n                       {isLoading ? (currentEngagementText.split(' ')[0] || \"...\") : \"Run\"}\r\n                    </Button>\r\n                    <IconButton icon={isSectionOpen ? ChevronUp : ChevronDown} onClick={() => setIsSectionOpen(!isSectionOpen)} size=\"sm\" variant=\"ghost\" className=\"p-1\" aria-label={isSectionOpen ? \"Collapse section\" : \"Expand section\"} disabled={isLoading && isSectionOpen} />\r\n                </div>\r\n            </div>\r\n            <AnimatePresence>\r\n                {isSectionOpen && (\r\n                    <motion.div key=\"tool-section-content\" initial={{ height: 0, opacity: 0 }} animate={{ height: 'auto', opacity: 1 }} exit={{ height: 0, opacity: 0 }} transition={{ duration: 0.25, ease: \"easeInOut\" }} className=\"mt-2 pt-2 border-t border-border-light dark:border-border-dark overflow-hidden\">\r\n                        {isLoading && (<div className=\"text-xs text-text-muted-light dark:text-text-muted-dark p-2 flex items-center justify-center gap-2 animate-fadeIn\"><Loader2 size={14} className=\"animate-spin\"/> {currentEngagementText}</div>)}\r\n                        {error && !isLoading && (!analysisContent || analysisContent === error) && (<div className=\"my-2 p-2 bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-300 rounded-md text-xs flex items-center gap-1\"><AlertTriangle size={14} /> {error.length > 150 ? error.substring(0,147) + \"...\" : error}</div>)}\r\n                        {!isLoading && (analysisContent || aiReasoning) && isDropdownOpen && (\r\n                            <motion.div key=\"analysis-dropdown\" initial={{ opacity: 0, y: -10 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -10 }} transition={{ duration: 0.2 }} className=\"mt-2 space-y-2\">\r\n                                {showReasoning && aiReasoning && (\r\n                                    <details className=\"group text-xs rounded-md border border-border-light dark:border-border-dark bg-surface-light dark:bg-gray-800 shadow-sm\">\r\n                                        <summary className=\"flex items-center justify-between gap-1 p-2 cursor-pointer text-text-muted-light dark:text-text-muted-dark hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors rounded-t-md\"><span className=\"flex items-center gap-1.5 font-medium\"><Sparkles size={14} className=\"text-accent\" /> AI Reasoning</span><ChevronDown size={16} className=\"group-open:rotate-180 transition-transform\" /></summary>\r\n                                        <div ref={aiReasoningContentRef} className=\"p-2.5 prose prose-xs dark:prose-invert max-w-none text-text-light dark:text-text-dark max-h-60 overflow-y-auto custom-scrollbar text-[0.75rem] leading-relaxed bg-gray-50 dark:bg-gray-900/50 rounded-b-md\" dangerouslySetInnerHTML={createMarkup(aiReasoning)} />\r\n                                    </details>\r\n                                )}\r\n                                {analysisContent && !error && (\r\n                                     <Button onClick={() => setIsModalOpen(true)} variant=\"outline\" size=\"sm\" fullWidth leftIcon={<Eye size={14}/>} className=\"!py-1.5 text-xs border-primary/70 text-primary hover:bg-primary/10 dark:border-primary-light/70 dark:text-primary-light dark:hover:bg-primary-light/10\">View Full {title}</Button>\r\n                                )}\r\n                            </motion.div>\r\n                        )}\r\n                        {!isLoading && !isDropdownOpen && !error && (\r\n                            <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark p-2 text-center\">{selectedDocumentFilename ? `Click \"Run\" to ${isTargetAdminDoc ? 'fetch stored' : 'generate'} ${title.toLowerCase()} for \"${selectedDocumentFilename}\".` : \"Select a document to enable analysis.\"}</p>\r\n                        )}\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n            <Modal\r\n                isOpen={isModalOpen} onClose={() => setIsModalOpen(false)}\r\n                title={`${title} for \"${selectedDocumentFilename || 'document'}\"`}\r\n                size={toolType === 'mindmap' ? \"3xl\" : \"xl\"}\r\n                footerContent={\r\n                <>\r\n                    {toolType === 'mindmap' && analysisContent && !error && (\r\n                        <Button onClick={() => handleDownloadMindmap('svg')} variant=\"outline\" size=\"sm\" className=\"text-xs\" leftIcon={<Download size={14}/>}>SVG</Button>\r\n                    )}\r\n                    \r\n                    {toolType !== 'mindmap' && analysisContent && !error && (\r\n                        <>\r\n                           <Button \r\n                                onClick={() => handleGenerateDocument('pptx')} \r\n                                variant=\"outline\" size=\"sm\" className=\"text-xs\" \r\n                                leftIcon={<FileBarChart2 size={14}/>}\r\n                                isLoading={generatingDocType === 'pptx'}\r\n                                disabled={!!generatingDocType}\r\n                            >\r\n                                {generatingDocType === 'pptx' ? 'Generating...' : 'Generate PPTX'}\r\n                            </Button>\r\n                           <Button \r\n                                onClick={() => handleGenerateDocument('docx')} \r\n                                variant=\"outline\" size=\"sm\" className=\"text-xs\" \r\n                                leftIcon={<FileText size={14}/>}\r\n                                isLoading={generatingDocType === 'docx'}\r\n                                disabled={!!generatingDocType}\r\n                            >\r\n                                {generatingDocType === 'docx' ? 'Generating...' : 'Generate DOCX'}\r\n                            </Button>\r\n                        </>\r\n                    )}\r\n\r\n                    <div className=\"flex-grow\"></div>\r\n                    <Button onClick={() => setIsModalOpen(false)} variant=\"secondary\" size=\"sm\" className=\"text-xs\" disabled={!!generatingDocType}>\r\n                        Close\r\n                    </Button>\r\n                </>}\r\n            >\r\n                <div className={`max-h-[70vh] overflow-y-auto custom-scrollbar p-1 pr-2 rounded-md shadow-inner ${toolType === 'mindmap' ? 'bg-transparent dark:bg-transparent' : 'bg-gray-50 dark:bg-gray-800'}`}>\r\n                    {selectedDocumentFilename && (\r\n                        <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark mb-2 border-b border-border-light dark:border-border-dark pb-1.5\">\r\n                            Source Document: <strong>{selectedDocumentFilename}</strong>\r\n                        </p>\r\n                    )}\r\n                    {renderModalContent()}\r\n                </div>\r\n            </Modal>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AnalysisToolRunner;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\KnowledgeGraphViewer.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[78,88],"text":""},"desc":"Remove unused variable 'useEffect'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/analysis/KnowledgeGraphViewer.jsx\r\nimport React, { useEffect, useState, useMemo } from 'react';\r\nimport Graph from 'react-vis-network-graph';\r\nimport { Loader2, AlertTriangle, ZoomIn, ZoomOut, Maximize } from 'lucide-react';\r\nimport { useTheme } from '../../hooks/useTheme';\r\nimport IconButton from '../core/IconButton.jsx';\r\n\r\nconst KnowledgeGraphViewer = ({ graphData }) => {\r\n    const { theme } = useTheme();\r\n\r\n    // --- FIX START: Add state to hold the network instance ---\r\n    const [network, setNetwork] = useState(null);\r\n    // --- FIX END ---\r\n\r\n    // Memoize options to prevent re-renders\r\n    const options = useMemo(() => {\r\n        const isDark = theme === 'dark';\r\n        return {\r\n            layout: {\r\n                hierarchical: {\r\n                    enabled: true,\r\n                    direction: 'UD', // Up-Down\r\n                    sortMethod: 'directed',\r\n                    levelSeparation: 150,\r\n                    nodeSpacing: 200,\r\n                },\r\n            },\r\n            nodes: {\r\n                shape: 'box',\r\n                borderWidth: 1.5,\r\n                font: {\r\n                    color: isDark ? '#E2E8F0' : '#0F172A',\r\n                    size: 14,\r\n                    face: 'Inter',\r\n                },\r\n                color: {\r\n                    border: isDark ? '#4B5563' : '#9CA3AF',\r\n                    background: isDark ? '#1E293B' : '#FFFFFF',\r\n                    highlight: {\r\n                        border: '#3b82f6',\r\n                        background: isDark ? '#2563eb' : '#60a5fa',\r\n                    },\r\n                },\r\n                shadow: true,\r\n            },\r\n            edges: {\r\n                color: {\r\n                    color: isDark ? '#64748B' : '#9CA3AF',\r\n                    highlight: '#3b82f6',\r\n                },\r\n                arrows: {\r\n                    to: { enabled: true, scaleFactor: 0.7 },\r\n                },\r\n                font: {\r\n                    color: isDark ? '#94A3B8' : '#6B7280',\r\n                    size: 10,\r\n                    align: 'middle',\r\n                    strokeWidth: 2,\r\n                    strokeColor: isDark ? '#1E293B' : '#FFFFFF',\r\n                },\r\n                smooth: {\r\n                    type: 'cubicBezier',\r\n                    forceDirection: 'vertical',\r\n                    roundness: 0.4,\r\n                },\r\n            },\r\n            physics: {\r\n                enabled: true,\r\n                hierarchicalRepulsion: {\r\n                    centralGravity: 0.0,\r\n                    springLength: 100,\r\n                    springConstant: 0.01,\r\n                    nodeDistance: 200,\r\n                    damping: 0.09,\r\n                },\r\n                solver: 'hierarchicalRepulsion',\r\n            },\r\n            interaction: {\r\n                dragNodes: true,\r\n                dragView: true,\r\n                zoomView: true,\r\n                tooltipDelay: 200,\r\n            },\r\n            height: '100%',\r\n            width: '100%',\r\n        };\r\n    }, [theme]);\r\n\r\n    const formattedGraph = useMemo(() => {\r\n        if (!graphData || !graphData.nodes || !graphData.edges) {\r\n            return { nodes: [], edges: [] };\r\n        }\r\n        const nodes = graphData.nodes.map(node => ({\r\n            id: node.id,\r\n            label: node.id,\r\n            title: `Type: ${node.type}\\nParent: ${node.parent || 'N/A'}\\n\\n${node.description}`,\r\n            color: node.type === 'major' \r\n                ? { border: '#3b82f6', background: theme === 'dark' ? '#1E3A8A' : '#BFDBFE' } \r\n                : undefined,\r\n        }));\r\n        const edges = graphData.edges.map(edge => ({\r\n            from: edge.from,\r\n            to: edge.to,\r\n            label: edge.relationship.replace(/_/g, ' '),\r\n        }));\r\n        return { nodes, edges };\r\n    }, [graphData, theme]);\r\n\r\n    // --- FIX START: These handlers will now work because 'network' is in state ---\r\n    const handleZoomIn = () => network?.zoomIn();\r\n    const handleZoomOut = () => network?.zoomOut();\r\n    const handleFit = () => network?.fit();\r\n    // --- FIX END ---\r\n\r\n    if (!graphData) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-full\">\r\n                <Loader2 className=\"animate-spin text-primary mr-2\" /> Loading graph data...\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (graphData.error) {\r\n        return (\r\n             <div className=\"flex flex-col items-center justify-center h-full text-red-500\">\r\n                <AlertTriangle size={32} className=\"mb-2\" />\r\n                <p className=\"font-semibold\">Failed to load Knowledge Graph</p>\r\n                <p className=\"text-xs\">{graphData.error}</p>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    if (formattedGraph.nodes.length === 0) {\r\n        return (\r\n             <div className=\"flex flex-col items-center justify-center h-full text-text-muted-light dark:text-text-muted-dark\">\r\n                <AlertTriangle size={32} className=\"mb-2\" />\r\n                <p>No graph data found for this document.</p>\r\n             </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"relative w-full h-[70vh] border border-border-light dark:border-border-dark rounded-md bg-gray-50 dark:bg-gray-800/50\">\r\n            <Graph\r\n                key={theme}\r\n                graph={formattedGraph}\r\n                options={options}\r\n                // --- FIX START: Use the 'getNetwork' callback to update our state ---\r\n                getNetwork={net => setNetwork(net)}\r\n                // --- FIX END ---\r\n            />\r\n            <div className=\"absolute top-2 right-2 flex flex-col gap-1.5 bg-surface-light dark:bg-surface-dark p-1.5 rounded-md shadow-lg border border-border-light dark:border-border-dark\">\r\n                <IconButton icon={ZoomIn} onClick={handleZoomIn} title=\"Zoom In\" size=\"sm\" />\r\n                <IconButton icon={ZoomOut} onClick={handleZoomOut} title=\"Zoom Out\" size=\"sm\" />\r\n                <IconButton icon={Maximize} onClick={handleFit} title=\"Fit to View\" size=\"sm\" />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default KnowledgeGraphViewer;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\MindmapViewer.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'toast' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"toast"},"fix":{"range":[156,167],"text":""},"desc":"Remove unused variable 'toast'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/analysis/MindmapViewer.jsx\r\nimport React, { useEffect, useRef, useState, useImperativeHandle, forwardRef } from 'react';\r\nimport toast from 'react-hot-toast';\r\nimport { escapeHtml } from '../../utils/helpers.js';\r\n\r\nconst MindmapViewer = forwardRef(({ mermaidCode }, ref) => {\r\n    const svgContainerRef = useRef(null);\r\n    const [error, setError] = useState(null);\r\n    const [isMermaidReady, setIsMermaidReady] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [uniqueId] = useState(() => `mermaid-graph-${Math.random().toString(36).substr(2, 9)}`);\r\n\r\n    useImperativeHandle(ref, () => ({\r\n        getSvgElement: () => {\r\n            return svgContainerRef.current?.querySelector('svg');\r\n        }\r\n    }));\r\n\r\n    useEffect(() => {\r\n        if (typeof window.mermaid !== 'undefined') {\r\n            setIsMermaidReady(true);\r\n        } else {\r\n            const intervalId = setInterval(() => {\r\n                if (typeof window.mermaid !== 'undefined') {\r\n                    setIsMermaidReady(true);\r\n                    clearInterval(intervalId);\r\n                }\r\n            }, 100);\r\n            return () => clearInterval(intervalId);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!isMermaidReady || !mermaidCode || !svgContainerRef.current) {\r\n            if (svgContainerRef.current) svgContainerRef.current.innerHTML = '';\r\n            setError(null);\r\n            setIsLoading(false);\r\n            return;\r\n        }\r\n\r\n        const renderMermaidDiagram = async () => {\r\n            setIsLoading(true);\r\n            setError(null);\r\n            if (!svgContainerRef.current) {\r\n                setIsLoading(false);\r\n                return;\r\n            }\r\n            svgContainerRef.current.innerHTML = '<div class=\"flex justify-center items-center h-full w-full text-sm text-text-muted-light dark:text-text-muted-dark\"><div class=\"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-primary mr-2\"></div>Rendering diagram...</div>';\r\n            \r\n            let codeToRender = mermaidCode.trim();\r\n            \r\n            // --- THIS IS THE FIX ---\r\n            // New, more robust regex to find the diagram code.\r\n            // It looks for a code block that CONTAINS a known diagram type (e.g., 'graph', 'mindmap').\r\n            // It is no longer anchored to the start (^) of the string, so it can find the\r\n            // block even if there's leading garbage or extra backticks from the LLM.\r\n            const fenceRegex = /```(?:mermaid)?\\s*([\\s\\S]*?(?:graph|mindmap|flowchart|sequenceDiagram)[\\s\\S]*?)\\s*```/i;\r\n            const match = codeToRender.match(fenceRegex);\r\n\r\n            if (match && match[1]) {\r\n                // If we found a fenced block, use its content.\r\n                codeToRender = match[1].trim();\r\n            } else {\r\n                // Fallback for cases where LLM might forget the fences entirely.\r\n                // We still trim to remove potential whitespace.\r\n                codeToRender = codeToRender.trim();\r\n            }\r\n            // --- END OF FIX ---\r\n\r\n            try {\r\n                if (typeof window.mermaid === 'undefined') {\r\n                    throw new Error(\"Mermaid library failed to load or initialize properly.\");\r\n                }\r\n\r\n                const { svg, bindFunctions } = await window.mermaid.render(uniqueId, codeToRender);\r\n                \r\n                if (svgContainerRef.current) {\r\n                    svgContainerRef.current.innerHTML = svg;\r\n                    if (bindFunctions) {\r\n                        bindFunctions(svgContainerRef.current);\r\n                    }\r\n                    const svgElement = svgContainerRef.current.querySelector('svg');\r\n                    if (svgElement) {\r\n                        svgElement.style.width = '100%';\r\n                        svgElement.style.height = 'auto'; \r\n                        svgElement.style.maxWidth = '100%'; \r\n                        svgElement.style.display = 'block';\r\n                    }\r\n                }\r\n            } catch (e) {\r\n                console.error(\"Error rendering Mermaid diagram with input:\", codeToRender, e);\r\n                const errorMsg = e.message || \"Failed to render mind map. Invalid Mermaid syntax?\";\r\n                setError(errorMsg);\r\n                if (svgContainerRef.current) {\r\n                    const codeSnippet = escapeHtml(codeToRender.substring(0, 200) + (codeToRender.length > 200 ? \"...\" : \"\"));\r\n                    svgContainerRef.current.innerHTML = `<div class=\"p-4 text-center text-red-500 dark:text-red-400 text-xs break-all\"><strong>Error rendering:</strong> ${escapeHtml(errorMsg)}<br><strong class='mt-2 block'>Input Code (first 200 chars):</strong><pre class='text-left text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded mt-1 whitespace-pre-wrap'>${codeSnippet}</pre></div>`;\r\n                }\r\n            } finally {\r\n                setIsLoading(false);\r\n            }\r\n        };\r\n\r\n        const timer = setTimeout(renderMermaidDiagram, 100); \r\n        return () => clearTimeout(timer);\r\n        \r\n    }, [mermaidCode, uniqueId, isMermaidReady]);\r\n\r\n    if (!isMermaidReady && !error) {\r\n      return <div className=\"p-4 text-center text-text-muted-light dark:text-text-muted-dark text-xs\">Waiting for Mermaid.js library...</div>;\r\n    }\r\n    if (error && (!isLoading || (svgContainerRef.current && svgContainerRef.current.innerHTML.includes('Error rendering')))) {\r\n        return <div ref={svgContainerRef} className=\"mermaid-diagram-render-area w-full h-full flex justify-center items-center bg-gray-50 dark:bg-gray-800/50 p-2 rounded-md\">\r\n                {/* Error message will be injected by useEffect's catch block */}\r\n               </div>;\r\n    }\r\n    \r\n    if (isLoading) { \r\n         return <div ref={svgContainerRef} className=\"mermaid-diagram-render-area w-full h-full flex justify-center items-center bg-gray-50 dark:bg-gray-800/50 p-2 rounded-md\">\r\n            {/* Loading message is set by renderMermaidDiagram's initial innerHTML write */}\r\n         </div>;\r\n    }\r\n\r\n    if (!mermaidCode && !error && isMermaidReady) { \r\n        return <p className=\"text-xs text-center text-text-muted-light dark:text-text-muted-dark p-4\">No mind map data to display.</p>;\r\n    }\r\n    \r\n    return (\r\n        <div \r\n            ref={svgContainerRef} \r\n            className=\"mermaid-diagram-render-area w-full h-full flex justify-center items-center bg-gray-50 dark:bg-gray-800/50 p-2 rounded-md\"\r\n        >\r\n\r\n        </div>\r\n    );\r\n});\r\n\r\nexport default MindmapViewer;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\PodcastGenerator.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[299,306],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/analysis/PodcastGenerator.jsx\r\nimport React, { useState } from 'react';\r\nimport api from '../../services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport { Headphones, ChevronDown, ChevronUp } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nfunction PodcastGenerator({ selectedDocumentFilename }) {\r\n    const [isSectionOpen, setIsSectionOpen] = useState(true);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [podcastPurpose, setPodcastPurpose] = useState('review');\r\n    const [podcastLength, setPodcastLength] = useState('standard');\r\n\r\n    const handleGeneratePodcast = async () => {\r\n        if (!selectedDocumentFilename) {\r\n            toast.error(\"Please select a document first.\");\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        const toastId = toast.loading(\"Generating high-quality podcast script & audio. This may take a moment...\");\r\n        try {\r\n            const { audioBlob, sourceDocumentName } = await api.generatePodcast({\r\n                analysisContent: `A study session on: ${selectedDocumentFilename}`,\r\n                sourceDocumentName: selectedDocumentFilename,\r\n                podcastOptions: { studyPurpose: podcastPurpose, sessionLength: podcastLength }\r\n            });\r\n            \r\n            toast.success(\"High-Quality Podcast is ready for download!\", { id: toastId, duration: 5000 });\r\n\r\n            const url = window.URL.createObjectURL(audioBlob);\r\n            const link = document.createElement('a');\r\n            const safeFilename = sourceDocumentName.split('.')[0].replace(/[^a-zA-Z0-9]/g, '_');\r\n            link.href = url;\r\n            link.setAttribute('download', `AI_Podcast_${safeFilename}.mp3`);\r\n            document.body.appendChild(link);\r\n            link.click();\r\n            link.parentNode.removeChild(link);\r\n            window.URL.revokeObjectURL(url);\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || err.message || \"Failed to generate podcast.\";\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"card-base p-3\">\r\n            <div className=\"flex items-center justify-between cursor-pointer\" onClick={() => setIsSectionOpen(!isSectionOpen)}>\r\n                <div className=\"flex items-center gap-2 text-sm font-medium text-text-light dark:text-text-dark\">\r\n                    <Headphones size={16} className=\"text-accent\" />\r\n                    <span className=\"flex-grow\">HQ Podcast Generator</span>\r\n                </div>\r\n                {isSectionOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n            </div>\r\n            <AnimatePresence>\r\n                {isSectionOpen && (\r\n                    <motion.div initial={{ height: 0, opacity: 0 }} animate={{ height: 'auto', opacity: 1 }} exit={{ height: 0, opacity: 0 }} transition={{ duration: 0.2, ease: \"easeInOut\" }} className=\"mt-2 pt-2 border-t border-border-light dark:border-border-dark overflow-hidden\">\r\n                        <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark mb-3\">\r\n                            Generate a high-quality, conversational audio study session from the selected document.\r\n                        </p>\r\n                        <div className=\"flex flex-col sm:flex-row gap-2 mb-3\">\r\n                            <div className=\"flex-1\">\r\n                                <label htmlFor=\"podcast-purpose\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">Purpose</label>\r\n                                <select id=\"podcast-purpose\" value={podcastPurpose} onChange={(e) => setPodcastPurpose(e.target.value)} className=\"input-field !text-xs !py-1.5 !px-2 w-full\" disabled={isLoading}>\r\n                                    <option value=\"review\">General Review</option>\r\n                                    <option value=\"introduction\">Introduction</option>\r\n                                    <option value=\"exam_prep\">Exam Prep</option>\r\n                                    <option value=\"deep_dive\">Deep Dive</option>\r\n                                </select>\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <label htmlFor=\"podcast-length\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">Length</label>\r\n                                <select id=\"podcast-length\" value={podcastLength} onChange={(e) => setPodcastLength(e.target.value)} className=\"input-field !text-xs !py-1.5 !px-2 w-full\" disabled={isLoading}>\r\n                                    <option value=\"quick\">Quick (~5-7m)</option>\r\n                                    <option value=\"standard\">Standard (~10-15m)</option>\r\n                                    <option value=\"comprehensive\">Comprehensive (~15-25m)</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n                        <Button\r\n                            onClick={handleGeneratePodcast}\r\n                            variant=\"primary\"\r\n                            size=\"sm\"\r\n                            fullWidth\r\n                            isLoading={isLoading}\r\n                            disabled={!selectedDocumentFilename || isLoading}\r\n                            title={!selectedDocumentFilename ? \"Select a document first\" : \"Generate Podcast\"}\r\n                        >\r\n                           {isLoading ? 'Generating Audio...' : 'Generate High-Quality Podcast'}\r\n                        </Button>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default PodcastGenerator;\r\n// This code defines a React component for generating podcasts from selected documents.\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\RealtimeKgPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\analysis\\RightPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[454,493],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/analysis/RightPanel.jsx\r\nimport React, { useState } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext';\r\n// FIX: Use the new, more capable AnalysisToolRunner component\r\nimport AnalysisToolRunner from './AnalysisToolRunner.jsx'; // FIX: Corrected relative import path\r\nimport { PanelRightClose, ChevronDown, ChevronUp, Telescope } from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { motion } from 'framer-motion';\r\n\r\nfunction RightPanel() {\r\n    const { setIsRightPanelOpen, selectedDocumentForAnalysis, selectedSubject } = useAppState();\r\n    const [isAnalyzerOpen, setIsAnalyzerOpen] = useState(true);\r\n\r\n    const currentSelectedDocFilename = selectedDocumentForAnalysis || null;\r\n    const isTargetAdminSubject = !!(selectedSubject && currentSelectedDocFilename && selectedSubject === currentSelectedDocFilename);\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full p-3 sm:p-4 bg-surface-light dark:bg-surface-dark text-text-light dark:text-text-dark custom-scrollbar\">\r\n            <div className=\"flex items-center justify-between mb-4 pb-2 border-b border-border-light dark:border-border-dark\">\r\n                <h2 className=\"text-base font-semibold\">Advanced Analyzer</h2>\r\n                <IconButton\r\n                    icon={PanelRightClose}\r\n                    onClick={() => setIsRightPanelOpen(false)}\r\n                    title=\"Close Analyzer Panel\"\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                />\r\n            </div>\r\n\r\n            <button\r\n                onClick={() => setIsAnalyzerOpen(!isAnalyzerOpen)}\r\n                className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none shadow-sm border border-border-light dark:border-border-dark mb-3\"\r\n            >\r\n                <span className=\"flex items-center gap-2\"><Telescope size={16} /> Analysis Tools</span>\r\n                {isAnalyzerOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n            </button>\r\n\r\n            {isAnalyzerOpen && (\r\n                <motion.div\r\n                    initial={{ height: 0, opacity: 0 }}\r\n                    animate={{ height: 'auto', opacity: 1 }}\r\n                    exit={{ height: 0, opacity: 0 }}\r\n                    transition={{ duration: 0.2, ease: \"easeInOut\" }}\r\n                    className=\"flex-grow space-y-3 overflow-y-auto custom-scrollbar pr-1\"\r\n                >\r\n                    {!currentSelectedDocFilename && (\r\n                        <div className=\"p-4 text-xs text-center text-text-muted-light dark:text-text-muted-dark bg-gray-50 dark:bg-gray-800 rounded-md border border-dashed border-border-light dark:border-border-dark\">\r\n                            <p>Select a document from the left panel to enable analysis tools.</p>\r\n                        </div>\r\n                    )}\r\n                    {/* FIX: Use AnalysisToolRunner and pass the isTargetAdminDoc prop */}\r\n                    <AnalysisToolRunner toolType=\"faq\" title=\"FAQ Generator\" iconName=\"HelpCircle\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                    <AnalysisToolRunner toolType=\"topics\" title=\"Key Topics Extractor\" iconName=\"Tags\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                    <AnalysisToolRunner toolType=\"mindmap\" title=\"Mind Map Creator\" iconName=\"GitFork\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                </motion.div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\nexport default RightPanel;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\auth\\AuthModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[645,652],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/auth/AuthModal.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../../hooks/useAuth.jsx';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport LLMSelection from './LLMSelection.jsx';\r\nimport OtpInputComponent from './OtpInput.jsx';\r\nimport toast from 'react-hot-toast';\r\nimport { LogIn, UserPlus, X, KeyRound, AtSign, AlertCircle, HardDrive, CheckSquare, Square, User, School, Hash, Award, Wrench, Calendar, Lightbulb, Goal, ChevronDown } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { motion,AnimatePresence } from 'framer-motion';\r\nimport api from '../../services/api.js';\r\n\r\nconst yearOptions = {\r\n    \"Bachelor's\": [\"1st Year\", \"2nd Year\", \"3rd Year\", \"4th Year\"],\r\n    \"Master's\": [\"1st Year\", \"2nd Year\"],\r\n    \"PhD\": [\"Coursework\", \"Research Phase\", \"Writing Phase\"],\r\n    \"Diploma\": [\"1st Year\", \"2nd Year\", \"3rd Year\"]\r\n};\r\n\r\nconst getYearOptions = (degree) => {\r\n    return yearOptions[degree] || [\"1st Year\", \"2nd Year\", \"3rd Year\", \"4th Year\", \"Graduated\"];\r\n};\r\n\r\nfunction AuthModal({ isOpen, onClose, initialViewIsLogin }) {\r\n    const { login, signup } = useAuth();\r\n    const { switchLLM: setGlobalLLM, selectedLLM } = useAppState();\r\n\r\n    const [isLoginView, setIsLoginView] = useState(initialViewIsLogin);\r\n    const [step, setStep] = useState(1);\r\n    const [isOtpSent, setIsOtpSent] = useState(false);\r\n    const [isSendingOtp, setIsSendingOtp] = useState(false);\r\n    const [otp, setOtp] = useState('');\r\n\r\n    const [formData, setFormData] = useState({\r\n        email: '', password: '', localSelectedLLM: 'gemini',\r\n        apiKey: '', ollamaUrl: '', requestKeyFromAdmin: false,\r\n        name: '', college: '', universityNumber: '',\r\n        degreeType: \"Bachelor's\", branch: 'Computer Science', year: '1st Year',\r\n        learningStyle: 'Reading/Writing', currentGoals: ''\r\n    });\r\n\r\n    const [error, setError] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const emailRegex = /^\\w+([.-]?\\w+)*@\\w+([.-]?\\w+)*(\\.\\w{2,3})+$/;\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setError(''); setStep(1); setIsOtpSent(false); setIsSendingOtp(false);\r\n            setOtp(''); setIsLoginView(initialViewIsLogin);\r\n            setFormData({\r\n                email: '', password: '', localSelectedLLM: selectedLLM || 'gemini',\r\n                apiKey: '', ollamaUrl: '', requestKeyFromAdmin: false,\r\n                name: '', college: '', universityNumber: '',\r\n                degreeType: \"Bachelor's\", branch: 'Computer Science', year: '1st Year',\r\n                learningStyle: 'Reading/Writing', currentGoals: ''\r\n            });\r\n        }\r\n    }, [isOpen, selectedLLM, initialViewIsLogin]);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value, type, checked } = e.target;\r\n        setFormData(prev => {\r\n            const newState = { ...prev, [name]: type === 'checkbox' ? checked : value };\r\n            if (name === 'degreeType') {\r\n                newState.year = getYearOptions(value)[0];\r\n            }\r\n            return newState;\r\n        });\r\n    };\r\n\r\n    const handleSendOtp = async () => {\r\n        setError('');\r\n        if (!emailRegex.test(formData.email)) return setError(\"Please enter a valid email address.\");\r\n        if (formData.password.length < 6) return setError(\"Password must be at least 6 characters long.\");\r\n        \r\n        setIsSendingOtp(true);\r\n        const toastId = toast.loading('Sending verification code...');\r\n        try {\r\n            const response = await api.sendOtp(formData.email, formData.password);\r\n            toast.success(response.message, { id: toastId });\r\n            setIsOtpSent(true);\r\n        } catch (err) {\r\n            setError(err.response?.data?.message || err.message);\r\n            toast.error(err.response?.data?.message || err.message, { id: toastId });\r\n        } finally {\r\n            setIsSendingOtp(false);\r\n        }\r\n    };\r\n    \r\n    const handleNext = () => {\r\n        setError('');\r\n        if (isOtpSent && otp.length !== 6) return setError(\"Please enter the 6-digit verification code.\");\r\n        if (step === 2 && (!formData.name.trim() || !formData.college.trim() || !formData.universityNumber.trim())) {\r\n            return setError(\"Please fill out all academic profile fields.\");\r\n        }\r\n        setStep(prev => prev + 1);\r\n    };\r\n    \r\n    const handleBack = () => { setError(''); setStep(prev => prev - 1); };\r\n    \r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        setError('');\r\n        setLoading(true);\r\n\r\n        if (isLoginView) {\r\n            const toastId = toast.loading('Logging in...');\r\n            try {\r\n                const { email, password } = formData;\r\n                if (!emailRegex.test(email)) throw new Error(\"Please enter a valid email address.\");\r\n                const authDataResponse = await login({ email, password });\r\n                if (authDataResponse.isAdminLogin) toast.success(\"Admin login successful!\", { id: toastId });\r\n                else toast.success(authDataResponse.message || 'Login Successful!', { id: toastId });\r\n                onClose(authDataResponse);\r\n            } catch (err) {\r\n                const errorMessage = err.response?.data?.message || err.message;\r\n                setError(errorMessage);\r\n                toast.error(errorMessage, { id: toastId });\r\n            } finally { setLoading(false); }\r\n        } else { \r\n            const toastId = toast.loading('Creating your account...');\r\n            if (formData.localSelectedLLM === 'gemini' && !formData.apiKey.trim() && !formData.requestKeyFromAdmin) {\r\n                setLoading(false); toast.dismiss(toastId);\r\n                return setError(\"Gemini API Key is required, or request one from the admin.\");\r\n            }\r\n            if (formData.localSelectedLLM === 'ollama' && !formData.ollamaUrl.trim()) {\r\n                setLoading(false); toast.dismiss(toastId);\r\n                return setError(\"Ollama URL is required.\");\r\n            }\r\n            \r\n            try {\r\n                const finalSignupData = { ...formData, otp };\r\n                const authDataResponse = await signup(finalSignupData);\r\n                setGlobalLLM(formData.localSelectedLLM);\r\n                toast.success(authDataResponse.message || 'Signup Successful!', { id: toastId });\r\n                onClose(authDataResponse);\r\n            } catch (err) {\r\n                const errorMessage = err.response?.data?.message || err.message;\r\n                setError(errorMessage);\r\n                toast.error(errorMessage, { id: toastId });\r\n            } finally { setLoading(false); }\r\n        }\r\n    };\r\n\r\n    const inputWrapperClass = \"relative\";\r\n    const inputIconClass = \"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted-light dark:text-text-muted-dark\";\r\n    const inputFieldStyledClass = \"input-field pl-10 py-2.5 text-sm w-full\";\r\n\r\n    const renderStep1 = () => (\r\n        <div className=\"space-y-5\">\r\n            <div className={inputWrapperClass}>\r\n                <AtSign className={inputIconClass} />\r\n                <input type=\"email\" name=\"email\" className={inputFieldStyledClass} placeholder=\"Email Address\" value={formData.email} onChange={handleChange} required disabled={loading || isOtpSent || isSendingOtp} />\r\n            </div>\r\n            <div className={inputWrapperClass}>\r\n                <KeyRound className={inputIconClass} />\r\n                <input type=\"password\" name=\"password\" className={inputFieldStyledClass} placeholder=\"Password (min. 6 characters)\" value={formData.password} onChange={handleChange} required minLength=\"6\" disabled={loading || isOtpSent || isSendingOtp} />\r\n            </div>\r\n            \r\n            <AnimatePresence>\r\n                {isOtpSent && (\r\n                    <motion.div key=\"otp-input\" initial={{ opacity: 0, y: 10 }} animate={{ opacity: 1, y: 0 }} className=\"pt-2 text-center\">\r\n                        <label className=\"block text-sm font-medium text-text-light dark:text-text-dark mb-3\">A verification code has been sent to your email.</label>\r\n                        <OtpInputComponent otp={otp} setOtp={setOtp} onComplete={handleNext} />\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n    \r\n    const renderStep2 = () => (\r\n        <div className=\"space-y-4\">\r\n            <p className=\"text-sm text-center text-text-muted-light dark:text-text-muted-dark\">Tell us a bit about your academic background.</p>\r\n            <div className={inputWrapperClass}>\r\n                <User className={inputIconClass} />\r\n                <input type=\"text\" name=\"name\" value={formData.name} onChange={handleChange} placeholder=\"Full Name\" className={inputFieldStyledClass} required />\r\n            </div>\r\n            <div className={inputWrapperClass}>\r\n                <School className={inputIconClass} />\r\n                <input type=\"text\" name=\"college\" value={formData.college} onChange={handleChange} placeholder=\"College / Institution\" className={inputFieldStyledClass} required />\r\n            </div>\r\n            <div className={inputWrapperClass}>\r\n                <Hash className={inputIconClass} />\r\n                <input type=\"text\" name=\"universityNumber\" value={formData.universityNumber} onChange={handleChange} placeholder=\"University Number\" className={inputFieldStyledClass} required />\r\n            </div>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-3\">\r\n                <div className={inputWrapperClass}>\r\n                    <Award className={inputIconClass} />\r\n                    <select name=\"degreeType\" value={formData.degreeType} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                        <option>Bachelor's</option><option>Master's</option><option>PhD</option><option>Diploma</option>\r\n                    </select>\r\n                    <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n                <div className={inputWrapperClass}>\r\n                    <Wrench className={inputIconClass} />\r\n                    <select name=\"branch\" value={formData.branch} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                        <option>Computer Science</option><option>Mechanical</option><option>Electrical</option><option>Civil</option><option>Electronics</option><option>Other</option>\r\n                    </select>\r\n                    <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n                <div className={inputWrapperClass}>\r\n                    <Calendar className={inputIconClass} />\r\n                    <select name=\"year\" value={formData.year} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                        {getYearOptions(formData.degreeType).map(option => (\r\n                            <option key={option} value={option}>{option}</option>\r\n                        ))}\r\n                    </select>\r\n                    <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    const renderStep3 = () => (\r\n        <div className=\"space-y-4\">\r\n            <div className=\"space-y-2\">\r\n                <label className=\"block text-sm font-medium text-text-light dark:text-text-dark\">How do you learn best?</label>\r\n                <div className={inputWrapperClass}>\r\n                    <Lightbulb className={inputIconClass} />\r\n                    <select name=\"learningStyle\" value={formData.learningStyle} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                        <option>Reading/Writing (detailed text)</option>\r\n                        <option>Visual (diagrams, mind maps)</option>\r\n                        <option>Auditory (podcasts, explanations)</option>\r\n                        <option>Kinesthetic (hands-on examples, code)</option>\r\n                    </select>\r\n                    <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n                <label className=\"block text-sm font-medium text-text-light dark:text-text-dark\">What are your current learning goals? (Optional)</label>\r\n                <div className={inputWrapperClass}>\r\n                    <Goal className={inputIconClass} />\r\n                    <textarea name=\"currentGoals\" value={formData.currentGoals} onChange={handleChange} placeholder=\"e.g., 'Prepare for my AI exam', 'Understand thermodynamics basics'\" className={`${inputFieldStyledClass} !h-24 resize-none`} maxLength=\"500\"></textarea>\r\n                </div>\r\n            </div>\r\n            <div className=\"!mt-6\">\r\n                <LLMSelection selectedLLM={formData.localSelectedLLM} onLlmChange={(llm) => handleChange({ target: { name: 'localSelectedLLM', value: llm }})} disabled={loading} />\r\n            </div>\r\n        </div>\r\n    );\r\n    \r\n    return (\r\n        <div className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn\">\r\n            <motion.div \r\n                key=\"auth-modal-content\"\r\n                initial={{ opacity: 0, scale: 0.95, y: -10 }}\r\n                animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                exit={{ opacity: 0, scale: 0.95, y: 10 }}\r\n                className=\"card-base p-6 sm:p-8 w-full max-w-lg\"\r\n            >\r\n                <div className=\"flex justify-between items-start mb-4\">\r\n                    <div>\r\n                        <h2 className=\"text-xl sm:text-2xl font-bold\">{isLoginView ? 'Welcome Back' : 'Create Your Account'}</h2>\r\n                        {!isLoginView && <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">Step {step} of 3</p>}\r\n                    </div>\r\n                    <IconButton icon={X} onClick={() => onClose(null)} variant=\"ghost\" size=\"sm\" title=\"Close\" />\r\n                </div>\r\n\r\n                {!isLoginView && (\r\n                    <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 mb-6\">\r\n                        <motion.div\r\n                            className=\"bg-primary h-1.5 rounded-full\"\r\n                            initial={{ width: '0%' }}\r\n                            animate={{ width: `${(step / 3) * 100}%` }}\r\n                            transition={{ ease: \"easeInOut\", duration: 0.5 }}\r\n                        />\r\n                    </div>\r\n                )}\r\n                \r\n                {error && (\r\n                    <div className=\"mb-4 p-3 bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-300 rounded-md text-sm flex items-center gap-2\">\r\n                        <AlertCircle size={16}/>{error}\r\n                    </div>\r\n                )}\r\n\r\n                <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n                    <AnimatePresence mode=\"wait\">\r\n                        <motion.div\r\n                            key={isLoginView ? 'login' : `step${step}`}\r\n                            initial={{ opacity: 0, x: 20 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            exit={{ opacity: 0, x: -20 }}\r\n                            transition={{ duration: 0.2 }}\r\n                        >\r\n                            {isLoginView ? (\r\n                                <div className=\"space-y-5\">\r\n                                    <div className={inputWrapperClass}>\r\n                                        <AtSign className={inputIconClass} />\r\n                                        <input type=\"email\" name=\"email\" className={inputFieldStyledClass} placeholder=\"Email Address\" value={formData.email} onChange={handleChange} required disabled={loading} />\r\n                                    </div>\r\n                                    <div className={inputWrapperClass}>\r\n                                        <KeyRound className={inputIconClass} />\r\n                                        <input type=\"password\" name=\"password\" className={inputFieldStyledClass} placeholder=\"Password\" value={formData.password} onChange={handleChange} required disabled={loading} />\r\n                                    </div>\r\n                                </div>\r\n                            ) : (\r\n                                <>\r\n                                    {step === 1 && renderStep1()}\r\n                                    {step === 2 && renderStep2()}\r\n                                    {step === 3 && renderStep3()}\r\n                                </>\r\n                            )}\r\n                        </motion.div>\r\n                    </AnimatePresence>\r\n                    \r\n                    {!isLoginView && step === 3 && (\r\n                        <div className=\"space-y-4 pt-2 animate-fadeIn\">\r\n                            <div style={{ display: formData.localSelectedLLM === 'gemini' ? 'block' : 'none' }}>\r\n                                <motion.div key=\"gemini-input\" initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\r\n                                    <div className=\"flex items-center mb-3\">\r\n                                        <button type=\"button\" onClick={() => handleChange({ target: { name: 'requestKeyFromAdmin', type: 'checkbox', checked: !formData.requestKeyFromAdmin }})} className=\"flex items-center text-sm text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\" disabled={loading}>\r\n                                            {formData.requestKeyFromAdmin ? <CheckSquare size={16} className=\"text-primary mr-2\" /> : <Square size={16} className=\"mr-2\" />}\r\n                                            Request API Key from Admin\r\n                                        </button>\r\n                                    </div>\r\n                                    <AnimatePresence>\r\n                                        {!formData.requestKeyFromAdmin && (\r\n                                            <motion.div key=\"api-key-field\" initial={{ opacity: 0, height: 0 }} animate={{ opacity: 1, height: 'auto' }} exit={{ opacity: 0, height: 0 }} className=\"overflow-hidden\">\r\n                                                <label htmlFor=\"api-key-input\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">Gemini API Key <span className=\"text-red-500\">*</span></label>\r\n                                                <div className={inputWrapperClass}>\r\n                                                    <KeyRound className={inputIconClass} />\r\n                                                    <input type=\"password\" name=\"apiKey\" id=\"api-key-input\" className={inputFieldStyledClass} placeholder=\"Enter your Gemini API Key\" value={formData.apiKey} onChange={handleChange} required={!formData.requestKeyFromAdmin && formData.localSelectedLLM === 'gemini'} disabled={loading} />\r\n                                                </div>\r\n                                            </motion.div>\r\n                                        )}\r\n                                    </AnimatePresence>\r\n                                </motion.div>\r\n                            </div>\r\n                            <div style={{ display: formData.localSelectedLLM === 'ollama' ? 'block' : 'none' }}>\r\n                                <motion.div key=\"ollama-input\" initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\r\n                                    <label htmlFor=\"ollama-url-input\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">Ollama URL <span className=\"text-red-500\">*</span></label>\r\n                                    <div className={inputWrapperClass}>\r\n                                        <HardDrive className={inputIconClass} />\r\n                                        <input type=\"text\" name=\"ollamaUrl\" id=\"ollama-url-input\" className={inputFieldStyledClass} placeholder=\"e.g., http://localhost:11434\" value={formData.ollamaUrl} onChange={handleChange} required={formData.localSelectedLLM === 'ollama'} disabled={loading} />\r\n                                    </div>\r\n                                </motion.div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                    \r\n                    <div className=\"pt-2 flex items-center gap-3\">\r\n                        {!isLoginView && step > 1 && (\r\n                            <Button type=\"button\" variant=\"secondary\" onClick={handleBack} disabled={loading}> Back </Button>\r\n                        )}\r\n                        <div className=\"flex-grow\">\r\n                            {isLoginView ? (\r\n                                <Button type=\"submit\" fullWidth isLoading={loading} leftIcon={<LogIn size={18}/>} className=\"py-2.5 !text-base\">Login</Button>\r\n                            ) : step < 3 ? (\r\n                                 !isOtpSent ? (\r\n                                    <Button type=\"button\" fullWidth onClick={handleSendOtp} isLoading={isSendingOtp} disabled={loading} className=\"py-2.5 !text-base\">Send Code & Continue</Button>\r\n                                ) : (\r\n                                    <Button type=\"button\" fullWidth onClick={handleNext} disabled={loading || otp.length !== 6} className=\"py-2.5 !text-base\">Continue</Button>\r\n                                )\r\n                            ) : (\r\n                                <Button type=\"submit\" fullWidth isLoading={loading} leftIcon={<UserPlus size={18}/>} className=\"py-2.5 !text-base\">Create Account</Button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n\r\n                <p className=\"mt-6 text-center text-sm\">\r\n                    <button onClick={() => { setIsLoginView(!isLoginView); setError(''); setStep(1); setIsOtpSent(false); setOtp(''); }} className=\"font-medium text-primary hover:underline\" disabled={loading}>\r\n                        {isLoginView ? \"Don't have an account? Sign Up\" : \"Already have an account? Login\"}\r\n                    </button>\r\n                </p>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\nexport default AuthModal;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\auth\\LLMSelection.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\auth\\OtpInput.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\ChatHistory.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[167,174],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/chat/ChatHistory.jsx\r\n\r\nimport React, { useRef, useEffect, useState } from 'react';\r\nimport MessageBubble from './MessageBubble';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { ArrowDownCircle } from 'lucide-react';\r\n\r\nfunction ChatHistory({ messages, onCueClick }) {\r\n    \r\n    const scrollRef = useRef(null);\r\n    const [showScrollButton, setShowScrollButton] = useState(false);\r\n\r\n    const handleScroll = () => {\r\n        const { scrollTop, scrollHeight, clientHeight } = scrollRef.current;\r\n        if (!scrollRef.current) return;\r\n        if (scrollHeight - scrollTop > clientHeight + 200) {\r\n            setShowScrollButton(true);\r\n        } else {\r\n            setShowScrollButton(false);\r\n        }\r\n    };\r\n\r\n    const scrollToBottom = (behavior = 'smooth') => {\r\n        if (scrollRef.current) {\r\n            scrollRef.current.scrollTo({\r\n                top: scrollRef.current.scrollHeight,\r\n                behavior: behavior,\r\n            });\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        scrollToBottom('auto');\r\n    }, [messages]);\r\n    \r\n\r\n    return (\r\n        <div className=\"relative flex-1\">\r\n            <div ref={scrollRef} onScroll={handleScroll} className=\"absolute inset-0 overflow-y-auto custom-scrollbar p-4 space-y-4\">\r\n                <AnimatePresence initial={false}>\r\n                    {messages.map((msg) => (\r\n                        <motion.div\r\n                        key={msg.id}\r\n                        layout\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        exit={{ opacity: 0, y: -10, transition: { duration: 0.15 } }}\r\n                        transition={{ duration: 0.3, ease: \"easeOut\" }}\r\n                        >\r\n                            <MessageBubble\r\n                                id={msg.id}\r\n                                sender={msg.sender}\r\n                                text={msg.text}\r\n                                thinking={msg.thinking}\r\n                                references={msg.references}\r\n                                timestamp={msg.timestamp}\r\n                                sourcePipeline={msg.source_pipeline}\r\n                                isStreaming={msg.isStreaming}\r\n                                criticalThinkingCues={msg.criticalThinkingCues}\r\n                                onCueClick={onCueClick}\r\n                                messageId={msg.id}\r\n                                logId={msg.logId} \r\n                            />\r\n                        </motion.div>\r\n                    ))}\r\n                </AnimatePresence>\r\n            </div>\r\n\r\n            <AnimatePresence>\r\n                {showScrollButton && (\r\n                    <motion.button\r\n                        initial={{ opacity: 0, scale: 0.5 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        exit={{ opacity: 0, scale: 0.5 }}\r\n                        onClick={() => scrollToBottom('smooth')}\r\n                        className=\"absolute bottom-5 right-5 z-20 p-2 bg-primary dark:bg-primary-dark text-white rounded-full shadow-lg hover:scale-110 transition-transform\"\r\n                        title=\"Scroll to bottom\"\r\n                    >\r\n                        <ArrowDownCircle size={24} />\r\n                    </motion.button>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ChatHistory;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\ChatHistoryModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":17,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":17,"endColumn":15},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":28,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":28,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[1159,1164],"text":""},"desc":"Remove unused variable 'error'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleDeleteSession' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":114,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":114,"endColumn":30,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleDeleteSession"},"fix":{"range":[4301,5123],"text":""},"desc":"Remove unused variable 'handleDeleteSession'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/components/chat/ChatHistoryModal.jsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { X, MessageSquareText, Loader2, AlertTriangle, Trash2 } from 'lucide-react';\r\nimport Modal from '../core/Modal.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport ConfirmationModal from '../core/ConfirmationModal.jsx';\r\n\r\n\r\nconst formatDate = (dateString) => {\r\n    if (!dateString) return 'N/A';\r\n    try {\r\n        return new Date(dateString).toLocaleString(undefined, { \r\n            month: 'short', day: 'numeric', year: 'numeric', hour: '2-digit', minute: '2-digit' \r\n        });\r\n    } catch (e) {\r\n        return 'Invalid Date';\r\n    }\r\n};\r\n\r\nfunction ChatHistoryModal({ isOpen, onClose, onSelectSession }) {\r\n    const [sessions, setSessions] = useState([]);\r\n    const [selectedSessionId, setSelectedSessionId] = useState(null);\r\n    const [sessionMessages, setSessionMessages] = useState([]);\r\n    const [loadingSessions, setLoadingSessions] = useState(false);\r\n    const [loadingMessages, setLoadingMessages] = useState(false);\r\n    const [error, setError] = useState('');\r\n    const [sessionToDelete, setSessionToDelete] = useState(null);\r\n\r\n    const fetchSessions = useCallback(async () => {\r\n        if (!isOpen) return; \r\n        setLoadingSessions(true);\r\n        setError('');\r\n        try {\r\n            const data = await api.getChatSessions();\r\n            setSessions(Array.isArray(data) ? data : []);\r\n        } catch (err) {\r\n            toast.error(\"Failed to load chat sessions.\");\r\n            setError(err.message || \"Could not fetch sessions.\");\r\n        } finally {\r\n            setLoadingSessions(false);\r\n        }\r\n    }, [isOpen]);\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            fetchSessions();\r\n            setSelectedSessionId(null); \r\n            setSessionMessages([]);\r\n        }\r\n    }, [isOpen, fetchSessions]); \r\n\r\n    const handleSessionSelectForPreview = async (sessionId) => {\r\n        if (selectedSessionId === sessionId && sessionMessages.length > 0) return; \r\n\r\n        setSelectedSessionId(sessionId);\r\n        setLoadingMessages(true);\r\n        setSessionMessages([]);\r\n        setError(''); \r\n        try {\r\n            const sessionData = await api.getChatHistory(sessionId);\r\n            \r\n            // --- THIS IS THE CORRECTED LOGIC ---\r\n            // We trust the API to send correctly formatted data with the 'sender' property.\r\n            const messagesArray = Array.isArray(sessionData.messages) ? sessionData.messages : [];\r\n            setSessionMessages(messagesArray);\r\n            // --- END OF CORRECTION ---\r\n\r\n        } catch (err) {\r\n            toast.error(\"Failed to load messages for this session.\");\r\n            setError(`Error loading messages: ${err.message}`);\r\n        } finally {\r\n            setLoadingMessages(false);\r\n        }\r\n    };\r\n\r\n    const handleLoadSessionAndClose = () => {\r\n        if (selectedSessionId) {\r\n            onSelectSession(selectedSessionId); \r\n            onClose();\r\n        } else {\r\n            toast.error(\"Please select a session to load.\");\r\n        }\r\n    };\r\n    \r\n\r\n    const handleDeleteRequest = (session, e) => {\r\n        e.stopPropagation(); // Prevent the session from being selected\r\n        setSessionToDelete(session); // Set the session to be deleted, which opens the modal\r\n    };\r\n\r\n    const handleConfirmDelete = async () => {\r\n        if (!sessionToDelete) return;\r\n\r\n        const sessionIdToDelete = sessionToDelete.sessionId;\r\n        const toastId = toast.loading(`Deleting session...`);\r\n        try {\r\n            await api.deleteChatSession(sessionIdToDelete);\r\n            toast.success(`Session deleted.`, { id: toastId });\r\n            setSessions(prev => prev.filter(s => s.sessionId !== sessionIdToDelete)); \r\n            if (selectedSessionId === sessionIdToDelete) {\r\n                setSelectedSessionId(null);\r\n                setSessionMessages([]);\r\n            }\r\n        } catch (err) {\r\n            toast.error(`Delete failed: ${err.response?.data?.message || err.message}`, { id: toastId });\r\n        } finally {\r\n            setSessionToDelete(null); // Close the modal by resetting the state\r\n        }\r\n    };\r\n\r\n\r\n    const handleDeleteSession = async (sessionIdToDelete, e) => {\r\n        e.stopPropagation();\r\n        if (!window.confirm(`Are you sure you want to delete this session? This action cannot be undone.`)) return;\r\n        \r\n        const toastId = toast.loading(`Deleting session...`);\r\n        try {\r\n            await api.deleteChatSession(sessionIdToDelete);\r\n            toast.success(`Session deleted.`, { id: toastId });\r\n            setSessions(prev => prev.filter(s => s.sessionId !== sessionIdToDelete)); \r\n            if (selectedSessionId === sessionIdToDelete) {\r\n                setSelectedSessionId(null);\r\n                setSessionMessages([]);\r\n            }\r\n        } catch (err) {\r\n            toast.error(`Delete failed: ${err.response?.data?.message || err.message}`, { id: toastId });\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Modal isOpen={isOpen} onClose={onClose} title=\"Chat History\" size=\"2xl\">\r\n                <div className=\"flex flex-col md:flex-row gap-4 max-h-[70vh] h-[70vh]\">\r\n                    <div className=\"w-full md:w-1/3 border-r border-border-light dark:border-border-dark pr-0 md:pr-2 overflow-y-auto custom-scrollbar\">\r\n                        <h3 className=\"text-sm font-semibold mb-2 text-text-light dark:text-text-dark px-1\">Your Sessions</h3>\r\n                        {loadingSessions && <div className=\"flex justify-center p-4\"><Loader2 className=\"animate-spin text-primary\" size={24}/></div>}\r\n                        {!loadingSessions && !sessions.length && <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark p-2\">No past sessions found.</p>}\r\n                        <ul className=\"space-y-1\">\r\n                            {sessions.map(session => (\r\n                                <li key={session.sessionId} onClick={() => handleSessionSelectForPreview(session.sessionId)}\r\n                                    className={`p-2.5 rounded-md cursor-pointer text-xs transition-colors group relative hover:shadow-md\r\n                                                ${selectedSessionId === session.sessionId ? 'bg-primary text-white' : 'bg-surface-light dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700'}`} >\r\n                                    <div className=\"font-medium truncate\" title={session.preview}>{session.preview || `Session ${session.sessionId.substring(0,8)}`}</div>\r\n                                    <div className={`text-[0.7rem] ${selectedSessionId === session.sessionId ? 'text-blue-200' : 'text-text-muted-light dark:text-text-muted-dark'}`}>\r\n                                        {formatDate(session.updatedAt)} - {session.messageCount} msgs\r\n                                    </div>\r\n                                    {/* --- START OF FIX: Update onClick handler --- */}\r\n                                    <IconButton icon={Trash2} size=\"sm\" variant=\"ghost\" title=\"Delete session\"\r\n                                        className=\"absolute top-1 right-1 p-1 text-red-400 hover:text-red-600 opacity-0 group-hover:opacity-100\"\r\n                                        onClick={(e) => handleDeleteRequest(session, e)} />\r\n                                    {/* --- END OF FIX --- */}\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    </div>\r\n<div className=\"w-full md:w-2/3 flex flex-col overflow-hidden mt-4 md:mt-0\">\r\n                    <h3 className=\"text-sm font-semibold mb-2 text-text-light dark:text-text-dark\">Preview</h3>\r\n                    <div className=\"flex-grow bg-gray-50 dark:bg-gray-800/50 p-3 rounded-md overflow-y-auto custom-scrollbar border border-border-light dark:border-border-dark\">\r\n                        {loadingMessages && <div className=\"flex justify-center p-4\"><Loader2 className=\"animate-spin text-primary\" size={24} /></div>}\r\n                        \r\n                        <div className=\"space-y-3 flex flex-col\">\r\n                            {sessionMessages.map(msg => {\r\n                                const isUser = msg.sender === 'user';\r\n                                return (\r\n                                    <div key={msg.id} className={`flex w-full ${isUser ? 'justify-end' : 'justify-start'}`}>\r\n                                        <div className={`p-2.5 rounded-lg shadow-sm w-fit max-w-[90%] text-xs\r\n                                            ${isUser \r\n                                                ? 'bg-blue-500 text-white' \r\n                                                : 'bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-100'\r\n                                            }`}>\r\n                                            <p className=\"font-semibold text-[0.7rem] mb-0.5\">{isUser ? 'You' : 'AI Tutor'}</p>\r\n                                            <p className=\"whitespace-pre-wrap break-words\">{msg.text}</p>\r\n                                            <p className={`text-[0.65rem] mt-1 text-right ${isUser ? 'opacity-70' : 'opacity-50'}`}>{formatDate(msg.timestamp)}</p>\r\n                                        </div>\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n\r\n                        {!loadingMessages && !selectedSessionId && (\r\n                            <div className=\"flex flex-col items-center justify-center h-full text-text-muted-light dark:text-text-muted-dark text-sm\">\r\n                                <MessageSquareText size={40} className=\"mb-3 opacity-50\" />\r\n                                <p>Select a session to view its messages.</p>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n                </div>\r\n                <div className=\"mt-6 pt-4 border-t border-border-light dark:border-border-dark flex justify-end gap-3\">\r\n                    <button onClick={onClose} className=\"btn-secondary !text-xs !py-1.5 !px-3\">Cancel</button>\r\n                    <button onClick={handleLoadSessionAndClose} className=\"btn-primary !text-xs !py-1.5 !px-3\" disabled={!selectedSessionId || loadingMessages || loadingSessions}>Load Session</button>\r\n                </div>\r\n            </Modal>\r\n            {/* Add the new confirmation modal here */}\r\n            <ConfirmationModal\r\n                isOpen={!!sessionToDelete}\r\n                onClose={() => setSessionToDelete(null)}\r\n                onConfirm={handleConfirmDelete}\r\n                title=\"Delete Chat Session\"\r\n                message={`Are you sure you want to permanently delete this chat session? This action cannot be undone.`}\r\n                confirmText=\"Delete\"\r\n                confirmVariant=\"danger\"\r\n            />\r\n        </>\r\n    );\r\n}\r\nexport default ChatHistoryModal;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\ChatInput.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useAppState' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":21,"suggestions":[{"messageId":"removeVar","data":{"varName":"useAppState"},"fix":{"range":[47,112],"text":""},"desc":"Remove unused variable 'useAppState'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[596,603],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/chat/ChatInput.jsx\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport api from '../../services/api.js';\r\nimport { Send, Mic, Plus, Brain, Zap, Globe, BookMarked, Sparkles, Share2 } from 'lucide-react'; // --- FIX: Imported Share2\r\nimport { useWebSpeech } from '../../hooks/useWebSpeech';\r\nimport Button from '../core/Button.jsx'; \r\nimport IconButton from '../core/IconButton.jsx';\r\nimport toast from 'react-hot-toast';\r\nimport blueBrain from \"./../../assets/blueBrain.svg\";\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nfunction ChatInput({ \r\n    onSendMessage, \r\n    isLoading,\r\n    useWebSearch,\r\n    setUseWebSearch,\r\n    useAcademicSearch,\r\n    setUseAcademicSearch,\r\n    criticalThinkingEnabled,\r\n    setCriticalThinkingEnabled,\r\n    initialPrompt,\r\n    setInitialPromptForNewSession,\r\n    openCoachModalWithData,\r\n    setCoachModalOpen\r\n}) {\r\n    const [inputValue, setInputValue] = useState('');\r\n    const { transcript, listening, isSpeechSupported, startListening, stopListening, resetTranscript } = useWebSpeech();\r\n    const textareaRef = useRef(null);\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n    const menuRef = useRef(null);\r\n\r\n    const [isCoaching, setIsCoaching] = useState(false);\r\n    // --- THIS IS THE FIX (Part 1) ---\r\n    const [isKgRealtimeEnabled, setIsKgRealtimeEnabled] = useState(true);\r\n    // --- END FIX ---\r\n\r\n    const handleRequestPromptCoaching = async () => {\r\n        const trimmedInput = inputValue.trim();\r\n\r\n        if (!trimmedInput) return;\r\n        \r\n        if (trimmedInput.length < 3) {\r\n            toast(\"Prompt is too short for coaching. Please provide a bit more detail.\", {\r\n                icon: 'â¤ï¸',\r\n                style: { background: '#FBBF24', color: '#ffffff' },\r\n            });\r\n            return;\r\n        }\r\n        \r\n        if (isCoaching) return;\r\n\r\n        setIsCoaching(true);\r\n\r\n        const promise = api.analyzePrompt(trimmedInput);\r\n\r\n        toast.promise(\r\n            promise,\r\n            {\r\n                loading: 'Asking the coach for advice...',\r\n                success: 'Suggestion received!',\r\n                error: (err) => err.message || \"The Prompt Coach is unavailable.\",\r\n            }\r\n        );\r\n\r\n        try {\r\n            const response = await promise;\r\n            openCoachModalWithData({\r\n                original: trimmedInput,\r\n                improved: response.improvedPrompt,\r\n                explanation: response.explanation\r\n            });\r\n            setCoachModalOpen(true);\r\n        } catch (error) {\r\n            // toast.promise already handled displaying the error.\r\n            console.error(\"Error requesting prompt coaching:\", error.message);\r\n        } finally {\r\n            setIsCoaching(false);\r\n        }\r\n    };\r\n\r\n    const handlePaste = (e) => {\r\n        e.preventDefault();\r\n\r\n        const pastedText = e.clipboardData.getData('text/plain');\r\n\r\n        const trimmedText = pastedText.trim();\r\n\r\n        const textarea = textareaRef.current;\r\n        const start = textarea.selectionStart;\r\n        const end = textarea.selectionEnd;\r\n\r\n        const newValue = inputValue.substring(0, start) + trimmedText + inputValue.substring(end);\r\n        setInputValue(newValue);\r\n\r\n        setTimeout(() => {\r\n            const newCursorPosition = start + trimmedText.length;\r\n            textarea.selectionStart = newCursorPosition;\r\n            textarea.selectionEnd = newCursorPosition;\r\n        }, 0);\r\n    };\r\n\r\n    useEffect(() => {\r\n    if (initialPrompt) {\r\n        console.log(\"[ChatInput] Received initial prompt via props:\", initialPrompt);\r\n        setInputValue(initialPrompt); // Set the text in the input box\r\n        setInitialPromptForNewSession(null); // Clear the global state immediately\r\n    }\r\n    }, [initialPrompt, setInitialPromptForNewSession]);\r\n\r\n    useEffect(() => {\r\n        if (transcript) {\r\n            setInputValue(prev => prev + (prev ? \" \" : \"\") + transcript);\r\n            resetTranscript(); \r\n        }\r\n    }, [transcript, resetTranscript]);\r\n    \r\n    useEffect(() => {\r\n        if (textareaRef.current) {\r\n            textareaRef.current.style.height = 'auto';\r\n            textareaRef.current.style.height = `${Math.min(textareaRef.current.scrollHeight, 128)}px`;\r\n        }\r\n    }, [inputValue]);\r\n\r\n    useEffect(() => {\r\n        function handleClickOutside(event) {\r\n            if (menuRef.current && !menuRef.current.contains(event.target)) {\r\n                setIsMenuOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }, [menuRef]);\r\n\r\n    const handleSubmit = (e) => {\r\n        e.preventDefault();\r\n        if (inputValue.trim() && !isLoading) {\r\n            // --- THIS IS THE FIX (Part 2) ---\r\n            onSendMessage(inputValue.trim(), { isKgRealtimeEnabled });\r\n            // --- END FIX ---\r\n            setInputValue('');\r\n        }\r\n    };\r\n\r\n    const handleKeyDown = (e) => {\r\n        if (e.key === 'Enter' && !e.shiftKey && !isLoading) {\r\n            e.preventDefault();\r\n            handleSubmit(e);\r\n        }\r\n    };\r\n    \r\n    const handleWebSearchToggle = () => {\r\n        const newWebSearchState = !useWebSearch;\r\n        setUseWebSearch(newWebSearchState);\r\n        if (newWebSearchState) setUseAcademicSearch(false);\r\n        toast(newWebSearchState ? \"Web Search enabled.\" : \"Web Search disabled.\", { icon: newWebSearchState ? \"ðŸŒ\" : \"ðŸ“„\" });\r\n        setIsMenuOpen(false);\r\n    };\r\n\r\n    const handleAcademicSearchToggle = () => {\r\n        const newState = !useAcademicSearch;\r\n        setUseAcademicSearch(newState);\r\n        if (newState) setUseWebSearch(false);\r\n        toast(newState ? \"Academic Search enabled.\" : \"Academic Search disabled.\", { icon: newState ? \"ðŸŽ“\" : \"ðŸ“„\" });\r\n        setIsMenuOpen(false);\r\n    };\r\n\r\n    const icon = criticalThinkingEnabled ? () => <img src={blueBrain} alt=\"Blue Brain\" className=\"w-5 h-5\" /> : Brain;\r\n\r\n    return (\r\n        <div className=\"p-2 sm:p-3 bg-surface-light dark:bg-surface-dark/50 backdrop-blur-sm rounded-b-lg shadow-inner\">\r\n            <form onSubmit={handleSubmit} className=\"flex items-end gap-2\">\r\n                <div className=\"relative\" ref={menuRef}>\r\n                    <IconButton\r\n                        icon={Plus}\r\n                        title=\"More Options\"\r\n                        onClick={() => setIsMenuOpen(!isMenuOpen)}\r\n                        variant=\"ghost\"\r\n                        size=\"md\" \r\n                        className=\"p-2 text-text-muted-light dark:text-text-muted-dark hover:text-primary\"\r\n                        disabled={isLoading}\r\n                    />\r\n                    <AnimatePresence>\r\n                    {isMenuOpen && (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                            animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                            exit={{ opacity: 0, y: 10, scale: 0.95 }}\r\n                            className=\"absolute bottom-full left-0 mb-2 w-56 bg-surface-light dark:bg-surface-dark rounded-lg shadow-xl border border-border-light dark:border-border-dark p-1 z-10\"\r\n                        >\r\n                            <button\r\n                                onClick={handleWebSearchToggle}\r\n                                className={`w-full text-left flex items-center gap-2 px-3 py-2 text-sm rounded-md transition-colors ${\r\n                                    useWebSearch\r\n                                    ? 'bg-primary/10 text-primary dark:bg-primary-dark/20 dark:text-primary-light'\r\n                                    : 'text-text-light dark:text-text-dark hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                                }`}\r\n                            >\r\n                                <Globe size={16} />\r\n                                {useWebSearch ? 'Disable Web Search' : 'Enable Web Search'}\r\n                            </button>\r\n                            <button\r\n                                onClick={handleAcademicSearchToggle}\r\n                                className={`w-full text-left flex items-center gap-2 px-3 py-2 text-sm rounded-md transition-colors ${\r\n                                    useAcademicSearch\r\n                                    ? 'bg-purple-500/10 text-purple-600 dark:bg-purple-400/20 dark:text-purple-300'\r\n                                    : 'text-text-light dark:text-text-dark hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                                }`}\r\n                            >\r\n                                <BookMarked size={16} />\r\n                                {useAcademicSearch ? 'Disable Academic Search' : 'Enable Academic Search'}\r\n                            </button>\r\n                             <button\r\n                                onClick={() => {toast(\"File attachment coming soon!\", { icon: \"ðŸ“Ž\" }); setIsMenuOpen(false);}}\r\n                                className=\"w-full text-left flex items-center gap-2 px-3 py-2 text-sm rounded-md text-text-muted-light dark:text-text-muted-dark hover:bg-gray-100 dark:hover:bg-gray-700\"\r\n                            >\r\n                                <Zap size={16} />\r\n                                Attach File (soon)\r\n                            </button>\r\n                        </motion.div>\r\n                    )}\r\n                    </AnimatePresence>\r\n                </div>\r\n                <textarea\r\n                    ref={textareaRef}\r\n                    value={inputValue}\r\n                    onChange={(e) => setInputValue(e.target.value)}\r\n                    onKeyDown={handleKeyDown}\r\n                    onPaste={handlePaste}\r\n                    placeholder={isLoading ? \"Waiting for response...\" : \"Type your message or ask a question...\"}\r\n                    className=\"input-field flex-1 p-2.5 resize-none min-h-[44px] max-h-32 custom-scrollbar text-sm\" \r\n                    rows=\"1\"\r\n                    disabled={isLoading}\r\n                />\r\n\r\n                {isSpeechSupported && (\r\n                    <IconButton\r\n                        icon={Mic}\r\n                        onClick={() => listening ? stopListening() : startListening()}\r\n                        title={listening ? \"Stop listening\" : \"Start voice input\"}\r\n                        variant={listening ? \"danger\" : \"ghost\"} \r\n                        size=\"md\"\r\n                        className={`p-2 ${listening ? 'text-red-500 animate-pulse' : 'text-text-muted-light dark:text-text-muted-dark hover:text-primary'}`}\r\n                        disabled={isLoading}\r\n                    />\r\n                )}\r\n                \r\n                <IconButton\r\n                    icon={Sparkles}\r\n                    onClick={handleRequestPromptCoaching}\r\n                    title=\"Ask Prompt Coach for Improvement\"\r\n                    variant=\"ghost\"\r\n                    size=\"md\"\r\n                    className=\"p-2 text-amber-500 hover:text-amber-600 dark:text-amber-400 dark:hover:text-amber-300\"\r\n                    isLoading={isCoaching}\r\n                    disabled={isLoading || isCoaching || !inputValue.trim()}\r\n                />\r\n\r\n               <IconButton\r\n                    icon={icon}\r\n                    onClick={() => setCriticalThinkingEnabled(!criticalThinkingEnabled)}\r\n                    title={criticalThinkingEnabled ? \"Disable Critical Thinking\" : \"Enable Critical Thinking\"}\r\n                    variant=\"ghost\"\r\n                    size=\"md\"\r\n                    className={`p-2 ${criticalThinkingEnabled ? 'text-purple-500' : 'text-text-muted-light dark:text-text-muted-dark hover:text-primary'}`}\r\n                    disabled={isLoading}\r\n                />\r\n                \r\n                {/* --- THIS IS THE FIX (Part 3) --- */}\r\n                <IconButton\r\n                    icon={Share2}\r\n                    onClick={() => {\r\n                        setIsKgRealtimeEnabled(!isKgRealtimeEnabled);\r\n                        toast.success(`Live Concept Map is now ${!isKgRealtimeEnabled ? 'ON' : 'OFF'}.`);\r\n                    }}\r\n                    title={isKgRealtimeEnabled ? \"Disable Live Concept Map\" : \"Enable Live Concept Map\"}\r\n                    variant=\"ghost\"\r\n                    size=\"md\"\r\n                    className={`p-2 ${isKgRealtimeEnabled ? 'text-teal-500' : 'text-text-muted-light dark:text-text-muted-dark hover:text-primary'}`}\r\n                    disabled={isLoading}\r\n                />\r\n                {/* --- END FIX --- */}\r\n\r\n                <Button \r\n                    type=\"submit\"\r\n                    variant=\"primary\"\r\n                    size=\"md\" \r\n                    className=\"!p-2.5\" \r\n                    disabled={isLoading || !inputValue.trim()}\r\n                    isLoading={isLoading && !!inputValue.trim()} \r\n                    title=\"Send message\"\r\n                >\r\n                    {(!isLoading || !inputValue.trim()) ? <Send size={20} /> : null}\r\n                </Button>\r\n            </form>\r\n            \r\n            <div className=\"flex flex-wrap items-center justify-center mt-2 px-2 text-center h-4 gap-x-4\">\r\n                <AnimatePresence>\r\n                    {useWebSearch && (\r\n                        <motion.p\r\n                            key=\"web-search-indicator\"\r\n                            initial={{ opacity: 0, y: -5 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -5 }}\r\n                            className=\"text-xs text-blue-500 dark:text-blue-400 flex items-center gap-1.5 font-medium\"\r\n                        >\r\n                            <Globe size={12} /> Web Search is ON\r\n                        </motion.p>\r\n                    )}\r\n                    {useAcademicSearch && (\r\n                        <motion.p\r\n                            key=\"academic-search-indicator\"\r\n                            initial={{ opacity: 0, y: -5 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -5 }}\r\n                            className=\"text-xs text-purple-500 dark:text-purple-400 flex items-center gap-1.5 font-medium\"\r\n                        >\r\n                            <BookMarked size={12} /> Academic Search is ON\r\n                        </motion.p>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default ChatInput;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\MessageBubble.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[191,198],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":166,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":166,"endColumn":42,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[6296,6307],"text":""},"desc":"Remove unused variable 'Icon'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":237,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":237,"endColumn":23}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState, useCallback, memo } from 'react';\r\nimport { marked } from 'marked';\r\nimport Prism from 'prismjs';\r\nimport toast from 'react-hot-toast';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { ChevronDown, Link as LinkIcon, Zap, Server, Volume2, StopCircle, ServerCrash, Copy, Check, Lightbulb, ThumbsUp, ThumbsDown, ShieldCheck, GitFork, FlaskConical } from 'lucide-react';\r\nimport ThinkingDropdown from './ThinkingDropdown.jsx';\r\nimport TypingIndicator from './TypingIndicator.jsx';\r\nimport { useTextToSpeech } from '../../hooks/useTextToSpeech.js';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { renderMarkdown } from '../../utils/markdownUtils';\r\nimport { getPlainTextFromMarkdown, copyToClipboard } from '../../utils/helpers.js';\r\nimport DOMPurify from 'dompurify';\r\nimport { useTypingEffect } from '../../hooks/useTypingEffect.js';\r\nimport api from '../../services/api.js';\r\n\r\nmarked.setOptions({ breaks: true, gfm: true });\r\n\r\nconst createMarkup = (markdownText) => {\r\n    if (!markdownText) return { __html: '' };\r\n    return renderMarkdown(markdownText);\r\n};\r\n\r\nconst escapeHtml = (unsafe) => {\r\n    if (typeof unsafe !== 'string') return '';\r\n    return unsafe.replace(/&/g, \"&\").replace(/</g, \"<\").replace(/>/g, \">\").replace(/\"/g, `\"`).replace(/'/g, \"'\");\r\n};\r\n\r\nconst AnimatedThinking = ({ content }) => {\r\n    const [completedTyping, setCompletedTyping] = useState('');\r\n    const [currentTyping, setCurrentTyping] = useState('');\r\n    const [isWaiting, setIsWaiting] = useState(true);\r\n    const lastContentRef = useRef('');\r\n\r\n    useEffect(() => {\r\n        if (content && content.length > lastContentRef.current.length) {\r\n            const newChunk = content.substring(lastContentRef.current.length);\r\n            setCurrentTyping(newChunk);\r\n            setIsWaiting(false);\r\n            lastContentRef.current = content;\r\n        }\r\n    }, [content]);\r\n\r\n    const onTypingComplete = useCallback(() => {\r\n        setCompletedTyping(prev => prev + currentTyping);\r\n        setCurrentTyping('');\r\n        setIsWaiting(true);\r\n    }, [currentTyping]);\r\n\r\n    const animatedChunk = useTypingEffect(currentTyping, 4, onTypingComplete);\r\n    const combinedText = completedTyping + animatedChunk;\r\n\r\n    return (\r\n        <div className=\"prose prose-xs dark:prose-invert max-w-none text-text-muted-light dark:text-text-muted-dark\">\r\n            <div dangerouslySetInnerHTML={createMarkup(combinedText)} />\r\n            {isWaiting && <span className=\"animate-pulse\"> Thinking...</span>}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst CodeBlockWithCopyButton = ({ children, codeText, key }) => {\r\n    const [copied, setCopied] = useState(false);\r\n    const codeRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (codeRef.current) {\r\n            Prism.highlightAllUnder(codeRef.current);\r\n        }\r\n    }, [children, copied]);\r\n\r\n    const handleCopyCode = async () => {\r\n        const success = await copyToClipboard(codeText);\r\n        if (success) {\r\n            setCopied(true);\r\n            toast.success('Code copied!');\r\n            setTimeout(() => setCopied(false), 1500);\r\n        } else {\r\n            toast.error('Failed to copy code.');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"relative group/code\" ref={codeRef} key={key}>\r\n            <div dangerouslySetInnerHTML={{ __html: children }} /> \r\n            <button\r\n                onClick={handleCopyCode}\r\n                title={copied ? 'Copied!' : 'Copy code'}\r\n                disabled={copied}\r\n                className=\"absolute top-1 right-1 p-1.5 rounded-md cursor-pointer text-text-muted-dark bg-gray-700/80 backdrop-blur-sm transition-opacity duration-200 opacity-0 group-hover/code:opacity-100\"\r\n            >\r\n                <AnimatePresence mode=\"wait\" initial={false}>\r\n                    <motion.span\r\n                        key={copied ? 'check' : 'copy'}\r\n                        initial={{ opacity: 0, scale: 0.8 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        exit={{ opacity: 0, scale: 0.8 }}\r\n                        transition={{ duration: 0.15 }}\r\n                    >\r\n                        {copied ? <Check size={16} className=\"text-green-500\" /> : <Copy size={16} />}\r\n                    </motion.span>\r\n                </AnimatePresence>\r\n            </button>\r\n        </div>\r\n    );\r\n};\r\n\r\nconst parseAndRenderMarkdown = (markdownText, messageId) => {\r\n    if (!markdownText) return [];\r\n\r\n    let htmlString = createMarkup(markdownText).__html;\r\n\r\n    const parser = new DOMParser();\r\n    const doc = parser.parseFromString(htmlString, 'text/html');\r\n\r\n    const resultNodes = [];\r\n    let currentHtmlBuffer = '';\r\n\r\n    const flushHtmlBuffer = () => {\r\n        if (currentHtmlBuffer) {\r\n            resultNodes.push(\r\n                <div key={`html-${messageId}-${resultNodes.length}-${Math.random().toString(36).substring(2,9)}`} \r\n                     dangerouslySetInnerHTML={{ __html: currentHtmlBuffer }} />\r\n            );\r\n            currentHtmlBuffer = '';\r\n        }\r\n    };\r\n\r\n    const traverse = (node) => {\r\n        if (!node) return;\r\n\r\n        if (node.nodeName === 'PRE') {\r\n            flushHtmlBuffer();\r\n\r\n            const codeElement = node.querySelector('code');\r\n            const codeText = codeElement ? codeElement.textContent : '';\r\n            const preOuterHtml = node.outerHTML;\r\n\r\n            resultNodes.push(\r\n                <CodeBlockWithCopyButton \r\n                    key={`code-${messageId}-${resultNodes.length}-${Math.random().toString(36).substring(2,9)}`}\r\n                    codeText={codeText}\r\n                >\r\n                    {preOuterHtml}\r\n                </CodeBlockWithCopyButton>\r\n            );\r\n            return; \r\n        } \r\n        \r\n        if (node.nodeType === Node.TEXT_NODE) {\r\n            currentHtmlBuffer += node.nodeValue;\r\n        } else if (node.nodeType === Node.ELEMENT_NODE) {\r\n            currentHtmlBuffer += node.outerHTML; \r\n            return; \r\n        }\r\n\r\n        Array.from(node.childNodes).forEach(traverse);\r\n    };\r\n\r\n    Array.from(doc.body.children).forEach(traverse);\r\n    \r\n    flushHtmlBuffer();\r\n\r\n    return resultNodes;\r\n};\r\n\r\nconst CriticalThinkingCue = ({ icon: Icon, label, text, color, onClick }) => {\r\n    const colorClasses = {\r\n        sky: {\r\n            bg: \"bg-primary/5 dark:bg-primary/10\",\r\n            text: \"text-text-light dark:text-text-dark\",\r\n            hoverBg: \"hover:bg-primary/10 dark:hover:bg-primary/20\",\r\n            iconText: \"text-primary dark:text-primary-light\",\r\n        },\r\n        amber: {\r\n            bg: \"bg-primary/5 dark:bg-primary/10\",\r\n            text: \"text-text-light dark:text-text-dark\",\r\n            hoverBg: \"hover:bg-primary/10 dark:hover:bg-primary/20\",\r\n            iconText: \"text-primary dark:text-primary-light\",\r\n        },\r\n        emerald: {\r\n            bg: \"bg-primary/5 dark:bg-primary/10\",\r\n            text: \"text-text-light dark:text-text-dark\",\r\n            hoverBg: \"hover:bg-primary/10 dark:hover:bg-primary/20\",\r\n            iconText: \"text-primary dark:text-primary-light\",\r\n        }\r\n    };\r\n    const styles = colorClasses[color] || colorClasses.sky;\r\n\r\n    return (\r\n        <motion.button\r\n            variants={{\r\n                hidden: { opacity: 0, y: 10 },\r\n                visible: { opacity: 1, y: 0 }\r\n            }}\r\n            onClick={onClick}\r\n            className={`w-full text-left p-2.5 rounded-lg transition-colors duration-200 ${styles.bg} ${styles.hoverBg}`}\r\n        >\r\n            <div className=\"flex items-center gap-2 mb-1\">\r\n                <Icon size={16} className={styles.iconText} />\r\n                <span className={`text-xs font-bold ${styles.text}`}>{label}</span>\r\n            </div>\r\n            <p className={`text-xs ${styles.text}`}>{text}</p>\r\n        </motion.button>\r\n    );\r\n};\r\n\r\n\r\n\r\n\r\nfunction MessageBubble({ sender, text, thinking, references, timestamp, sourcePipeline, isStreaming, criticalThinkingCues, onCueClick, messageId, logId }) {\r\n    const isUser = sender === 'user';\r\n    const [isDropdownOpen, setIsDropdownOpen] = useState(false);\r\n    const [feedbackSent, setFeedbackSent] = useState(null);\r\n    const contentRef = useRef(null);\r\n    const { speak, cancel, isSpeaking } = useTextToSpeech();\r\n    \r\n    const [isCopied, setIsCopied] = useState(false);\r\n    const mainContent = text || '';\r\n    const thinkingContent = thinking;\r\n    const showThinkingDropdown = !isUser && thinkingContent !== null;\r\n\r\n    useEffect(() => {\r\n        if (contentRef.current && !isStreaming) {\r\n            const timer = setTimeout(() => {\r\n                Prism.highlightAllUnder(contentRef.current);\r\n            }, 50);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [isStreaming, mainContent]);\r\n\r\n    const handleFeedback = async (feedbackType) => {\r\n        if (feedbackSent) return; // Prevent multiple submissions\r\n        setFeedbackSent(feedbackType);\r\n        try {\r\n            await api.submitFeedback(logId, feedbackType);\r\n            toast.success('Thanks for your feedback!');\r\n        } catch (error) {\r\n            toast.error('Could not submit feedback.');\r\n            setFeedbackSent(null); // Allow user to try again\r\n        }\r\n    };\r\n\r\n    const handleCopy = async () => {\r\n        if (isCopied) return;\r\n        const plainTextToCopy = getPlainTextFromMarkdown(mainContent);\r\n        const success = await copyToClipboard(plainTextToCopy);\r\n    \r\n        if (success) {\r\n            setIsCopied(true);\r\n            setTimeout(() => setIsCopied(false), 1500);\r\n            toast.success('Message copied!');\r\n        } else {\r\n            toast.error('Failed to copy message.');\r\n        }\r\n    };\r\n\r\n    const formatTimestamp = (ts) => {\r\n        if (!ts) return ''; \r\n        return new Date(ts).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n    };\r\n\r\n    const getPipelineIcon = () => {\r\n        if (!sourcePipeline) return null;\r\n        const lower = sourcePipeline.toLowerCase();\r\n        if (lower.includes('ollama')) return <Zap size={12} className=\"text-green-400\" title=\"Ollama\" />;\r\n        if (lower.includes('gemini')) return <Server size={12} className=\"text-blue-400\" title=\"Gemini\" />;\r\n        if (lower.includes('rag')) return <Zap size={12} className=\"text-purple-400\" title=\"RAG\" />;\r\n        if (lower.includes('error')) return <ServerCrash size={12} className=\"text-red-400\" title=\"Error\" />;\r\n        return null;\r\n    };\r\n    \r\n    return (\r\n        <div className={`flex flex-col ${isUser ? 'items-end' : 'items-start'} w-full group`}>\r\n            <div className={`message-bubble-wrapper max-w-[85%] md:max-w-[75%] ${isStreaming ? 'w-full' : ''}`}>\r\n                {showThinkingDropdown && (\r\n                    <div className=\"mb-1.5\">\r\n                        <ThinkingDropdown\r\n                            isOpen={isDropdownOpen}\r\n                            setIsOpen={setIsDropdownOpen}\r\n                            isStreaming={isStreaming}\r\n                        >\r\n                            {isStreaming \r\n                                ? <AnimatedThinking content={thinkingContent} /> \r\n                                : <div className=\"prose prose-xs dark:prose-invert max-w-none text-text-muted-light dark:text-text-muted-dark\" dangerouslySetInnerHTML={createMarkup(thinkingContent)} />\r\n                            }\r\n                        </ThinkingDropdown>\r\n                    </div>\r\n                )}\r\n\r\n                {isStreaming ? (\r\n                    <TypingIndicator />\r\n                ) : (\r\n                    <div className={`message-bubble relative p-3 rounded-2xl shadow-md break-words ${\r\n                        isUser \r\n                        ? 'bg-surface-light text-text-light border border-border-light dark:bg-primary-dark dark:text-white dark:border-transparent rounded-br-lg' \r\n                        : 'bg-surface-light dark:bg-surface-dark text-text-light dark:text-text-dark rounded-bl-lg border border-border-light dark:border-border-dark'\r\n                    }`}>\r\n                        <div ref={contentRef} className=\"prose prose-sm dark:prose-invert max-w-none message-content leading-relaxed\">\r\n                            {parseAndRenderMarkdown(mainContent, messageId)}\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center justify-end mt-1.5 text-xs gap-1\">\r\n                            <button onClick={handleCopy} title={isCopied ? 'Copied!' : 'Copy content'} disabled={isCopied} className=\"p-1 rounded-md text-text-muted-light dark:text-text-muted-dark hover:bg-gray-200 dark:hover:bg-gray-700 opacity-0 group-hover:opacity-100 transition-all duration-200 focus:outline-none\">\r\n                                <AnimatePresence mode=\"wait\" initial={false}>\r\n                                    <motion.div key={isCopied ? 'check' : 'copy'} initial={{ scale: 0.6, opacity: 0, rotate: -30 }} animate={{ scale: 1, opacity: 1, rotate: 0 }} exit={{ scale: 0.6, opacity: 0, rotate: 30 }} transition={{ duration: 0.15 }}>\r\n                                        {isCopied ? <Check size={16} className=\"text-green-500\" /> : <Copy size={16} />}\r\n                                    </motion.div>\r\n                                </AnimatePresence>\r\n                            </button>\r\n\r\n                            {!isUser && logId && (\r\n                                <div className=\"flex items-center gap-0.5 ml-2 border-l border-border-light dark:border-border-dark pl-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\r\n                                    <IconButton\r\n                                        icon={ThumbsUp}\r\n                                        onClick={() => handleFeedback('positive')}\r\n                                        disabled={!!feedbackSent}\r\n                                        title=\"Good response\"\r\n                                        size=\"sm\"\r\n                                        className={`p-1 ${feedbackSent === 'positive' ? 'text-green-500 bg-green-500/10' : 'hover:text-green-500'}`}\r\n                                    />\r\n                                    <IconButton\r\n                                        icon={ThumbsDown}\r\n                                        onClick={() => handleFeedback('negative')}\r\n                                        disabled={!!feedbackSent}\r\n                                        title=\"Bad response\"\r\n                                        size=\"sm\"\r\n                                        className={`p-1 ${feedbackSent === 'negative' ? 'text-red-500 bg-red-500/10' : 'hover:text-red-500'}`}\r\n                                    />\r\n                                </div>\r\n                            )}\r\n                            <div className=\"flex items-center gap-2 pl-1 opacity-70\">\r\n                                {!isUser && getPipelineIcon() && <span className=\"mr-1\">{getPipelineIcon()}</span>}\r\n                                <span>{formatTimestamp(timestamp)}</span>\r\n                                {!isUser && (\r\n                                    <IconButton icon={isSpeaking ? StopCircle : Volume2} onClick={() => isSpeaking ? cancel() : speak({ text: mainContent })} title={isSpeaking ? \"Stop reading\" : \"Read aloud\"} size=\"sm\" variant=\"ghost\" className={`p-0.5 ${isSpeaking ? 'text-red-500' : 'text-text-muted-light dark:text-text-muted-dark hover:text-primary'}`} />\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {!isStreaming && !isUser && references && references.length > 0 && (\r\n                <div className=\"message-metadata-container max-w-[85%] md:max-w-[75%] mt-1.5 pl-2\">\r\n                    <details className=\"group/details text-xs\">\r\n                        <summary className=\"flex items-center justify-between gap-1 cursor-pointer text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light transition-colors\">\r\n                            <span className=\"flex items-center gap-1\">\r\n                                <LinkIcon size={14} /> References\r\n                            </span>\r\n                            <ChevronDown size={14} className=\"transition-transform group-open/details:rotate-180\" />\r\n                        </summary>\r\n                        <ul className=\"mt-1 pl-1 space-y-0.5 text-[0.7rem]\">\r\n                            {references.map((ref, index) => (\r\n                                <li \r\n                                    key={index} \r\n                                    className=\"text-text-muted-light dark:text-text-muted-dark hover:text-text-light dark:hover:text-text-dark transition-colors truncate\"\r\n                                    title={`Preview: ${escapeHtml(ref.content_preview || '')}\\nSource: ${escapeHtml(ref.source || '')}`}\r\n                                >\r\n                                    <span className=\"font-semibold text-accent\">[{ref.number}]</span> {escapeHtml(ref.source)}\r\n                                </li>\r\n                            ))}\r\n                        </ul>\r\n                    </details>\r\n                </div>\r\n            )}\r\n            \r\n            {!isStreaming && !isUser && criticalThinkingCues && (\r\n                <motion.div \r\n                    initial=\"hidden\"\r\n                    animate=\"visible\"\r\n                    variants={{\r\n                        visible: {\r\n                            transition: {\r\n                                staggerChildren: 0.1\r\n                            }\r\n                        }\r\n                    }}\r\n                    className=\"max-w-[85%] md:max-w-[75%] w-full mt-2 pl-2\"\r\n                >\r\n                    <div className=\"border-t border-dashed border-border-light dark:border-border-dark pt-2\">\r\n                        <h4 className=\"text-xs font-semibold text-text-muted-light dark:text-text-muted-dark flex items-center gap-1.5 mb-2\">\r\n                            <Lightbulb size={14} />\r\n                            Critical Thinking Prompts\r\n                        </h4>\r\n                        <div className=\"space-y-2\">\r\n                            {criticalThinkingCues.verificationPrompt && (\r\n                                <CriticalThinkingCue\r\n                                    onClick={() => onCueClick(criticalThinkingCues.verificationPrompt)}\r\n                                    icon={ShieldCheck}\r\n                                    label=\"Verify & Validate\"\r\n                                    text={criticalThinkingCues.verificationPrompt}\r\n                                    color=\"sky\"\r\n                                />\r\n                            )}\r\n                            {criticalThinkingCues.alternativePrompt && (\r\n                                <CriticalThinkingCue\r\n                                    onClick={() => onCueClick(criticalThinkingCues.alternativePrompt)}\r\n                                    icon={GitFork}\r\n                                    label=\"Consider Alternatives\"\r\n                                    text={criticalThinkingCues.alternativePrompt}\r\n                                    color=\"amber\"\r\n                                />\r\n                            )}\r\n                            {criticalThinkingCues.applicationPrompt && (\r\n                                <CriticalThinkingCue\r\n                                    onClick={() => onCueClick(criticalThinkingCues.applicationPrompt)}\r\n                                    icon={FlaskConical}\r\n                                    label=\"Apply Your Knowledge\"\r\n                                    text={criticalThinkingCues.applicationPrompt}\r\n                                    color=\"emerald\"\r\n                                />\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            )}\r\n            </div>\r\n        );\r\n    }\r\n\r\nexport default memo(MessageBubble);","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\PromptCoachModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\StreamingResponse.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\ThinkingDropdown.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[141,180],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/chat/ThinkingDropdown.jsx\r\nimport React from 'react';\r\nimport { ChevronDown, BrainCircuit } from 'lucide-react';\r\nimport { motion } from 'framer-motion';\r\n\r\nfunction ThinkingDropdown({ children, isOpen, setIsOpen, isStreaming }) {\r\n    return (\r\n        <div className=\"w-full\">\r\n            <button\r\n                onClick={() => setIsOpen(!isOpen)}\r\n                className=\"inline-flex items-center gap-1.5 text-xs font-medium text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition-colors py-1 group\"\r\n                aria-expanded={isOpen}\r\n            >\r\n                <BrainCircuit size={14} className=\"text-gray-400 dark:text-gray-500 group-hover:text-gray-500 dark:group-hover:text-gray-400 transition-colors\" />\r\n\r\n                {/* --- THIS SPAN IS THE ONLY CHANGE --- */}\r\n                <span className={isStreaming ? 'shimmer-container' : ''}>\r\n                    Thinking Process\r\n                </span>\r\n\r\n                <ChevronDown size={16} className={`transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}`} />\r\n            </button>\r\n\r\n\r\n            {/* âœ… Always render motion.div, but animate visibility */}\r\n            <motion.div\r\n                animate={isOpen ? 'open' : 'collapsed'}\r\n                variants={{\r\n                    open: { opacity: 1, height: 'auto', marginTop: '0.25rem' },\r\n                    collapsed: { opacity: 0, height: 0, marginTop: '0' }\r\n                }}\r\n                transition={{ duration: 0.3, ease: 'easeInOut' }}\r\n                className=\"overflow-hidden\"\r\n            >\r\n                <div className=\"pl-4 border-l-2 border-gray-300 dark:border-gray-600\">\r\n                    {children}\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ThinkingDropdown;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\chat\\TypingIndicator.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\common\\ThemeToggle.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\core\\Button.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\core\\ConfirmationModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\core\\IconButton.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\core\\Modal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[129,136],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'modalRef.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'modalRef.current' to a variable inside the effect, and use that variable in the cleanup function.","line":67,"column":39,"nodeType":"Identifier","endLine":67,"endColumn":46}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/components/core/Modal.jsx\r\nimport React, { useEffect, useRef } from 'react';\r\nimport { X } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst Modal = ({\r\n    isOpen,\r\n    onClose,\r\n    title,\r\n    children,\r\n    footerContent,\r\n    size = 'md', // 'sm', 'md', 'lg', 'xl', '2xl', '3xl', '4xl', '5xl', 'full'\r\n    closeOnOverlayClick = true,\r\n    initialFocusRef, // Optional ref for focusing an element inside the modal on open\r\n}) => {\r\n    const modalRef = useRef(null);\r\n\r\n    // Handle Escape key for closing\r\n    useEffect(() => {\r\n        const handleEscapeKey = (event) => {\r\n            if (event.key === 'Escape' && isOpen) {\r\n                onClose();\r\n            }\r\n        };\r\n        if (isOpen) {\r\n            document.addEventListener('keydown', handleEscapeKey);\r\n        }\r\n        return () => {\r\n            document.removeEventListener('keydown', handleEscapeKey);\r\n        };\r\n    }, [isOpen, onClose]);\r\n\r\n    // Handle focus trapping and initial focus\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            // Set focus to the initialFocusRef or the modal itself\r\n            if (initialFocusRef && initialFocusRef.current) {\r\n                initialFocusRef.current.focus();\r\n            } else if (modalRef.current) {\r\n                modalRef.current.focus(); // Fallback to modal itself\r\n            }\r\n\r\n            // Basic focus trapping (can be made more robust with a library)\r\n            const focusableElements = modalRef.current?.querySelectorAll(\r\n                'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\r\n            );\r\n            if (focusableElements && focusableElements.length > 0) {\r\n                const firstElement = focusableElements[0];\r\n                const lastElement = focusableElements[focusableElements.length - 1];\r\n\r\n                const onKeyDown = (e) => {\r\n                    if (e.key === 'Tab') {\r\n                        if (e.shiftKey) { // Shift + Tab\r\n                            if (document.activeElement === firstElement) {\r\n                                lastElement.focus();\r\n                                e.preventDefault();\r\n                            }\r\n                        } else { // Tab\r\n                            if (document.activeElement === lastElement) {\r\n                                firstElement.focus();\r\n                                e.preventDefault();\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n                modalRef.current?.addEventListener('keydown', onKeyDown);\r\n                return () => modalRef.current?.removeEventListener('keydown', onKeyDown);\r\n            }\r\n        }\r\n    }, [isOpen, initialFocusRef]);\r\n\r\n\r\n    const sizeClasses = {\r\n        sm: 'max-w-sm',\r\n        md: 'max-w-md',\r\n        lg: 'max-w-lg',\r\n        xl: 'max-w-xl',\r\n        '2xl': 'max-w-2xl',\r\n        '3xl': 'max-w-3xl',\r\n        '4xl': 'max-w-4xl',\r\n        '5xl': 'max-w-5xl',\r\n        full: 'max-w-full h-full rounded-none sm:rounded-lg sm:max-h-[95vh]', // Special case for full screen like\r\n    };\r\n\r\n    const backdropVariants = {\r\n        visible: { opacity: 1, transition: { duration: 0.2, ease: \"easeOut\" } },\r\n        hidden: { opacity: 0, transition: { duration: 0.15, ease: \"easeIn\" } },\r\n    };\r\n\r\n    const modalVariants = {\r\n        hidden: { y: \"-30px\", opacity: 0, scale: 0.98, transition: { duration: 0.15, ease: \"easeIn\" } },\r\n        visible: { y: \"0\", opacity: 1, scale: 1, transition: { type: \"spring\", stiffness: 400, damping: 30, duration: 0.3 } },\r\n        exit: { y: \"30px\", opacity: 0, scale: 0.98, transition: { duration: 0.2, ease: \"easeIn\" } }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <AnimatePresence mode=\"wait\">\r\n            {isOpen && (\r\n                <motion.div\r\n                    key=\"modal-backdrop\"\r\n                    className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 dark:bg-black/80 backdrop-blur-sm\"\r\n                    initial=\"hidden\"\r\n                    animate=\"visible\"\r\n                    exit=\"hidden\"\r\n                    variants={backdropVariants}\r\n                    onClick={closeOnOverlayClick ? onClose : undefined}\r\n                    aria-labelledby=\"modal-title\" // For screen readers\r\n                    role=\"dialog\" // Role for the backdrop itself, more specific roles on content\r\n                    aria-modal=\"true\" // Indicate it's a modal overlaying other content\r\n                >\r\n                    <motion.div\r\n                        key=\"modal-content-wrapper\" // Changed key for potential AnimatePresence behavior\r\n                        ref={modalRef}\r\n                        tabIndex={-1} // Make the modal itself focusable for fallback\r\n                        className={`bg-surface-light dark:bg-surface-dark rounded-lg shadow-xl w-full ${sizeClasses[size]} flex flex-col overflow-hidden\r\n                                    ${size === 'full' ? '' : 'max-h-[90vh] sm:max-h-[85vh]'}`} \r\n                                    // Apply max-h unless it's 'full' size\r\n                        role=\"document\" // The actual dialog content\r\n                        aria-modal=\"true\"\r\n                        aria-labelledby={title ? \"modal-title-text\" : undefined} // Point to title if exists\r\n                        initial=\"hidden\"\r\n                        animate=\"visible\"\r\n                        exit=\"exit\"\r\n                        variants={modalVariants}\r\n                        onClick={(e) => e.stopPropagation()} // Prevent closing when clicking inside modal\r\n                    >\r\n                        {/* Modal Header */}\r\n                        <div className=\"flex items-center justify-between px-5 py-3.5 border-b border-border-light dark:border-border-dark sticky top-0 bg-surface-light dark:bg-surface-dark z-10 flex-shrink-0\">\r\n                            {title && (\r\n                                <h2 id=\"modal-title-text\" className=\"text-lg font-semibold text-text-light dark:text-text-dark truncate pr-4\">\r\n                                    {title}\r\n                                </h2>\r\n                            )}\r\n                            <button\r\n                                onClick={onClose}\r\n                                className=\"p-1.5 rounded-full text-text-muted-light dark:text-text-muted-dark \r\n                                           hover:bg-gray-200/80 dark:hover:bg-gray-700/80 \r\n                                           hover:text-red-500 dark:hover:text-red-400 \r\n                                           focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-primary-light focus:ring-offset-1 dark:focus:ring-offset-surface-dark\"\r\n                                aria-label=\"Close modal\"\r\n                            >\r\n                                <X size={20} />\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Modal Body */}\r\n                        <div className=\"px-5 py-4 overflow-y-auto flex-grow custom-scrollbar\">\r\n                            {children}\r\n                        </div>\r\n\r\n                        {/* Modal Footer */}\r\n                        {footerContent && (\r\n                            <div className=\"px-5 py-3.5 border-t border-border-light dark:border-border-dark flex justify-end gap-3 sticky bottom-0 bg-surface-light dark:bg-surface-dark z-10 flex-shrink-0\">\r\n                                {footerContent}\r\n                            </div>\r\n                        )}\r\n                    </motion.div>\r\n                </motion.div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n};\r\n\r\nexport default Modal;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\documents\\DocumentList.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useAuth' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"useAuth"},"fix":{"range":[402,452],"text":""},"desc":"Remove unused variable 'useAuth'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\r\n// frontend/src/components/documents/DocumentList.jsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport api from '../../services/api.js'; // Mocked for V1\r\nimport toast from 'react-hot-toast';\r\nimport { FileText, Edit3, Trash2, Loader2, AlertTriangle, CheckCircle } from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx'; // Make sure IconButton is imported\r\nimport { useAuth } from '../../hooks/useAuth.jsx';\r\n\r\n// Props from LeftPanel: onSelectDocument is selectDocumentForAnalysis from AppStateContext\r\n// selectedDocument is selectedDocumentForAnalysis from AppStateContext\r\nfunction DocumentList({ onSelectDocument, selectedDocument }) {\r\n  const [files, setFiles] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n\r\n  const fetchFiles = useCallback(async () => {\r\n    setLoading(true);\r\n    setError('');\r\n    try {\r\n      \r\n      const response = await api.getFiles(); // Returns { filenames: [\"A.txt\", \"B.pdf\"] }\r\n      const filenames = Array.isArray(response.filenames) ? response.filenames : [];\r\n      setFiles(filenames);\r\n      \r\n    } catch (err) {\r\n      console.error(\"Failed to fetch files:\", err);\r\n      setError(err.message || \"Failed to fetch files.\");\r\n      toast.error(\"Could not load documents.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    fetchFiles();\r\n  }, [fetchFiles]);\r\n\r\n  const handleDelete = async (filename) => {\r\n    if (!window.confirm(`Are you sure you want to delete \"${filename}\"?`)) return;\r\n    const toastId = toast.loading(`Deleting ${filename}...`);\r\n    try {\r\n      await api.deleteFile(filename); // Assumes this works with filename\r\n      toast.success(`${filename} deleted.`, { id: toastId });\r\n      fetchFiles();\r\n      if (selectedDocument === filename) {\r\n        onSelectDocument(null);\r\n      }\r\n    } catch (err) {\r\n      toast.error(`Delete failed: ${err.message}`, { id: toastId });\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center p-4 text-text-muted-light dark:text-text-muted-dark\">\r\n        <Loader2 size={20} className=\"animate-spin mr-2\" /> Loading documents...\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-3 bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-300 rounded-md text-sm flex items-center gap-2\">\r\n        <AlertTriangle size={18} /> {error}\r\n        <button onClick={fetchFiles} className=\"ml-auto text-xs underline hover:text-red-400\">Retry</button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (files.length === 0) {\r\n    return <p className=\"text-center text-xs text-text-muted-light dark:text-text-muted-dark p-4\">No documents uploaded.</p>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-1.5 text-xs custom-scrollbar pr-1\">\r\n      {files.map(filename => {\r\n        const isSelected = selectedDocument === filename;\r\n\r\n        return (\r\n          <div\r\n            key={filename}\r\n            onClick={() => onSelectDocument(isSelected ? null : filename)}\r\n            className={`p-2.5 bg-surface-light dark:bg-gray-800 border rounded-md flex items-center justify-between hover:shadow-md transition-all duration-150 cursor-pointer\r\n                        ${isSelected\r\n                          ? 'ring-2 ring-primary dark:ring-primary-light shadow-lg border-primary dark:border-primary-light'\r\n                          : 'border-border-light dark:border-border-dark hover:border-gray-400 dark:hover:border-gray-500'}`}\r\n            title={`Select ${filename}`}\r\n          >\r\n            <div className=\"flex items-center gap-2 truncate\">\r\n              {isSelected ? (\r\n                <CheckCircle size={16} className=\"text-green-500 flex-shrink-0\" />\r\n              ) : (\r\n                <FileText size={16} className=\"text-primary dark:text-primary-light flex-shrink-0\" />\r\n              )}\r\n              <span className={`truncate ${isSelected ? 'font-semibold text-primary dark:text-primary-light' : 'text-text-light dark:text-text-dark'}`}>\r\n                {filename}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex-shrink-0 flex items-center gap-0.5\">\r\n              <IconButton\r\n                icon={Trash2}\r\n                size=\"sm\"\r\n                variant=\"ghost\"\r\n                title=\"Delete\"\r\n                onClick={(e) => {\r\n                  e.stopPropagation();\r\n                  handleDelete(filename);\r\n                }}\r\n                className=\"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1\"\r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\nexport default DocumentList;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\documents\\DocumentUpload.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[337,376],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\n\r\n// frontend/src/components/documents/DocumentUpload.jsx\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport api from '../../services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport { UploadCloud, FileText, XCircle, Paperclip, Link as LinkIcon } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport { motion } from 'framer-motion';\r\n\r\n// Define the stages for our static simulation\r\nconst RAG_STAGES = [\r\n    { name: \"Uploading\", duration: 1500, message: \"Transferring your document to the server...\" },\r\n    { name: \"Processing\", duration: 2000, message: \"Validating file format and structure...\" },\r\n    { name: \"Extracting\", duration: 3000, message: \"Extracting text and content from your document...\" },\r\n    { name: \"Chunking\", duration: 1500, message: \"Breaking document into manageable segments...\" },\r\n    { name: \"Embedding\", duration: 4000, message: \"Converting content to searchable vectors...\" },\r\n    { name: \"Analyzing\", duration: 3000, message: \"Indexing content for optimal retrieval...\" },\r\n];\r\n// MODIFIED: Renamed 'onUploadSuccess' prop to 'onSourceAdded'\r\nfunction DocumentUpload({ onSourceAdded }) { \r\n    const [selectedFile, setSelectedFile] = useState(null);\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [progress, setProgress] = useState(0);\r\n    const [currentStage, setCurrentStage] = useState('');\r\n    const [stageMessage, setStageMessage] = useState('');\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n    const [dragActive, setDragActive] = useState(false);\r\n    const [urlInput, setUrlInput] = useState('');\r\n    const [isIngestingUrl, setIsIngestingUrl] = useState(false);\r\n\r\n    const fileInputRef = useRef(null);\r\n    const processingTimeoutRef = useRef(null);\r\n    \r\n    useEffect(() => {\r\n        return () => {\r\n            if (processingTimeoutRef.current) {\r\n                clearTimeout(processingTimeoutRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const handleFileChange = (e) => {\r\n        if (isProcessing) return;\r\n        const file = e.target.files && e.target.files[0];\r\n        if (file) {\r\n            setSelectedFile(file);\r\n            setErrorMessage('');\r\n        }\r\n    };\r\n\r\n    const handleDrag = (e) => { e.preventDefault(); e.stopPropagation(); if (isProcessing) return; setDragActive(e.type === \"dragenter\" || e.type === \"dragover\"); };\r\n    const handleDrop = (e) => { e.preventDefault(); e.stopPropagation(); if (isProcessing) return; setDragActive(false); const file = e.dataTransfer.files && e.dataTransfer.files[0]; if (file) { setSelectedFile(file); setErrorMessage(''); }};\r\n\r\n    const resetState = () => {\r\n        setSelectedFile(null);\r\n        setIsProcessing(false);\r\n        setProgress(0);\r\n        setCurrentStage('');\r\n        setStageMessage('');\r\n        setErrorMessage('');\r\n        if (fileInputRef.current) fileInputRef.current.value = null;\r\n    };\r\n    \r\n    const runProgressSimulation = (stageIndex = 0) => {\r\n        if (stageIndex >= RAG_STAGES.length) return;\r\n\r\n        const stage = RAG_STAGES[stageIndex];\r\n        setCurrentStage(stage.name);\r\n        setStageMessage(stage.message);\r\n        \r\n        const totalDuration = RAG_STAGES.reduce((acc, s) => acc + s.duration, 0);\r\n        const elapsedDuration = RAG_STAGES.slice(0, stageIndex).reduce((acc, s) => acc + s.duration, 0);\r\n        setProgress(Math.round((elapsedDuration / totalDuration) * 100));\r\n\r\n        processingTimeoutRef.current = setTimeout(() => {\r\n            runProgressSimulation(stageIndex + 1);\r\n        }, stage.duration);\r\n    };\r\n\r\n    const handleUpload = async () => {\r\n        if (!selectedFile) {\r\n            toast.error(\"Please select a file first.\");\r\n            return;\r\n        }\r\n        setIsProcessing(true);\r\n        setErrorMessage('');\r\n        runProgressSimulation(0);\r\n\r\n        const formData = new FormData();\r\n        formData.append(\"file\", selectedFile);\r\n        \r\n        try {\r\n            await api.uploadFile(formData);\r\n            if (processingTimeoutRef.current) clearTimeout(processingTimeoutRef.current);\r\n            setProgress(100);\r\n            toast.success(`'${selectedFile.name}' accepted! Processing has begun.`, { duration: 4000 });\r\n            \r\n            setTimeout(() => {\r\n                resetState();\r\n                if (onSourceAdded) onSourceAdded(); // Now correctly calls onSourceAdded\r\n            }, 1500);\r\n\r\n        } catch (error) {\r\n            if (processingTimeoutRef.current) clearTimeout(processingTimeoutRef.current);\r\n            const msg = error.response?.data?.message || error.message || \"Upload failed.\";\r\n            setErrorMessage(msg);\r\n            toast.error(`Upload failed: ${msg}`);\r\n            setIsProcessing(false);\r\n            setCurrentStage('Failed');\r\n            setProgress(100);\r\n        }\r\n    };\r\n\r\n    const handleIngestUrl = async () => {\r\n        const url = urlInput.trim();\r\n        if (!url) {\r\n            toast.error(\"Please enter a valid URL.\");\r\n            return;\r\n        }\r\n        setIsIngestingUrl(true);\r\n        const toastId = toast.loading(`Ingesting URL: ${url.substring(0, 30)}...`);\r\n        try {\r\n            await api.addUrlSource(url);\r\n            toast.success(\"URL accepted! Processing has begun in the background.\", { id: toastId });\r\n            setUrlInput('');\r\n            if (onSourceAdded) onSourceAdded(); // Now correctly calls onSourceAdded\r\n        } catch (error) {\r\n            const msg = error.response?.data?.message || error.message || \"Failed to ingest URL.\";\r\n            toast.error(msg, { id: toastId });\r\n        } finally {\r\n            setIsIngestingUrl(false);\r\n        }\r\n    };\r\n\r\n    if (isProcessing) {\r\n        return (\r\n            <div className=\"card-base p-4 mb-4\">\r\n                <h3 className=\"font-semibold text-text-light dark:text-text-dark\">\r\n                    ðŸ“„ Processing: <span className=\"font-normal truncate\">{selectedFile.name}</span>\r\n                </h3>\r\n                <div className=\"relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 my-2\">\r\n                    <motion.div\r\n                        className={`h-2.5 rounded-full ${errorMessage ? 'bg-red-500' : 'bg-primary'}`}\r\n                        initial={{ width: '0%' }}\r\n                        animate={{ width: `${progress}%` }}\r\n                        transition={{ duration: 0.5, ease: 'linear' }}\r\n                    />\r\n                </div>\r\n                <div className=\"flex justify-between text-xs text-text-muted-light dark:text-text-muted-dark\">\r\n                    <span>{errorMessage ? 'Error' : `Stage: ${currentStage}`} ({progress}%)</span>\r\n                </div>\r\n                <p className=\"text-xs text-center mt-2 h-4\">{errorMessage || stageMessage}</p>\r\n                {errorMessage && (\r\n                    <Button onClick={resetState} fullWidth variant=\"danger\" size=\"sm\" className=\"mt-3\">\r\n                        Close\r\n                    </Button>\r\n                )}\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    return (\r\n        <div className=\"mb-4 space-y-4\">\r\n            {/* --- File Upload Section (Existing JSX, no changes needed) --- */}\r\n            <div>\r\n                <label\r\n                    htmlFor=\"file-upload-input\"\r\n                    onDragEnter={handleDrag} onDragLeave={handleDrag} onDragOver={handleDrag} onDrop={handleDrop}\r\n                    className={`flex flex-col items-center justify-center w-full h-28 px-4 transition-colors duration-200 ease-in-out bg-surface-light dark:bg-gray-800 border-2 border-dashed rounded-lg cursor-pointer border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary-light ${dragActive ? \"border-primary dark:border-primary-light ring-2 ring-primary dark:ring-primary-light bg-primary/10 dark:bg-primary-dark/20\" : \"\"}`}\r\n                >\r\n                    <div className=\"flex flex-col items-center justify-center text-center\">\r\n                        <Paperclip size={28} className={`mb-1 transition-colors ${dragActive ? 'text-primary dark:text-primary-light' : 'text-text-muted-light dark:text-text-muted-dark'}`} />\r\n                        <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\"><span className=\"font-semibold text-primary dark:text-primary-light\">Upload a file</span> or drag & drop</p>\r\n                        <p className=\"text-xs text-text-muted-light/70 dark:text-text-muted-dark/70\">PDF, DOCX, TXT, Media, etc.</p>\r\n                    </div>\r\n                    <input ref={fileInputRef} id=\"file-upload-input\" type=\"file\" className=\"hidden\" onChange={handleFileChange} accept=\".pdf,.docx,.txt,.md,.mp3,.wav,.mp4,.mov,.png,.jpg,.jpeg\" />\r\n                </label>\r\n                {selectedFile && ( <div className=\"mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md flex items-center justify-between text-sm animate-fadeIn\"> <div className=\"flex items-center gap-2 truncate\"> <FileText size={18} className=\"text-primary flex-shrink-0\" /> <span className=\"truncate text-text-light dark:text-text-dark\" title={selectedFile.name}>{selectedFile.name}</span> <span className=\"text-text-muted-light dark:text-text-muted-dark text-xs whitespace-nowrap\"> ({(selectedFile.size / 1024).toFixed(1)} KB) </span> </div> <button onClick={() => setSelectedFile(null)} className=\"text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors p-1 rounded-full hover:bg-red-500/10\"> <XCircle size={18} /> </button> </div> )}\r\n                <Button onClick={handleUpload} fullWidth className=\"mt-2 text-sm\" variant=\"primary\" disabled={!selectedFile} leftIcon={<UploadCloud size={16} />}> Process File </Button>\r\n            </div>\r\n\r\n            {/* --- NEW URL INGESTION SECTION --- */}\r\n            <div className=\"relative pt-4 border-t border-border-light dark:border-border-dark\">\r\n                <p className=\"text-center text-xs text-text-muted-light dark:text-text-muted-dark absolute -top-2.5 left-1/2 -translate-x-1/2 bg-surface-light dark:bg-surface-dark px-2\">OR</p>\r\n                <label htmlFor=\"url-input\" className=\"block text-sm font-medium text-text-light dark:text-text-dark mb-1.5\">Add from URL</label>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"relative flex-grow\">\r\n                        <LinkIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted-light dark:text-text-muted-dark\" />\r\n                        <input\r\n                            id=\"url-input\"\r\n                            type=\"url\"\r\n                            value={urlInput}\r\n                            onChange={(e) => setUrlInput(e.target.value)}\r\n                            placeholder=\"Enter YouTube or webpage URL...\"\r\n                            className=\"input-field !pl-9 !py-2 !text-sm w-full\"\r\n                            disabled={isIngestingUrl}\r\n                        />\r\n                    </div>\r\n                    <Button\r\n                        onClick={handleIngestUrl}\r\n                        size=\"md\"\r\n                        className=\"!px-3 !py-2\"\r\n                        isLoading={isIngestingUrl}\r\n                        disabled={!urlInput.trim() || isIngestingUrl}\r\n                    >\r\n                        Ingest\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default DocumentUpload;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\documents\\KnowledgeSourceList.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":26,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":26,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/documents/KnowledgeSourceList.jsx\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport api from '../../services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport {\r\n    FileText, CheckCircle, Loader2, AlertTriangle, Trash2,\r\n    Youtube, Globe, Library\r\n} from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { formatDistanceToNow } from 'date-fns';\r\n\r\nconst getSourceIcon = (sourceType) => {\r\n    const icons = {\r\n        'document': FileText, 'youtube': Youtube, 'webpage': Globe,\r\n        'subject': Library, 'audio': FileText, 'video': FileText, 'image': FileText\r\n    };\r\n    return icons[sourceType] || FileText;\r\n};\r\n\r\nconst formatRelativeTime = (dateString) => {\r\n    if (!dateString) return 'date unknown';\r\n    try {\r\n        const date = new Date(dateString);\r\n        if (isNaN(date.getTime())) return 'invalid date';\r\n        return formatDistanceToNow(date, { addSuffix: true });\r\n    } catch (e) {\r\n        return 'date error';\r\n    }\r\n};\r\n\r\nfunction KnowledgeSourceList({ onSelectSource, selectedSource, onRefreshNeeded }) {\r\n    const [sources, setSources] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const pollingIntervalRef = useRef(null);\r\n\r\n    const fetchSources = useCallback(async (isPolling = false) => {\r\n        if (!isPolling) setLoading(true);\r\n        setError('');\r\n        try {\r\n            const response = await api.getKnowledgeSources();\r\n            const fetchedSources = Array.isArray(response) ? response : [];\r\n            const userOnlySources = fetchedSources.filter(source => source.sourceType !== 'subject');\r\n            setSources(userOnlySources)\r\n            // Check if there are any sources still processing to decide if we need to continue polling.\r\n            const stillProcessing = fetchedSources.some(s => s.status && s.status.startsWith('processing'));\r\n            \r\n            if (pollingIntervalRef.current && !stillProcessing) {\r\n                console.log(\"[Polling] All sources processed. Stopping polling.\");\r\n                clearInterval(pollingIntervalRef.current);\r\n                pollingIntervalRef.current = null;\r\n            }\r\n        } catch (err) {\r\n            setError(err.message || \"Failed to fetch knowledge sources.\");\r\n            if (!isPolling) toast.error(\"Could not load knowledge base.\");\r\n            // Stop polling on error\r\n            if (pollingIntervalRef.current) {\r\n                clearInterval(pollingIntervalRef.current);\r\n                pollingIntervalRef.current = null;\r\n            }\r\n        } finally {\r\n            if (!isPolling) setLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    // Effect for initial load and manual refresh\r\n    useEffect(() => {\r\n        fetchSources();\r\n    }, [fetchSources, onRefreshNeeded]);\r\n\r\n    // --- NEW: Effect for automatic polling ---\r\n    useEffect(() => {\r\n        // Stop any existing polling interval when the component mounts or sources change\r\n        if (pollingIntervalRef.current) {\r\n            clearInterval(pollingIntervalRef.current);\r\n            pollingIntervalRef.current = null;\r\n        }\r\n\r\n        // Check if there are any sources currently in a processing state\r\n        const isProcessing = sources.some(s => s.status && s.status.startsWith('processing'));\r\n\r\n        if (isProcessing) {\r\n            console.log(\"[Polling] Detected processing sources. Starting polling every 5 seconds.\");\r\n            pollingIntervalRef.current = setInterval(() => {\r\n                console.log(\"[Polling] Fetching source statuses...\");\r\n                fetchSources(true); // `true` indicates this is a silent background poll\r\n            }, 5000); // Poll every 5 seconds\r\n        }\r\n\r\n        // Cleanup function to clear the interval when the component unmounts\r\n        // or when the dependencies (sources array) change.\r\n        return () => {\r\n            if (pollingIntervalRef.current) {\r\n                clearInterval(pollingIntervalRef.current);\r\n            }\r\n        };\r\n    }, [sources, fetchSources]); // This effect depends on the `sources` array\r\n\r\n    const handleDelete = async (sourceId, sourceTitle, sourceType) => {\r\n        // ... (handleDelete logic remains exactly the same) ...\r\n        if (sourceType === 'subject') {\r\n            toast.error(\"Admin-provided subjects cannot be deleted by users.\");\r\n            return;\r\n        }\r\n        if (!window.confirm(`Are you sure you want to delete \"${sourceTitle}\"? This will remove it and all its associated data.`)) return;\r\n        \r\n        const toastId = toast.loading(`Deleting ${sourceTitle}...`);\r\n        try {\r\n            await api.deleteKnowledgeSource(sourceId);\r\n            toast.success(`\"${sourceTitle}\" deleted.`, { id: toastId });\r\n            fetchSources();\r\n            if (selectedSource === sourceTitle) {\r\n                onSelectSource(null);\r\n            }\r\n        } catch (err) {\r\n            toast.error(`Delete failed: ${err.message}`, { id: toastId });\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        // ... (loading JSX remains the same) ...\r\n        return (\r\n            <div className=\"flex items-center justify-center p-4 text-text-muted-light dark:text-text-muted-dark\">\r\n                <Loader2 size={20} className=\"animate-spin mr-2\" /> Loading knowledge base...\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (error) {\r\n        // ... (error JSX remains the same) ...\r\n        return (\r\n            <div className=\"p-3 bg-red-500/10 border border-red-500/30 text-red-600 dark:text-red-300 rounded-md text-sm flex items-center gap-2\">\r\n                <AlertTriangle size={18} /> {error}\r\n                <button onClick={() => fetchSources()} className=\"ml-auto text-xs underline hover:text-red-400\">Retry</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (sources.length === 0) {\r\n        // ... (empty JSX remains the same) ...\r\n        return <p className=\"text-center text-xs text-text-muted-light dark:text-text-muted-dark p-4\">Your knowledge base is empty.</p>;\r\n    }\r\n\r\n    return (\r\n        // ... (the main return JSX with the list mapping remains exactly the same) ...\r\n        <div className=\"space-y-1.5 text-xs custom-scrollbar pr-1\">\r\n            {sources.map(source => {\r\n                const isSelected = selectedSource === source.title;\r\n                const isProcessing = source.status && source.status.startsWith('processing');\r\n                const isFailed = source.status === 'failed';\r\n                const isSelectable = source.status === 'completed';\r\n                const Icon = getSourceIcon(source.sourceType);\r\n\r\n                return (\r\n                    <div\r\n                        key={source._id}\r\n                        onClick={() => isSelectable && onSelectSource(isSelected ? null : source.title)}\r\n                        className={`p-2.5 bg-surface-light dark:bg-gray-800 border rounded-md flex items-center justify-between transition-all duration-150\r\n                                    ${isSelectable ? 'cursor-pointer hover:shadow-md' : 'cursor-default opacity-80'}\r\n                                    ${isSelected ? 'ring-2 ring-primary dark:ring-primary-light shadow-lg border-primary dark:border-primary-light' : 'border-border-light dark:border-border-dark'}`}\r\n                        title={isSelectable ? `Select ${source.title}` : `Status: ${source.status} - ${source.failureReason || ''}`}\r\n                    >\r\n                        <div className=\"flex items-center gap-2 truncate\">\r\n                            {isSelected ? <CheckCircle size={16} className=\"text-green-500 flex-shrink-0\" /> : <Icon size={16} className=\"text-primary dark:text-primary-light flex-shrink-0\" />}\r\n                            <div className=\"truncate\">\r\n                                <span className={`block truncate ${isSelected ? 'font-semibold text-primary dark:text-primary-light' : 'text-text-light dark:text-text-dark'}`}>{source.title}</span>\r\n                                <span className=\"text-[0.7rem] text-text-muted-light dark:text-text-muted-dark\">\r\n                                    {formatRelativeTime(source.createdAt)}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-1.5 flex-shrink-0\">\r\n                             {isProcessing && <Loader2 size={14} className=\"animate-spin text-accent\" title={`Processing... (${source.status})`} />}\r\n                             {isFailed && <AlertTriangle size={14} className=\"text-red-500\" title={`Processing failed: ${source.failureReason || 'Unknown error'}`} />}\r\n                             {source.sourceType !== 'subject' && (\r\n                                <IconButton icon={Trash2} size=\"sm\" variant=\"ghost\" title=\"Delete\"\r\n                                    onClick={(e) => { e.stopPropagation(); handleDelete(source._id, source.title, source.sourceType); }}\r\n                                    className=\"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 p-1\"\r\n                                />\r\n                             )}\r\n                        </div>\r\n                    </div>\r\n                );\r\n            })}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default KnowledgeSourceList;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\documents\\SourceIngestion.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[334,373],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/documents/SourceIngestion.jsx\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport api from '../../services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport { UploadCloud, FileText, XCircle, Paperclip, Link as LinkIcon } from 'lucide-react';\r\nimport Button from '../core/Button.jsx';\r\nimport { motion } from 'framer-motion';\r\n\r\n// --- NEW: Simulation stages for a better user experience ---\r\nconst PROCESSING_STAGES = [\r\n    { name: \"Uploading\", duration: 1500, message: \"Transferring your document to the server...\" },\r\n    { name: \"Extracting Content\", duration: 3000, message: \"Extracting text and media from your document...\" },\r\n    { name: \"Indexing for AI\", duration: 4000, message: \"Preparing content for vector search...\" },\r\n    { name: \"Finalizing\", duration: 1500, message: \"Finalizing the ingestion process...\" },\r\n];\r\n\r\nfunction SourceIngestion({ onSourceAdded }) {\r\n    const [selectedFile, setSelectedFile] = useState(null);\r\n    const [isUploading, setIsUploading] = useState(false);\r\n    const [dragActive, setDragActive] = useState(false);\r\n    const [urlInput, setUrlInput] = useState('');\r\n    const [isIngestingUrl, setIsIngestingUrl] = useState(false);\r\n    const fileInputRef = useRef(null);\r\n    \r\n    // --- NEW: State for progress simulation ---\r\n    const [progress, setProgress] = useState(0);\r\n    const [currentStage, setCurrentStage] = useState('');\r\n    const [stageMessage, setStageMessage] = useState('');\r\n    const processingTimeoutRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        // Cleanup timeout on component unmount\r\n        return () => {\r\n            if (processingTimeoutRef.current) {\r\n                clearTimeout(processingTimeoutRef.current);\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const handleFileChange = (e) => {\r\n        if (isUploading) return;\r\n        const file = e.target.files?.[0];\r\n        if (file) setSelectedFile(file);\r\n    };\r\n\r\n    const handleDrag = (e) => { e.preventDefault(); e.stopPropagation(); if (isUploading) return; setDragActive(e.type === \"dragenter\" || e.type === \"dragover\"); };\r\n    const handleDrop = (e) => { e.preventDefault(); e.stopPropagation(); if (isUploading) return; setDragActive(false); const file = e.dataTransfer.files?.[0]; if (file) setSelectedFile(file); };\r\n\r\n    const resetUploadState = () => {\r\n        setSelectedFile(null);\r\n        setIsUploading(false);\r\n        setProgress(0);\r\n        setCurrentStage('');\r\n        setStageMessage('');\r\n        if (fileInputRef.current) fileInputRef.current.value = null;\r\n    };\r\n\r\n    const runProgressSimulation = (stageIndex = 0) => {\r\n        if (stageIndex >= PROCESSING_STAGES.length) return;\r\n\r\n        const stage = PROCESSING_STAGES[stageIndex];\r\n        setCurrentStage(stage.name);\r\n        setStageMessage(stage.message);\r\n        \r\n        const totalDuration = PROCESSING_STAGES.reduce((acc, s) => acc + s.duration, 0);\r\n        const elapsedDuration = PROCESSING_STAGES.slice(0, stageIndex).reduce((acc, s) => acc + s.duration, 0);\r\n        setProgress(Math.round((elapsedDuration / totalDuration) * 100));\r\n\r\n        processingTimeoutRef.current = setTimeout(() => {\r\n            runProgressSimulation(stageIndex + 1);\r\n        }, stage.duration);\r\n    };\r\n\r\n    const handleUpload = async () => {\r\n        if (!selectedFile) {\r\n            toast.error(\"Please select a file to upload.\");\r\n            return;\r\n        }\r\n        setIsUploading(true);\r\n        runProgressSimulation(0); // Start the visual simulation\r\n        \r\n        const formData = new FormData();\r\n        formData.append(\"file\", selectedFile);\r\n        \r\n        try {\r\n            await api.uploadFile(formData);\r\n            if (processingTimeoutRef.current) clearTimeout(processingTimeoutRef.current);\r\n            setProgress(100);\r\n            setCurrentStage(\"Completed\");\r\n            setStageMessage(\"Your document is ready!\");\r\n            toast.success(`'${selectedFile.name}' processed successfully!`);\r\n            \r\n            setTimeout(() => {\r\n                resetUploadState();\r\n                if (onSourceAdded) onSourceAdded();\r\n            }, 2000);\r\n\r\n        } catch (error) {\r\n            if (processingTimeoutRef.current) clearTimeout(processingTimeoutRef.current);\r\n            const msg = error.response?.data?.message || error.message || \"Upload failed.\";\r\n            toast.error(`Upload failed: ${msg}`);\r\n            // Keep the upload UI visible on error to show the file name\r\n            setIsUploading(false); \r\n        }\r\n    };\r\n\r\n    const handleIngestUrl = async () => {\r\n        const url = urlInput.trim();\r\n        if (!url) {\r\n            toast.error(\"Please enter a valid URL.\");\r\n            return;\r\n        }\r\n        setIsIngestingUrl(true);\r\n        const toastId = toast.loading(`Ingesting URL: ${url.substring(0, 30)}...`);\r\n        try {\r\n            await api.addUrlSource(url);\r\n            toast.success(\"URL accepted! Processing has begun in the background.\", { id: toastId });\r\n            setUrlInput('');\r\n            if (onSourceAdded) onSourceAdded();\r\n        } catch (error) {\r\n            const msg = error.response?.data?.message || error.message || \"Failed to ingest URL.\";\r\n            toast.error(msg, { id: toastId });\r\n        } finally {\r\n            setIsIngestingUrl(false);\r\n        }\r\n    };\r\n\r\n    // --- NEW: This is the progress view ---\r\n    if (isUploading) {\r\n        return (\r\n            <div className=\"p-4 mb-4\">\r\n                <h3 className=\"font-semibold text-text-light dark:text-text-dark flex items-baseline min-w-0 gap-2\">\r\n                    <span className=\"flex-shrink-0\">ðŸ“„ Processing:</span>\r\n                    <span className=\"font-normal truncate block\" title={selectedFile.name}>\r\n                        {selectedFile.name}\r\n                    </span>\r\n                </h3>\r\n                <div className=\"relative w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 my-2\">\r\n                    <motion.div\r\n                        className=\"bg-primary h-2.5 rounded-full\"\r\n                        initial={{ width: '0%' }}\r\n                        animate={{ width: `${progress}%` }}\r\n                        transition={{ duration: 0.5, ease: 'linear' }}\r\n                    />\r\n                </div>\r\n                <div className=\"flex justify-between text-xs text-text-muted-light dark:text-text-muted-dark\">\r\n                    <span>Stage: {currentStage} ({progress}%)</span>\r\n                </div>\r\n                <p className=\"text-xs text-center mt-2 h-4\">{stageMessage}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"space-y-4\">\r\n            {/* --- File Upload Section --- */}\r\n            <div>\r\n                <label\r\n                    htmlFor=\"file-upload-input\"\r\n                    onDragEnter={handleDrag} onDragLeave={handleDrag} onDragOver={handleDrag} onDrop={handleDrop}\r\n                    className={`flex flex-col items-center justify-center w-full h-28 px-4 transition-colors duration-200 ease-in-out bg-surface-light dark:bg-gray-800 border-2 border-dashed rounded-lg cursor-pointer border-border-light dark:border-border-dark hover:border-primary dark:hover:border-primary-light ${dragActive ? \"border-primary dark:border-primary-light ring-2 ring-primary dark:ring-primary-light bg-primary/10 dark:bg-primary-dark/20\" : \"\"}`}\r\n                >\r\n                    <div className=\"flex flex-col items-center justify-center text-center\">\r\n                        <Paperclip size={28} className={`mb-1 transition-colors ${dragActive ? 'text-primary dark:text-primary-light' : 'text-text-muted-light dark:text-text-muted-dark'}`} />\r\n                        <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\"><span className=\"font-semibold text-primary dark:text-primary-light\">Upload a file</span> or drag & drop</p>\r\n                        <p className=\"text-xs text-text-muted-light/70 dark:text-text-muted-dark/70\">PDF, DOCX, Media, etc.</p>\r\n                    </div>\r\n                    <input ref={fileInputRef} id=\"file-upload-input\" type=\"file\" className=\"hidden\" onChange={handleFileChange} accept=\".pdf,.docx,.txt,.md,.mp3,.wav,.mp4,.mov,.png,.jpg,.jpeg\" />\r\n                </label>\r\n                {selectedFile && (\r\n                    <div className=\"mt-2 p-2 bg-gray-100 dark:bg-gray-700 rounded-md flex items-center justify-between text-sm animate-fadeIn\">\r\n                        <div className=\"flex items-center gap-2 truncate min-w-0\">\r\n                            <FileText size={18} className=\"text-primary flex-shrink-0\" />\r\n                            <span className=\"truncate text-text-light dark:text-text-dark\" title={selectedFile.name}>{selectedFile.name}</span>\r\n                        </div>\r\n                        <button onClick={() => setSelectedFile(null)} className=\"p-1 rounded-full text-red-500 hover:text-red-700 dark:hover:text-red-400 transition-colors hover:bg-red-500/10\">\r\n                            <XCircle size={18} />\r\n                        </button>\r\n                    </div>\r\n                )}\r\n                <Button onClick={handleUpload} fullWidth className=\"mt-2 text-sm\" variant=\"primary\" isLoading={isUploading} disabled={!selectedFile || isUploading} leftIcon={<UploadCloud size={16} />}>\r\n                    Process File\r\n                </Button>\r\n            </div>\r\n\r\n            {/* --- URL Ingestion Section --- */}\r\n            <div className=\"relative pt-4 border-t border-border-light dark:border-border-dark\">\r\n                <p className=\"text-center text-xs text-text-muted-light dark:text-text-muted-dark absolute -top-2.5 left-1/2 -translate-x-1/2 bg-surface-light dark:bg-surface-dark px-2\">OR</p>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <div className=\"relative flex-grow\">\r\n                        <LinkIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-text-muted-light dark:text-text-muted-dark\" />\r\n                        <input\r\n                            id=\"url-input\"\r\n                            type=\"url\"\r\n                            value={urlInput}\r\n                            onChange={(e) => setUrlInput(e.target.value)}\r\n                            placeholder=\"Enter YouTube or webpage URL...\"\r\n                            className=\"input-field !pl-9 !py-2 !text-sm w-full\"\r\n                            disabled={isIngestingUrl}\r\n                        />\r\n                    </div>\r\n                    <Button onClick={handleIngestUrl} size=\"md\" className=\"!px-3 !py-2\" isLoading={isIngestingUrl} disabled={!urlInput.trim() || isIngestingUrl}>\r\n                        Ingest\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default SourceIngestion;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\documents\\SubjectList.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\BadgesShowcase.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\BossBattles.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[248,255],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'loading' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":19,"suggestions":[{"messageId":"removeVar","data":{"varName":"loading"},"fix":{"range":[660,667],"text":""},"desc":"Remove unused variable 'loading'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":80,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":80,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[3135,3136],"text":""},"desc":"Remove unused variable 't'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":120,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":120,"endColumn":40,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[5637,5638],"text":""},"desc":"Remove unused variable 't'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Swords, Trophy, Clock, X, CheckCircle, XCircle, Sparkles, Award, TrendingUp, Zap, Star } from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst BossBattles = () => {\r\n    const [battles, setBattles] = useState([]);\r\n    const [history, setHistory] = useState([]);\r\n    const [activeBattle, setActiveBattle] = useState(null);\r\n    const [currentQuestion, setCurrentQuestion] = useState(0);\r\n    const [answers, setAnswers] = useState([]);\r\n    const [result, setResult] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [view, setView] = useState('list'); // 'list', 'battle', 'result'\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n    }, []);\r\n\r\n    const fetchData = async () => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const [battlesRes, historyRes] = await Promise.all([\r\n                axios.get(`${import.meta.env.VITE_API_BASE_URL}/gamification/boss-battles`, {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                }),\r\n                axios.get(`${import.meta.env.VITE_API_BASE_URL}/gamification/boss-battles/history`, {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                })\r\n            ]);\r\n\r\n            setBattles(battlesRes.data.battles || []);\r\n            setHistory(historyRes.data.history || []);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('[BossBattles] Error:', error);\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const startBattle = (battle) => {\r\n        setActiveBattle(battle);\r\n        setCurrentQuestion(0);\r\n        setAnswers(new Array(battle.questions.length).fill({ userAnswer: '', timeSpent: 0 }));\r\n        setView('battle');\r\n    };\r\n\r\n    const selectAnswer = (answer) => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[currentQuestion] = { userAnswer: answer, timeSpent: 10 };\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const nextQuestion = () => {\r\n        if (currentQuestion < activeBattle.questions.length - 1) {\r\n            setCurrentQuestion(currentQuestion + 1);\r\n        }\r\n    };\r\n\r\n    const submitBattle = async () => {\r\n        if (submitting) return; // Prevent duplicate submissions\r\n\r\n        setSubmitting(true);\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/boss-battle/${activeBattle.battleId}/submit`,\r\n                { answers },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n\r\n            const battleResult = response.data;\r\n            setResult(battleResult);\r\n            setView('result');\r\n\r\n            // Show success/failure toast with detailed scoring\r\n            if (battleResult.status === 'completed') {\r\n                toast.custom((t) => (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                        animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                        exit={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                        className=\"bg-gradient-to-br from-green-500 to-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl\"\r\n                    >\r\n                        <div className=\"flex items-start gap-3\">\r\n                            <Trophy className=\"flex-shrink-0\" size={32} />\r\n                            <div>\r\n                                <h3 className=\"font-bold text-xl mb-2\">Victory! ðŸŽ‰</h3>\r\n                                <div className=\"space-y-1\">\r\n                                    <p className=\"flex items-center gap-2\">\r\n                                        <TrendingUp size={18} />\r\n                                        <span className=\"font-semibold\">Score: {battleResult.score}%</span>\r\n                                    </p>\r\n                                    <p className=\"flex items-center gap-2\">\r\n                                        <Star size={18} />\r\n                                        <span className=\"font-semibold\">+{battleResult.earnedXP} XP</span>\r\n                                        <span className=\"text-sm opacity-80\">(Total: {battleResult.newXPTotal})</span>\r\n                                    </p>\r\n                                    <p className=\"flex items-center gap-2\">\r\n                                        <Award size={18} />\r\n                                        <span className=\"font-semibold\">Level {battleResult.newLevel}</span>\r\n                                    </p>\r\n                                    {battleResult.earnedBadge && (\r\n                                        <p className=\"flex items-center gap-2\">\r\n                                            <Sparkles size={18} />\r\n                                            <span className=\"font-semibold\">Badge: {battleResult.earnedBadge}</span>\r\n                                        </p>\r\n                                    )}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                ), { duration: 6000 });\r\n\r\n                // Show level up animation if leveled up\r\n                if (battleResult.leveledUp) {\r\n                    setTimeout(() => {\r\n                        toast.custom((t) => (\r\n                            <motion.div\r\n                                initial={{ scale: 0, rotate: -180 }}\r\n                                animate={{ scale: 1, rotate: 0 }}\r\n                                exit={{ scale: 0, rotate: 180 }}\r\n                                transition={{ type: 'spring', duration: 0.8 }}\r\n                                className=\"bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 p-6 rounded-2xl shadow-2xl text-center text-white\"\r\n                            >\r\n                                <Sparkles className=\"mx-auto mb-2\" size={48} />\r\n                                <h2 className=\"text-3xl font-bold mb-1\">LEVEL UP!</h2>\r\n                                <p className=\"text-5xl font-black\">{battleResult.newLevel}</p>\r\n                            </motion.div>\r\n                        ), { duration: 4000 });\r\n                    }, 2000);\r\n                }\r\n            } else {\r\n                toast.error(\r\n                    `Battle failed with ${battleResult.score}%. Review the revision plan and try again!`,\r\n                    { duration: 4000, icon: 'âŒ' }\r\n                );\r\n            }\r\n\r\n            // Remove the submitted battle from active battles immediately\r\n            setBattles(prevBattles => \r\n                prevBattles.filter(b => b.battleId !== activeBattle.battleId)\r\n            );\r\n\r\n            // Add to history immediately for better UX\r\n            if (battleResult.status === 'completed' || battleResult.status === 'failed') {\r\n                setHistory(prevHistory => [\r\n                    {\r\n                        ...activeBattle,\r\n                        ...battleResult,\r\n                        completedAt: new Date()\r\n                    },\r\n                    ...prevHistory\r\n                ]);\r\n            }\r\n\r\n            // Refresh complete data after showing result (reduced to 4 seconds)\r\n            setTimeout(async () => {\r\n                await fetchData();\r\n                setView('list');\r\n                setActiveBattle(null);\r\n                setResult(null);\r\n                setSubmitting(false);\r\n            }, 4000);\r\n\r\n        } catch (error) {\r\n            console.error('[BossBattles] Submit error:', error);\r\n            toast.error(error.response?.data?.message || 'Error submitting battle');\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    const getDifficultyColor = (difficulty) => {\r\n        const colors = {\r\n            easy: 'bg-green-100 text-green-700 border-green-300',\r\n            medium: 'bg-yellow-100 text-yellow-700 border-yellow-300',\r\n            hard: 'bg-orange-100 text-orange-700 border-orange-300'\r\n        };\r\n        return colors[difficulty] || colors.medium;\r\n    };\r\n\r\n    const getDifficultyIcon = (difficulty) => {\r\n        const icons = {\r\n            easy: 'â­',\r\n            medium: 'â­â­',\r\n            hard: 'â­â­â­'\r\n        };\r\n        return icons[difficulty] || icons.medium;\r\n    };\r\n\r\n    // Battle View\r\n    if (view === 'battle' && activeBattle) {\r\n        const question = activeBattle.questions[currentQuestion];\r\n        const progress = ((currentQuestion + 1) / activeBattle.questions.length) * 100;\r\n        const allAnswered = answers.every(a => a.userAnswer);\r\n\r\n        return (\r\n            <div className=\"max-w-3xl mx-auto p-6\">\r\n                <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 border-2 border-purple-500\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                            <Swords className=\"text-purple-600\" size={28} />\r\n                            <div>\r\n                                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\r\n                                    Boss Battle: {activeBattle.targetWeakness}\r\n                                </h2>\r\n                                <span className={`px-2 py-1 rounded text-xs font-medium ${getDifficultyColor(activeBattle.difficulty)}`}>\r\n                                    {activeBattle.difficulty}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                        <button\r\n                            onClick={() => {\r\n                                if (confirm('Are you sure you want to exit this battle? Your progress will be lost.')) {\r\n                                    setView('list');\r\n                                    setActiveBattle(null);\r\n                                    setCurrentQuestion(0);\r\n                                    setAnswers([]);\r\n                                }\r\n                            }}\r\n                            className=\"text-gray-400 hover:text-red-500 transition-colors\"\r\n                            title=\"Exit Battle\"\r\n                        >\r\n                            <X size={28} className=\"hover:scale-110 transition-transform\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Progress Bar */}\r\n                    <div className=\"mb-6\">\r\n                        <div className=\"flex justify-between text-sm text-gray-600 mb-2\">\r\n                            <span>Question {currentQuestion + 1} of {activeBattle.questions.length}</span>\r\n                            <span>{Math.round(progress)}% Complete</span>\r\n                        </div>\r\n                        <div className=\"w-full bg-gray-200 rounded-full h-3\">\r\n                            <div\r\n                                className=\"bg-purple-600 h-full rounded-full transition-all duration-300\"\r\n                                style={{ width: `${progress}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Question */}\r\n                    <div className=\"mb-6\">\r\n                        <p className=\"text-lg text-gray-800 dark:text-gray-200 mb-4\">\r\n                            {question.questionText}\r\n                        </p>\r\n\r\n                        {/* Options */}\r\n                        <div className=\"space-y-3\">\r\n                            {question.options.map((option, index) => (\r\n                                <button\r\n                                    key={index}\r\n                                    onClick={() => selectAnswer(option)}\r\n                                    className={`w-full text-left p-4 rounded-lg border-2 transition-all ${answers[currentQuestion]?.userAnswer === option\r\n                                        ? 'border-purple-500 bg-purple-50 dark:bg-purple-900/20'\r\n                                        : 'border-gray-200 dark:border-gray-700 hover:border-gray-300'\r\n                                        }`}\r\n                                >\r\n                                    <span className=\"font-semibold text-purple-600 mr-3\">\r\n                                        {String.fromCharCode(65 + index)}.\r\n                                    </span>\r\n                                    <span className=\"text-gray-700 dark:text-gray-300\">{option}</span>\r\n                                </button>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Navigation */}\r\n                    <div className=\"flex justify-between items-center\">\r\n                        <button\r\n                            onClick={() => setCurrentQuestion(Math.max(0, currentQuestion - 1))}\r\n                            disabled={currentQuestion === 0}\r\n                            className=\"px-4 py-2 border rounded hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                        >\r\n                            Previous\r\n                        </button>\r\n\r\n                        <div className=\"flex gap-2\">\r\n                            {currentQuestion < activeBattle.questions.length - 1 && (\r\n                                <button\r\n                                    onClick={nextQuestion}\r\n                                    disabled={!answers[currentQuestion]?.userAnswer}\r\n                                    className=\"px-6 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n                                >\r\n                                    Next\r\n                                </button>\r\n                            )}\r\n\r\n                            {currentQuestion === activeBattle.questions.length - 1 && (\r\n                                <button\r\n                                    onClick={submitBattle}\r\n                                    disabled={!allAnswered || submitting}\r\n                                    className=\"px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\r\n                                >\r\n                                    {submitting ? (\r\n                                        <>\r\n                                            <div className=\"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent\" />\r\n                                            Submitting...\r\n                                        </>\r\n                                    ) : (\r\n                                        <>\r\n                                            <Trophy size={18} />\r\n                                            Submit Battle\r\n                                        </>\r\n                                    )}\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Result View\r\n    if (view === 'result' && result) {\r\n        const passed = result.status === 'completed';\r\n\r\n        return (\r\n            <div className=\"max-w-2xl mx-auto p-6\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.8, y: 20 }}\r\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                    transition={{ duration: 0.5 }}\r\n                    className={`p-8 rounded-lg border-4 text-center relative overflow-hidden ${\r\n                        passed \r\n                            ? 'bg-gradient-to-br from-green-50 to-emerald-50 border-green-500' \r\n                            : 'bg-gradient-to-br from-red-50 to-orange-50 border-red-500'\r\n                    }`}\r\n                >\r\n                    {/* Confetti effect for victory */}\r\n                    {passed && (\r\n                        <div className=\"absolute inset-0 pointer-events-none\">\r\n                            {[...Array(20)].map((_, i) => (\r\n                                <motion.div\r\n                                    key={i}\r\n                                    initial={{ \r\n                                        x: '50%', \r\n                                        y: '50%', \r\n                                        opacity: 1,\r\n                                        scale: Math.random() * 0.5 + 0.5\r\n                                    }}\r\n                                    animate={{ \r\n                                        x: `${Math.random() * 100}%`, \r\n                                        y: `${Math.random() * 100}%`, \r\n                                        opacity: 0,\r\n                                        rotate: Math.random() * 360\r\n                                    }}\r\n                                    transition={{ duration: 2, delay: i * 0.1 }}\r\n                                    className=\"absolute w-3 h-3 rounded-full\"\r\n                                    style={{ \r\n                                        backgroundColor: ['#FFD700', '#FFA500', '#FF69B4', '#00CED1'][i % 4]\r\n                                    }}\r\n                                />\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n\r\n                    <motion.div\r\n                        animate={{ \r\n                            scale: passed ? [1, 1.2, 1] : [1, 0.9, 1],\r\n                            rotate: passed ? [0, 10, -10, 0] : 0\r\n                        }}\r\n                        transition={{ duration: 0.5 }}\r\n                    >\r\n                        {passed ? (\r\n                            <Trophy className=\"mx-auto mb-4 text-green-600\" size={64} />\r\n                        ) : (\r\n                            <XCircle className=\"mx-auto mb-4 text-red-600\" size={64} />\r\n                        )}\r\n                    </motion.div>\r\n\r\n                    <h2 className=\"text-3xl font-bold mb-4\">\r\n                        {passed ? 'Victory! ðŸŽ‰' : 'Defeat ðŸ˜”'}\r\n                    </h2>\r\n\r\n                    <div className=\"bg-white dark:bg-gray-800 rounded-lg p-6 mb-6 shadow-lg\">\r\n                        <p className=\"text-5xl font-bold mb-4 text-gray-900 dark:text-white\">\r\n                            {result.score}%\r\n                        </p>\r\n                        \r\n                        <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n                            <div className=\"text-center\">\r\n                                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Correct Answers</p>\r\n                                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                                    {result.correctAnswers}/{result.totalQuestions}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                                <p className=\"text-sm text-gray-600 dark:text-gray-400\">Pass Threshold</p>\r\n                                <p className=\"text-2xl font-bold text-gray-900 dark:text-white\">60%</p>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {passed && (\r\n                            <div className=\"space-y-3 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700\">\r\n                                <div className=\"flex items-center justify-between bg-green-50 dark:bg-green-900/20 p-3 rounded-lg\">\r\n                                    <span className=\"flex items-center gap-2 text-green-700 dark:text-green-400 font-medium\">\r\n                                        <Star size={20} />\r\n                                        XP Earned\r\n                                    </span>\r\n                                    <span className=\"text-xl font-bold text-green-700 dark:text-green-400\">\r\n                                        +{result.earnedXP}\r\n                                    </span>\r\n                                </div>\r\n                                \r\n                                <div className=\"flex items-center justify-between bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg\">\r\n                                    <span className=\"flex items-center gap-2 text-blue-700 dark:text-blue-400 font-medium\">\r\n                                        <TrendingUp size={20} />\r\n                                        Total XP\r\n                                    </span>\r\n                                    <span className=\"text-xl font-bold text-blue-700 dark:text-blue-400\">\r\n                                        {result.newXPTotal}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-center justify-between bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg\">\r\n                                    <span className=\"flex items-center gap-2 text-purple-700 dark:text-purple-400 font-medium\">\r\n                                        <Award size={20} />\r\n                                        Current Level\r\n                                    </span>\r\n                                    <span className=\"text-xl font-bold text-purple-700 dark:text-purple-400\">\r\n                                        {result.newLevel}\r\n                                        {result.leveledUp && (\r\n                                            <span className=\"ml-2 text-sm\">ðŸŽ‰ LEVEL UP!</span>\r\n                                        )}\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {result.earnedBadge && (\r\n                                    <div className=\"flex items-center justify-between bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-lg\">\r\n                                        <span className=\"flex items-center gap-2 text-yellow-700 dark:text-yellow-400 font-medium\">\r\n                                            <Sparkles size={20} />\r\n                                            New Badge\r\n                                        </span>\r\n                                        <span className=\"text-lg font-bold text-yellow-700 dark:text-yellow-400\">\r\n                                            {result.earnedBadge}\r\n                                        </span>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {result.revisionPlan && (\r\n                        <motion.div\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            transition={{ delay: 0.5 }}\r\n                            className=\"mt-6 p-4 bg-white dark:bg-gray-800 rounded-lg border shadow text-left\"\r\n                        >\r\n                            <h3 className=\"font-bold mb-3 flex items-center gap-2 text-gray-900 dark:text-white\">\r\n                                <Zap className=\"text-orange-500\" size={20} />\r\n                                AI Revision Plan\r\n                            </h3>\r\n                            <p className=\"text-sm text-gray-700 dark:text-gray-300 mb-3\">\r\n                                {result.revisionPlan.aiSuggestions}\r\n                            </p>\r\n                            {result.revisionPlan.recommendedTopics && (\r\n                                <div>\r\n                                    <p className=\"text-xs font-semibold text-gray-600 dark:text-gray-400 mb-2\">Focus Areas:</p>\r\n                                    <div className=\"flex flex-wrap gap-2\">\r\n                                        {result.revisionPlan.recommendedTopics.map((topic, i) => (\r\n                                            <span key={i} className=\"px-2 py-1 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded text-xs\">\r\n                                                {topic}\r\n                                            </span>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </motion.div>\r\n                    )}\r\n\r\n                    <button\r\n                        onClick={async () => {\r\n                            await fetchData();\r\n                            setView('list');\r\n                            setActiveBattle(null);\r\n                            setResult(null);\r\n                            setSubmitting(false);\r\n                        }}\r\n                        className=\"mt-6 px-8 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all shadow-lg font-medium flex items-center gap-2 mx-auto\"\r\n                    >\r\n                        <Swords size={20} />\r\n                        Return to Battles\r\n                    </button>\r\n\r\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-4 flex items-center justify-center gap-2\">\r\n                        <Clock size={14} />\r\n                        Auto-returning in a few seconds...\r\n                    </p>\r\n                </motion.div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // List View\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-indigo-900/20 py-8 px-4 custom-scrollbar overflow-y-auto\">\r\n            <div className=\"max-w-7xl mx-auto\">\r\n                {/* Header Section */}\r\n                <motion.div \r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className=\"mb-10 relative\"\r\n                >\r\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500/20 via-indigo-500/20 to-blue-500/20 blur-3xl -z-10\" />\r\n                    <div className=\"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-purple-200 dark:border-purple-500/30\">\r\n                        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n                            <div>\r\n                                <h1 className=\"text-xl font-black bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 bg-clip-text text-transparent mb-3 flex items-center gap-4\">\r\n                                    <Swords className=\"text-purple-600\" size={28} />\r\n                                    Boss Battles Arena\r\n                                </h1>\r\n                                <p className=\"text-sm text-gray-600 dark:text-gray-300 font-medium\">\r\n                                    Challenge your weaknesses â€¢ Earn XP â€¢ Level Up â€¢ Unlock Badges\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"flex gap-3\">\r\n                                <motion.button\r\n                                    whileHover={{ scale: 1.05 }}\r\n                                    whileTap={{ scale: 0.95 }}\r\n                                    onClick={() => window.location.reload()}\r\n                                    className=\"px-5 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold flex items-center gap-2\"\r\n                                >\r\n                                    <svg className=\"w-5 h-5\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                                        <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                                        <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                                    </svg>\r\n                                    Refresh\r\n                                </motion.button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Stats Overview */}\r\n                <motion.div \r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.1 }}\r\n                    className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10\"\r\n                >\r\n                    <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl p-6 text-white shadow-xl\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <Swords size={24} className=\"opacity-80\" />\r\n                            <span className=\"text-2xl font-black\">{battles.length}</span>\r\n                        </div>\r\n                        <p className=\"text-purple-100 font-semibold text-sm\">Active Battles</p>\r\n                    </div>\r\n                    <div className=\"bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-2xl p-6 text-white shadow-xl\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <Trophy size={24} className=\"opacity-80\" />\r\n                            <span className=\"text-2xl font-black\">{history.filter(h => h.status === 'completed').length}</span>\r\n                        </div>\r\n                        <p className=\"text-indigo-100 font-semibold text-sm\">Victories</p>\r\n                    </div>\r\n                    <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl p-6 text-white shadow-xl\">\r\n                        <div className=\"flex items-center justify-between mb-2\">\r\n                            <Star size={24} className=\"opacity-80\" />\r\n                            <span className=\"text-2xl font-black\">{history.reduce((sum, h) => sum + (h.earnedXP || 0), 0)}</span>\r\n                        </div>\r\n                        <p className=\"text-blue-100 font-semibold text-sm\">Total XP Earned</p>\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Active Battles */}\r\n                <div className=\"mb-8 active-battles\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\r\n                        <Swords className=\"text-purple-600\" size={28} />\r\n                        Active Battles\r\n                    </h2>\r\n\r\n                    {battles.length === 0 ? (\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center\">\r\n                            <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full mb-4\">\r\n                                <Swords className=\"text-gray-400\" size={32} />\r\n                            </div>\r\n                            <h3 className=\"text-xl font-semibold text-gray-900 dark:text-white mb-2\">\r\n                                No active battles\r\n                            </h3>\r\n                            <p className=\"text-gray-600 dark:text-gray-400\">\r\n                                New battles are generated daily at 10 AM\r\n                            </p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                            {battles.map((battle) => (\r\n                                <div\r\n                                    key={battle.battleId}\r\n                                    className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden group cursor-pointer\"\r\n                                    onClick={() => startBattle(battle)}\r\n                                >\r\n                                    {/* Battle Header */}\r\n                                    <div className=\"bg-gradient-to-r from-purple-600 to-indigo-600 p-4\">\r\n                                        <div className=\"flex items-center justify-between mb-2\">\r\n                                            <span className={`px-3 py-1 rounded-full text-xs font-semibold border ${getDifficultyColor(battle.difficulty)}`}>\r\n                                                {getDifficultyIcon(battle.difficulty)} {battle.difficulty.toUpperCase()}\r\n                                            </span>\r\n                                            <div className=\"flex items-center gap-1 text-yellow-300 font-bold\">\r\n                                                <Trophy size={18} />\r\n                                                <span>{battle.xpReward || 40} XP</span>\r\n                                            </div>\r\n                                        </div>\r\n                                        <h3 className=\"text-lg font-bold text-white\">\r\n                                            {battle.targetWeakness}\r\n                                        </h3>\r\n                                    </div>\r\n\r\n                                    {/* Battle Content */}\r\n                                    <div className=\"p-4\">\r\n                                        <div className=\"flex items-center justify-between mb-4 text-sm\">\r\n                                            <span className=\"text-gray-600 dark:text-gray-400\">\r\n                                                {battle.totalQuestions} Questions\r\n                                            </span>\r\n                                            <span className=\"text-gray-500 dark:text-gray-400 text-xs\">\r\n                                                Expires: {new Date(battle.expiresAt).toLocaleDateString()}\r\n                                            </span>\r\n                                        </div>\r\n\r\n                                        {/* Action Button */}\r\n                                        <button\r\n                                            className=\"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300 transform group-hover:scale-105 flex items-center justify-center gap-2\"\r\n                                        >\r\n                                            <Swords size={18} />\r\n                                            Start Battle\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Battle History */}\r\n                <div className=\"battle-history\">\r\n                    <h2 className=\"text-2xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\r\n                        <Trophy className=\"text-purple-600\" size={28} />\r\n                        Battle History\r\n                    </h2>\r\n\r\n                    {history.length === 0 ? (\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-12 text-center\">\r\n                            <p className=\"text-gray-500 dark:text-gray-400\">No battles completed yet</p>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6\">\r\n                            <div className=\"space-y-3\">\r\n                                {history.map((battle) => (\r\n                                    <div\r\n                                        key={battle.battleId}\r\n                                        className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 flex justify-between items-center hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors\"\r\n                                    >\r\n                                        <div>\r\n                                            <p className=\"font-semibold text-gray-900 dark:text-white\">{battle.targetWeakness}</p>\r\n                                            <p className=\"text-sm text-gray-500 dark:text-gray-400\">\r\n                                                {new Date(battle.completedAt).toLocaleDateString()}\r\n                                            </p>\r\n                                        </div>\r\n                                        <div className=\"text-right flex items-center gap-3\">\r\n                                            {battle.status === 'completed' ? (\r\n                                                <CheckCircle className=\"text-green-600\" size={24} />\r\n                                            ) : (\r\n                                                <XCircle className=\"text-red-600\" size={24} />\r\n                                            )}\r\n                                            <div>\r\n                                                <span className=\"font-bold text-xl text-gray-900 dark:text-white\">{battle.score}%</span>\r\n                                                {battle.earnedXP > 0 && (\r\n                                                    <p className=\"text-sm text-green-600 font-medium\">+{battle.earnedXP} XP</p>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BossBattles;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\BountyCreditsPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[353,360],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'submittingBounty' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":38,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"submittingBounty"},"fix":{"range":[1483,1499],"text":""},"desc":"Remove unused variable 'submittingBounty'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setSubmittingBounty' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":38,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":38,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"setSubmittingBounty"},"fix":{"range":[1499,1520],"text":""},"desc":"Remove unused variable 'setSubmittingBounty'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchData'. Either include it or remove the dependency array.","line":47,"column":8,"nodeType":"ArrayExpression","endLine":47,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchData]","fix":{"range":[1881,1883],"text":"[fetchData]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":94,"column":23,"nodeType":"Identifier","messageId":"unusedVar","endLine":94,"endColumn":24,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[3751,3752],"text":""},"desc":"Remove unused variable 't'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'handleBountyComplete' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":134,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":134,"endColumn":31,"suggestions":[{"messageId":"removeVar","data":{"varName":"handleBountyComplete"},"fix":{"range":[5558,8233],"text":""},"desc":"Remove unused variable 'handleBountyComplete'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":137,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":137,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[5722,5723],"text":""},"desc":"Remove unused variable 't'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'getDifficultyColor' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":190,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":190,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"getDifficultyColor"},"fix":{"range":[8241,8655],"text":""},"desc":"Remove unused variable 'getDifficultyColor'."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/gamification/BountyCreditsPage.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { Target, Award, TrendingUp, Clock, CheckCircle, Coins, Sparkles, Star, ArrowLeft } from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst apiClient = axios.create({\r\n    baseURL: import.meta.env.VITE_API_BASE_URL || \"http://localhost:2000\",\r\n});\r\n\r\napiClient.interceptors.request.use((config) => {\r\n    const token = localStorage.getItem(\"authToken\");\r\n    if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    // Prevent caching to always get fresh data\r\n    config.headers['Cache-Control'] = 'no-cache, no-store, must-revalidate';\r\n    config.headers['Pragma'] = 'no-cache';\r\n    config.headers['Expires'] = '0';\r\n    // Add timestamp to bypass browser/proxy cache\r\n    const separator = config.url.includes('?') ? '&' : '?';\r\n    config.url = `${config.url}${separator}_t=${Date.now()}`;\r\n    return config;\r\n});\r\n\r\nfunction BountyCreditsPage() {\r\n    const navigate = useNavigate();\r\n    const [bounties, setBounties] = useState([]);\r\n    const [credits, setCredits] = useState(0);\r\n    const [stats, setStats] = useState({\r\n        bountiesCompleted: 0,\r\n        totalEarned: 0,\r\n        transactions: 0\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [submittingBounty, setSubmittingBounty] = useState(null);\r\n    const [showLevelUp, setShowLevelUp] = useState(false);\r\n    const [levelUpData, setLevelUpData] = useState(null);\r\n\r\n    useEffect(() => {\r\n        fetchData();\r\n        // Auto-refresh every 30 seconds to keep data current\r\n        const interval = setInterval(fetchData, 30000);\r\n        return () => clearInterval(interval);\r\n    }, []);\r\n\r\n    const fetchData = async (force = false) => {\r\n        try {\r\n            if (force || !loading) setLoading(true);\r\n\r\n            // Force fresh data by adding random cache buster\r\n            const cacheBuster = `_refresh=${Date.now()}_${Math.random()}`;\r\n\r\n            const [bountiesRes, profileRes] = await Promise.all([\r\n                apiClient.get(`/gamification/bounties?${cacheBuster}`),\r\n                apiClient.get(`/gamification/profile?${cacheBuster}`)\r\n            ]);\r\n\r\n            console.log('[BountyCreditsPage] Fresh data loaded:', {\r\n                credits: profileRes.data.learningCredits,\r\n                bounties: bountiesRes.data.bounties?.length\r\n            });\r\n\r\n            setBounties(bountiesRes.data.bounties || []);\r\n            setCredits(profileRes.data.learningCredits || 0);\r\n\r\n            // Calculate stats from credits history\r\n            const creditsHistory = profileRes.data.creditsHistory || [];\r\n            const completed = creditsHistory.filter(h => h.reason === 'bounty_completed').length;\r\n            const totalEarned = creditsHistory\r\n                .filter(h => h.reason === 'bounty_completed')\r\n                .reduce((sum, h) => sum + h.amount, 0);\r\n\r\n            setStats({\r\n                bountiesCompleted: completed,\r\n                totalEarned: totalEarned,\r\n                transactions: creditsHistory.length\r\n            });\r\n        } catch (error) {\r\n            console.error('[BountyCreditsPage] Error fetching data:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleSubmitBounty = async (bountyId) => {\r\n        // Find the bounty details\r\n        const bounty = bounties.find(b => b.bountyId === bountyId);\r\n        if (!bounty) return;\r\n\r\n        // Show a custom toast notification with bounty details\r\n        toast.custom((t) => (\r\n            <motion.div\r\n                initial={{ opacity: 0, y: -20, scale: 0.8 }}\r\n                animate={{ opacity: 1, y: 0, scale: 1 }}\r\n                exit={{ opacity: 0, y: -20, scale: 0.8 }}\r\n                className=\"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-4 rounded-lg shadow-2xl max-w-md\"\r\n            >\r\n                <div className=\"flex items-start gap-3\">\r\n                    <Target className=\"flex-shrink-0 mt-1\" size={24} />\r\n                    <div>\r\n                        <h3 className=\"font-bold text-lg mb-1\">Bounty Challenge Started!</h3>\r\n                        <p className=\"text-sm opacity-90 mb-2\">{bounty.questionText.substring(0, 100)}...</p>\r\n                        <div className=\"flex items-center gap-3 text-sm\">\r\n                            <span className=\"flex items-center gap-1\">\r\n                                <Coins size={16} />\r\n                                {bounty.creditReward} Credits\r\n                            </span>\r\n                            <span className=\"flex items-center gap-1\">\r\n                                <Star size={16} />\r\n                                {bounty.xpBonus} XP\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </motion.div>\r\n        ), { duration: 3000 });\r\n\r\n        // Navigate to chat with the bounty question\r\n        navigate('/', {\r\n            state: {\r\n                bountyQuestion: bounty.questionText,\r\n                bountyId: bountyId,\r\n                bountyCredits: bounty.creditReward,\r\n                bountyXP: bounty.xpBonus,\r\n                bountyTopic: bounty.topic,\r\n                bountyDifficulty: bounty.difficulty\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleBountyComplete = async (result) => {\r\n        if (result.isCorrect) {\r\n            // Show success notification with rewards\r\n            toast.custom((t) => (\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    className=\"bg-gradient-to-br from-green-500 to-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl\"\r\n                >\r\n                    <div className=\"flex items-start gap-3\">\r\n                        <CheckCircle className=\"flex-shrink-0\" size={32} />\r\n                        <div>\r\n                            <h3 className=\"font-bold text-xl mb-2\">Bounty Completed! ðŸŽ‰</h3>\r\n                            <div className=\"space-y-1\">\r\n                                <p className=\"flex items-center gap-2\">\r\n                                    <Coins size={18} />\r\n                                    <span className=\"font-semibold\">+{result.creditsAwarded} Credits</span>\r\n                                    <span className=\"text-sm opacity-80\">(Total: {result.newCreditsBalance})</span>\r\n                                </p>\r\n                                <p className=\"flex items-center gap-2\">\r\n                                    <Star size={18} />\r\n                                    <span className=\"font-semibold\">+{result.xpAwarded} XP</span>\r\n                                    <span className=\"text-sm opacity-80\">(Total: {result.newXPTotal})</span>\r\n                                </p>\r\n                                <p className=\"flex items-center gap-2\">\r\n                                    <Award size={18} />\r\n                                    <span className=\"font-semibold\">Level {result.newLevel}</span>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            ), { duration: 5000 });\r\n\r\n            // Check for level up\r\n            if (result.leveledUp) {\r\n                setLevelUpData(result);\r\n                setShowLevelUp(true);\r\n                setTimeout(() => setShowLevelUp(false), 5000);\r\n            }\r\n\r\n            // Update local state with new values\r\n            setCredits(result.newCreditsBalance);\r\n\r\n            // Refresh data\r\n            fetchData();\r\n        } else {\r\n            // Show failure notification\r\n            toast.error(`Incorrect answer. ${result.explanation}`, {\r\n                duration: 4000,\r\n                icon: 'âŒ'\r\n            });\r\n        }\r\n    };\r\n\r\n    const getDifficultyColor = (difficulty) => {\r\n        const colors = {\r\n            easy: 'bg-green-100 text-green-700 border-green-300',\r\n            medium: 'bg-yellow-100 text-yellow-700 border-yellow-300',\r\n            hard: 'bg-orange-100 text-orange-700 border-orange-300',\r\n            expert: 'bg-red-100 text-red-700 border-red-300'\r\n        };\r\n        return colors[difficulty] || colors.medium;\r\n    };\r\n\r\n    const getDifficultyIcon = (difficulty) => {\r\n        const icons = {\r\n            easy: 'â­',\r\n            medium: 'â­â­',\r\n            hard: 'â­â­â­',\r\n            expert: 'â­â­â­â­'\r\n        };\r\n        return icons[difficulty] || icons.medium;\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center\">\r\n                <div className=\"animate-spin rounded-full h-16 w-16 border-b-4 border-purple-600\"></div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-br from-purple-50 via-indigo-50 to-blue-50 dark:from-gray-900 dark:via-purple-900/20 dark:to-indigo-900/20 py-8 px-4 custom-scrollbar overflow-y-auto\">\r\n            {/* Level Up Animation */}\r\n            <AnimatePresence>\r\n                {showLevelUp && levelUpData && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm\"\r\n                        onClick={() => setShowLevelUp(false)}\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0, rotate: -180 }}\r\n                            animate={{ scale: 1, rotate: 0 }}\r\n                            exit={{ scale: 0, rotate: 180 }}\r\n                            transition={{ type: 'spring', duration: 0.8 }}\r\n                            className=\"bg-gradient-to-br from-yellow-400 via-orange-500 to-red-500 p-8 rounded-2xl shadow-2xl text-center\"\r\n                            onClick={(e) => e.stopPropagation()}\r\n                        >\r\n                            <motion.div\r\n                                animate={{\r\n                                    scale: [1, 1.2, 1],\r\n                                    rotate: [0, 360]\r\n                                }}\r\n                                transition={{\r\n                                    duration: 2,\r\n                                    repeat: Infinity,\r\n                                    repeatType: 'loop'\r\n                                }}\r\n                                className=\"mb-4\"\r\n                            >\r\n                                <Sparkles className=\"mx-auto text-white\" size={64} />\r\n                            </motion.div>\r\n                            <h2 className=\"text-4xl font-bold text-white mb-2\">LEVEL UP!</h2>\r\n                            <p className=\"text-6xl font-black text-white mb-4\">{levelUpData.newLevel}</p>\r\n                            <p className=\"text-white text-lg\">You're getting stronger! ðŸ’ª</p>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n\r\n            <div className=\"max-w-7xl mx-auto\">\r\n                {/* Header Section */}\r\n                <motion.div \r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    className=\"mb-10 relative\"\r\n                >\r\n                    <div className=\"absolute inset-0 bg-gradient-to-r from-purple-500/20 via-indigo-500/20 to-blue-500/20 blur-3xl -z-10\" />\r\n                    <div className=\"bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-purple-200 dark:border-purple-500/30\">\r\n                        <div className=\"flex items-center justify-between flex-wrap gap-4\">\r\n                            <div>\r\n                                <h1 className=\"text-xl font-black bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 bg-clip-text text-transparent mb-3 flex items-center gap-4\">\r\n                                    <Target className=\"text-purple-600\" size={24} />\r\n                                    Bounty Questions Arena\r\n                                </h1>\r\n                                <p className=\"text-sm text-gray-600 dark:text-gray-300 font-medium\">\r\n                                    Complete challenges â€¢ Earn credits â€¢ Unlock premium content\r\n                                </p>\r\n                            </div>\r\n                            <motion.button\r\n                                whileHover={{ scale: 1.05 }}\r\n                                whileTap={{ scale: 0.95 }}\r\n                                onClick={() => fetchData(true)}\r\n                                className=\"px-5 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold flex items-center gap-2\"\r\n                                title=\"Refresh credits data\"\r\n                            >\r\n                                <svg className=\"w-5 h-5 animate-spin\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\r\n                                </svg>\r\n                                Refresh\r\n                            </motion.button>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Credits Overview Card */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.1 }}\r\n                    className=\"bg-gradient-to-br from-white to-purple-50 dark:from-gray-800 dark:to-purple-900/20 rounded-2xl shadow-xl p-8 mb-10 border-2 border-purple-200 dark:border-purple-500/30\"\r\n                >\r\n                    <div className=\"flex items-center justify-between mb-8 flex-wrap gap-4\">\r\n                        <div className=\"flex items-center gap-4\">\r\n                            <div className=\"bg-gradient-to-br from-yellow-400 via-orange-500 to-yellow-600 p-3 rounded-2xl shadow-lg\">\r\n                                <Coins className=\"text-white\" size={24} />\r\n                            </div>\r\n                            <div>\r\n                                <h2 className=\"text-2xl font-black text-gray-900 dark:text-white\">\r\n                                    {credits}\r\n                                </h2>\r\n                                <p className=\"text-xs text-gray-600 dark:text-gray-400 font-semibold\">Learning Credits</p>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"text-sm text-gray-600 dark:text-gray-400 bg-white dark:bg-gray-700 px-4 py-2 rounded-full\">\r\n                            ðŸ’Ž Unlock premium features with credits\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Stats Grid */}\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                        <div className=\"bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl p-5 text-white shadow-lg\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                                <Award size={18} />\r\n                                <span className=\"text-xs opacity-90 font-semibold\">Completed</span>\r\n                            </div>\r\n                            <div className=\"text-xl font-black\">{stats.bountiesCompleted}</div>\r\n                        </div>\r\n                        <div className=\"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl p-5 text-white shadow-lg\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                                <TrendingUp size={18} />\r\n                                <span className=\"text-xs opacity-90 font-semibold\">Total Earned</span>\r\n                            </div>\r\n                            <div className=\"text-xl font-black\">{stats.totalEarned}</div>\r\n                        </div>\r\n                        <div className=\"bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl p-5 text-white shadow-lg\">\r\n                            <div className=\"flex items-center gap-2 mb-2\">\r\n                                <Clock size={18} />\r\n                                <span className=\"text-xs opacity-90 font-semibold\">Transactions</span>\r\n                            </div>\r\n                            <div className=\"text-xl font-black\">{stats.transactions}</div>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Bounties Section */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.2 }}\r\n                >\r\n                    <div className=\"flex items-center justify-between mb-6\">\r\n                        <h2 className=\"text-lg font-black text-gray-900 dark:text-white flex items-center gap-3\">\r\n                            <div className=\"p-3 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl\">\r\n                                <Target className=\"text-white\" size={20} />\r\n                            </div>\r\n                            Active Bounties\r\n                        </h2>\r\n                        {bounties.length > 0 && (\r\n                            <span className=\"px-4 py-2 bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 rounded-full font-bold\">\r\n                                {bounties.length} Available\r\n                            </span>\r\n                        )}\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {bounties.length === 0 ? (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, scale: 0.9 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        className=\"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-2xl shadow-xl p-16 text-center border-2 border-dashed border-gray-300 dark:border-gray-600\"\r\n                    >\r\n                        <div className=\"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-purple-100 to-indigo-100 dark:from-purple-900/30 dark:to-indigo-900/30 rounded-full mb-6\">\r\n                            <Target className=\"text-purple-600 dark:text-purple-400\" size={40} />\r\n                        </div>\r\n                        <h3 className=\"text-base font-bold text-gray-900 dark:text-white mb-3\">\r\n                            No Active Bounties\r\n                        </h3>\r\n                        <p className=\"text-gray-600 dark:text-gray-400 text-xs mb-4\">\r\n                            New bounty questions are generated daily at 9:00 AM\r\n                        </p>\r\n                        <p className=\"text-sm text-gray-500 dark:text-gray-500\">\r\n                            Check back tomorrow for new challenges!\r\n                        </p>\r\n                    </motion.div>\r\n                ) : (\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                        {bounties.map((bounty, index) => (\r\n                            <motion.div\r\n                                key={bounty._id}\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: index * 0.1 }}\r\n                                whileHover={{ y: -8, scale: 1.02 }}\r\n                                className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 overflow-hidden group cursor-pointer border-2 border-transparent hover:border-purple-500\"\r\n                            >\r\n                                {/* Bounty Header */}\r\n                                <div className=\"relative bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 p-6 overflow-hidden\">\r\n                                    {/* Animated background pattern */}\r\n                                    <div className=\"absolute inset-0 opacity-20\">\r\n                                        <div className=\"absolute top-0 left-0 w-40 h-40 bg-white rounded-full blur-3xl\"></div>\r\n                                        <div className=\"absolute bottom-0 right-0 w-32 h-32 bg-white rounded-full blur-2xl\"></div>\r\n                                    </div>\r\n                                    \r\n                                    <div className=\"relative z-10\">\r\n                                        <div className=\"flex items-center justify-between mb-3\">\r\n                                            <span className={`px-2.5 py-1 rounded-full text-xs font-bold uppercase tracking-wide shadow-lg backdrop-blur-sm bg-white/90 dark:bg-gray-900/90 ${\r\n                                                bounty.difficulty === 'easy' ? 'text-green-600' :\r\n                                                bounty.difficulty === 'medium' ? 'text-yellow-600' :\r\n                                                bounty.difficulty === 'hard' ? 'text-orange-600' :\r\n                                                'text-red-600'\r\n                                            }`}>\r\n                                                {getDifficultyIcon(bounty.difficulty)} {bounty.difficulty}\r\n                                            </span>\r\n                                            <motion.div\r\n                                                whileHover={{ scale: 1.1, rotate: 5 }}\r\n                                                className=\"flex items-center gap-1.5 bg-yellow-400 text-yellow-900 px-2.5 py-1 rounded-full font-black text-xs shadow-lg\"\r\n                                            >\r\n                                                <Coins size={14} />\r\n                                                <span>+{bounty.creditReward}</span>\r\n                                            </motion.div>\r\n                                        </div>\r\n                                        <h3 className=\"text-sm font-black text-white mb-2 line-clamp-1 drop-shadow-lg\">\r\n                                            {bounty.topic}\r\n                                        </h3>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Bounty Content */}\r\n                                <div className=\"p-5\">\r\n                                    <p className=\"text-sm text-gray-700 dark:text-gray-300 mb-4 line-clamp-3 leading-relaxed\">\r\n                                        {bounty.questionText}\r\n                                    </p>\r\n\r\n                                    {bounty.knowledgeGap && (\r\n                                        <div className=\"bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/30 dark:to-indigo-900/30 rounded-xl p-3 mb-4 border border-purple-200 dark:border-purple-500/30\">\r\n                                            <p className=\"text-xs text-purple-700 dark:text-purple-300 font-semibold flex items-start gap-2\">\r\n                                                <span className=\"text-base\">ðŸ’¡</span>\r\n                                                <span>{bounty.knowledgeGap}</span>\r\n                                            </p>\r\n                                        </div>\r\n                                    )}\r\n\r\n                                    {/* Rewards Info */}\r\n                                    <div className=\"flex items-center justify-between mb-4 text-sm\">\r\n                                        <div className=\"flex items-center gap-2 text-green-600 dark:text-green-400 font-semibold\">\r\n                                            <Star size={16} />\r\n                                            <span>+{bounty.xpBonus} XP</span>\r\n                                        </div>\r\n                                        <div className=\"text-gray-500 dark:text-gray-400 text-xs flex items-center gap-1\">\r\n                                            <Clock size={14} />\r\n                                            {new Date(bounty.expiresAt).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Action Button */}\r\n                                    <motion.button\r\n                                        whileHover={{ scale: 1.05 }}\r\n                                        whileTap={{ scale: 0.95 }}\r\n                                        onClick={() => handleSubmitBounty(bounty.bountyId)}\r\n                                        className=\"w-full bg-gradient-to-r from-purple-600 via-indigo-600 to-blue-600 hover:from-purple-700 hover:via-indigo-700 hover:to-blue-700 text-white font-bold py-3 px-4 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center gap-3 group\"\r\n                                    >\r\n                                        <Target size={16} className=\"group-hover:rotate-12 transition-transform\" />\r\n                                        <span className=\"text-sm\">Attempt Challenge</span>\r\n                                        <span className=\"opacity-0 group-hover:opacity-100 transition-opacity\">â†’</span>\r\n                                    </motion.button>\r\n                                </div>\r\n\r\n                                {/* Hover glow effect */}\r\n                                <div className=\"absolute inset-0 bg-gradient-to-t from-purple-600/0 via-purple-600/0 to-purple-600/5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none\"></div>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Info Section */}\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.3 }}\r\n                    className=\"mt-10 bg-gradient-to-br from-purple-50 to-indigo-50 dark:from-gray-800/50 dark:to-purple-900/20 rounded-2xl p-8 border-2 border-purple-200 dark:border-purple-500/30 shadow-lg\"\r\n                >\r\n                    <h3 className=\"text-base font-black text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\r\n                        <Sparkles className=\"text-purple-600\" size={20} />\r\n                        How Bounty Questions Work\r\n                    </h3>\r\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                        <div className=\"flex items-start gap-3 bg-white dark:bg-gray-700/50 rounded-xl p-4\">\r\n                            <CheckCircle className=\"text-green-600 mt-0.5 flex-shrink-0\" size={18} />\r\n                            <span className=\"text-xs text-gray-700 dark:text-gray-300 font-medium\">Complete bounty challenges to earn learning credits</span>\r\n                        </div>\r\n                        <div className=\"flex items-start gap-3 bg-white dark:bg-gray-700/50 rounded-xl p-4\">\r\n                            <CheckCircle className=\"text-green-600 mt-0.5 flex-shrink-0\" size={18} />\r\n                            <span className=\"text-xs text-gray-700 dark:text-gray-300 font-medium\">Higher difficulty questions award more credits and XP</span>\r\n                        </div>\r\n                        <div className=\"flex items-start gap-3 bg-white dark:bg-gray-700/50 rounded-xl p-4\">\r\n                            <CheckCircle className=\"text-green-600 mt-0.5 flex-shrink-0\" size={18} />\r\n                            <span className=\"text-xs text-gray-700 dark:text-gray-300 font-medium\">New bounties are generated daily at 9:00 AM</span>\r\n                        </div>\r\n                        <div className=\"flex items-start gap-3 bg-white dark:bg-gray-700/50 rounded-xl p-4\">\r\n                            <CheckCircle className=\"text-green-600 mt-0.5 flex-shrink-0\" size={18} />\r\n                            <span className=\"text-xs text-gray-700 dark:text-gray-300 font-medium\">Use credits to unlock premium features and content</span>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default BountyCreditsPage;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\EnergyBar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\LevelBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\RankBadge.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillAssessmentModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[62,69],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchQuestions'. Either include it or remove the dependency array.","line":18,"column":8,"nodeType":"ArrayExpression","endLine":18,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [fetchQuestions, skill]","fix":{"range":[797,804],"text":"[fetchQuestions, skill]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, CheckCircle2, XCircle, Loader, TrendingUp, Award, Zap } from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SkillAssessmentModal = ({ skill, onClose, onSuccess }) => {\r\n    const [questions, setQuestions] = useState([]);\r\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n    const [userAnswers, setUserAnswers] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [submitting, setSubmitting] = useState(false);\r\n    const [result, setResult] = useState(null);\r\n    const [showResults, setShowResults] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchQuestions();\r\n    }, [skill]);\r\n\r\n    const fetchQuestions = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.get(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill/${skill.skillId}/assessment`,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setQuestions(response.data.questions || []);\r\n            setUserAnswers(new Array(response.data.questions?.length || 0).fill(null));\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('[SkillAssessment] Error fetching questions:', error);\r\n            toast.error('Failed to load assessment questions');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleAnswerSelect = (answer) => {\r\n        const newAnswers = [...userAnswers];\r\n        newAnswers[currentQuestionIndex] = answer;\r\n        setUserAnswers(newAnswers);\r\n    };\r\n\r\n    const handleNext = () => {\r\n        if (currentQuestionIndex < questions.length - 1) {\r\n            setCurrentQuestionIndex(currentQuestionIndex + 1);\r\n        }\r\n    };\r\n\r\n    const handlePrevious = () => {\r\n        if (currentQuestionIndex > 0) {\r\n            setCurrentQuestionIndex(currentQuestionIndex - 1);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async () => {\r\n        if (userAnswers.some(answer => answer === null)) {\r\n            toast.error('Please answer all questions before submitting');\r\n            return;\r\n        }\r\n\r\n        try {\r\n            setSubmitting(true);\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill/${skill.skillId}/assessment`,\r\n                { answers: userAnswers },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n\r\n            setResult(response.data);\r\n            setShowResults(true);\r\n\r\n            // Show success message\r\n            if (response.data.justMastered) {\r\n                toast.success('ðŸŽ‰ Skill Mastered! Great progress!');\r\n            } else {\r\n                toast.success(`Assessment completed! Score: ${response.data.score}%`);\r\n            }\r\n\r\n            // Call callback after a delay\r\n            setTimeout(() => {\r\n                onSuccess?.(response.data);\r\n            }, 3000);\r\n\r\n        } catch (error) {\r\n            console.error('[SkillAssessment] Error submitting assessment:', error);\r\n            toast.error('Failed to submit assessment');\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <motion.div\r\n                className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                onClick={onClose}\r\n            >\r\n                <motion.div\r\n                    className=\"bg-slate-900 rounded-lg p-8 w-full max-w-2xl border border-slate-700\"\r\n                    initial={{ scale: 0.9, opacity: 0 }}\r\n                    animate={{ scale: 1, opacity: 1 }}\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    <div className=\"flex items-center justify-center gap-3\">\r\n                        <Loader className=\"w-6 h-6 text-blue-400 animate-spin\" />\r\n                        <p className=\"text-slate-300\">Loading assessment questions...</p>\r\n                    </div>\r\n                </motion.div>\r\n            </motion.div>\r\n        );\r\n    }\r\n\r\n    if (showResults) {\r\n        const passed = result.score >= skill.masteryThreshold;\r\n        const correct = result.results.filter(r => r.isCorrect).length;\r\n\r\n        return (\r\n            <motion.div\r\n                className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                onClick={onClose}\r\n            >\r\n                <motion.div\r\n                    className=\"bg-gradient-to-b from-slate-900 to-slate-800 rounded-lg w-full max-w-2xl border border-slate-700 overflow-hidden\"\r\n                    initial={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                    animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    {/* Header */}\r\n                    <div className={`p-6 text-center border-b border-slate-700 ${\r\n                        passed ? 'bg-green-900/20' : 'bg-amber-900/20'\r\n                    }`}>\r\n                        <motion.div\r\n                            className=\"flex justify-center mb-4\"\r\n                            initial={{ scale: 0 }}\r\n                            animate={{ scale: 1 }}\r\n                            transition={{ delay: 0.2, type: 'spring', stiffness: 150 }}\r\n                        >\r\n                            {passed ? (\r\n                                <CheckCircle2 className=\"w-16 h-16 text-green-400\" />\r\n                            ) : (\r\n                                <TrendingUp className=\"w-16 h-16 text-amber-400\" />\r\n                            )}\r\n                        </motion.div>\r\n                        <h2 className=\"text-2xl font-bold text-slate-100 mb-2\">\r\n                            {passed ? 'ðŸŽ‰ Excellent Work!' : 'ðŸ“Š Assessment Complete'}\r\n                        </h2>\r\n                        <p className=\"text-slate-400\">\r\n                            {passed ? 'You\\'ve mastered this skill!' : 'Keep practicing to improve!'}\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Results */}\r\n                    <div className=\"p-6 space-y-6\">\r\n                        {/* Score Display */}\r\n                        <div className=\"grid grid-cols-3 gap-4\">\r\n                            <motion.div\r\n                                className=\"bg-slate-800 rounded-lg p-4 text-center border border-slate-700\"\r\n                                initial={{ x: -20, opacity: 0 }}\r\n                                animate={{ x: 0, opacity: 1 }}\r\n                                transition={{ delay: 0.1 }}\r\n                            >\r\n                                <p className=\"text-slate-400 text-sm\">Score</p>\r\n                                <p className=\"text-3xl font-bold text-blue-400 mt-2\">{result.score}%</p>\r\n                            </motion.div>\r\n                            <motion.div\r\n                                className=\"bg-slate-800 rounded-lg p-4 text-center border border-slate-700\"\r\n                                initial={{ y: 20, opacity: 0 }}\r\n                                animate={{ y: 0, opacity: 1 }}\r\n                                transition={{ delay: 0.2 }}\r\n                            >\r\n                                <p className=\"text-slate-400 text-sm\">Correct</p>\r\n                                <p className=\"text-3xl font-bold text-green-400 mt-2\">\r\n                                    {correct}/{questions.length}\r\n                                </p>\r\n                            </motion.div>\r\n                            <motion.div\r\n                                className=\"bg-slate-800 rounded-lg p-4 text-center border border-slate-700\"\r\n                                initial={{ x: 20, opacity: 0 }}\r\n                                animate={{ x: 0, opacity: 1 }}\r\n                                transition={{ delay: 0.3 }}\r\n                            >\r\n                                <p className=\"text-slate-400 text-sm\">Mastery</p>\r\n                                <p className=\"text-3xl font-bold text-cyan-400 mt-2\">\r\n                                    {result.newMastery}%\r\n                                </p>\r\n                            </motion.div>\r\n                        </div>\r\n\r\n                        {/* Mastery Progress */}\r\n                        <div>\r\n                            <p className=\"text-sm font-semibold text-slate-300 mb-2\">\r\n                                Skill Mastery Progress\r\n                            </p>\r\n                            <div className=\"w-full h-3 bg-slate-700 rounded-full overflow-hidden\">\r\n                                <motion.div\r\n                                    className=\"h-full bg-gradient-to-r from-blue-500 to-cyan-400\"\r\n                                    initial={{ width: 0 }}\r\n                                    animate={{ width: `${result.newMastery}%` }}\r\n                                    transition={{ duration: 1, delay: 0.3 }}\r\n                                />\r\n                            </div>\r\n                            <p className=\"text-xs text-slate-400 mt-2\">\r\n                                {result.newMastery >= skill.masteryThreshold\r\n                                    ? 'âœ“ Mastery Unlocked!'\r\n                                    : `Need ${skill.masteryThreshold - result.newMastery}% more for mastery`}\r\n                            </p>\r\n                        </div>\r\n\r\n                        {/* New Unlocks */}\r\n                        {result.newlyUnlocked && result.newlyUnlocked.length > 0 && (\r\n                            <div className=\"bg-green-900/20 border border-green-700 rounded-lg p-4\">\r\n                                <p className=\"text-sm font-semibold text-green-300 flex items-center gap-2 mb-3\">\r\n                                    <Award className=\"w-4 h-4\" />\r\n                                    New Skills Unlocked!\r\n                                </p>\r\n                                <div className=\"space-y-1\">\r\n                                    {result.newlyUnlocked.map(skillId => (\r\n                                        <motion.p\r\n                                            key={skillId}\r\n                                            className=\"text-sm text-green-200\"\r\n                                            initial={{ opacity: 0, x: -10 }}\r\n                                            animate={{ opacity: 1, x: 0 }}\r\n                                        >\r\n                                            âœ“ {skillId}\r\n                                        </motion.p>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* Question Review */}\r\n                        <div className=\"max-h-64 overflow-y-auto\">\r\n                            <p className=\"text-sm font-semibold text-slate-300 mb-3\">Review</p>\r\n                            <div className=\"space-y-2\">\r\n                                {result.results.map((res, idx) => (\r\n                                    <div\r\n                                        key={idx}\r\n                                        className={`p-3 rounded-lg border ${\r\n                                            res.isCorrect\r\n                                                ? 'bg-green-900/10 border-green-700'\r\n                                                : 'bg-red-900/10 border-red-700'\r\n                                        }`}\r\n                                    >\r\n                                        <div className=\"flex items-start gap-2 text-sm\">\r\n                                            {res.isCorrect ? (\r\n                                                <CheckCircle2 className=\"w-4 h-4 text-green-400 flex-shrink-0 mt-0.5\" />\r\n                                            ) : (\r\n                                                <XCircle className=\"w-4 h-4 text-red-400 flex-shrink-0 mt-0.5\" />\r\n                                            )}\r\n                                            <div className=\"flex-1\">\r\n                                                <p className={res.isCorrect ? 'text-green-200' : 'text-red-200'}>\r\n                                                    Question {idx + 1}\r\n                                                </p>\r\n                                                {!res.isCorrect && (\r\n                                                    <p className=\"text-xs text-slate-400 mt-1\">\r\n                                                        Correct: {res.correctAnswer}\r\n                                                    </p>\r\n                                                )}\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Actions */}\r\n                    <div className=\"p-6 border-t border-slate-700 flex gap-3\">\r\n                        <button\r\n                            onClick={onClose}\r\n                            className=\"flex-1 py-2 px-4 rounded-lg bg-slate-700 hover:bg-slate-600 text-slate-100 font-semibold transition-colors\"\r\n                        >\r\n                            Close\r\n                        </button>\r\n                        {!passed && (\r\n                            <button\r\n                                onClick={() => {\r\n                                    setShowResults(false);\r\n                                    setCurrentQuestionIndex(0);\r\n                                    setUserAnswers(new Array(questions.length).fill(null));\r\n                                }}\r\n                                className=\"flex-1 py-2 px-4 rounded-lg bg-blue-600 hover:bg-blue-500 text-white font-semibold transition-colors\"\r\n                            >\r\n                                Try Again\r\n                            </button>\r\n                        )}\r\n                    </div>\r\n                </motion.div>\r\n            </motion.div>\r\n        );\r\n    }\r\n\r\n    if (questions.length === 0) {\r\n        return (\r\n            <motion.div\r\n                className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                exit={{ opacity: 0 }}\r\n                onClick={onClose}\r\n            >\r\n                <motion.div\r\n                    className=\"bg-slate-900 rounded-lg p-8 w-full max-w-2xl border border-slate-700 text-center\"\r\n                    initial={{ scale: 0.9, opacity: 0 }}\r\n                    animate={{ scale: 1, opacity: 1 }}\r\n                    onClick={(e) => e.stopPropagation()}\r\n                >\r\n                    <p className=\"text-slate-300\">No assessment questions available</p>\r\n                </motion.div>\r\n            </motion.div>\r\n        );\r\n    }\r\n\r\n    const currentQuestion = questions[currentQuestionIndex];\r\n    const isAnswered = userAnswers[currentQuestionIndex] !== null;\r\n    const answersComplete = userAnswers.every(a => a !== null);\r\n\r\n    return (\r\n        <motion.div\r\n            className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={onClose}\r\n        >\r\n            <motion.div\r\n                className=\"bg-gradient-to-b from-slate-900 to-slate-800 rounded-lg w-full max-w-2xl max-h-[90vh] border border-slate-700 overflow-hidden flex flex-col\"\r\n                initial={{ scale: 0.9, opacity: 0, y: 20 }}\r\n                animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                onClick={(e) => e.stopPropagation()}\r\n            >\r\n                {/* Header */}\r\n                <div className=\"bg-gradient-to-r from-slate-700 to-slate-800 p-4 border-b border-slate-600 flex items-center justify-between\">\r\n                    <div className=\"flex-1\">\r\n                        <p className=\"text-xs text-slate-400 mb-1\">SKILL ASSESSMENT</p>\r\n                        <h2 className=\"text-xl font-bold text-slate-100\">{skill.name}</h2>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"text-slate-400 hover:text-slate-200 p-2\"\r\n                    >\r\n                        <X className=\"w-5 h-5\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Progress */}\r\n                <div className=\"px-6 pt-4 pb-2\">\r\n                    <div className=\"flex items-center justify-between mb-2\">\r\n                        <p className=\"text-xs text-slate-400\">\r\n                            Question {currentQuestionIndex + 1} of {questions.length}\r\n                        </p>\r\n                        <p className=\"text-xs text-slate-400\">\r\n                            {userAnswers.filter(a => a !== null).length} answered\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"w-full h-2 bg-slate-700 rounded-full overflow-hidden\">\r\n                        <motion.div\r\n                            className=\"h-full bg-gradient-to-r from-blue-500 to-cyan-400\"\r\n                            animate={{\r\n                                width: `${((currentQuestionIndex + 1) / questions.length) * 100}%`\r\n                            }}\r\n                            transition={{ duration: 0.3 }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\r\n                    {/* Question */}\r\n                    <motion.div\r\n                        key={currentQuestionIndex}\r\n                        initial={{ opacity: 0, y: 10 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                    >\r\n                        <p className=\"text-lg font-semibold text-slate-100 mb-4\">\r\n                            {currentQuestion.question}\r\n                        </p>\r\n\r\n                        {/* Options */}\r\n                        <div className=\"space-y-3\">\r\n                            {currentQuestion.options.map((option, idx) => (\r\n                                <motion.button\r\n                                    key={idx}\r\n                                    onClick={() => handleAnswerSelect(option)}\r\n                                    className={`w-full text-left p-4 rounded-lg border-2 transition-all ${\r\n                                        userAnswers[currentQuestionIndex] === option\r\n                                            ? 'bg-blue-900/40 border-blue-500'\r\n                                            : 'bg-slate-800 border-slate-700 hover:border-slate-600'\r\n                                    }`}\r\n                                    whileHover={{ scale: 1.02 }}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                >\r\n                                    <div className=\"flex items-center gap-3\">\r\n                                        <div\r\n                                            className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${\r\n                                                userAnswers[currentQuestionIndex] === option\r\n                                                    ? 'bg-blue-500 border-blue-500'\r\n                                                    : 'border-slate-600'\r\n                                            }`}\r\n                                        >\r\n                                            {userAnswers[currentQuestionIndex] === option && (\r\n                                                <div className=\"w-2 h-2 bg-white rounded-full\" />\r\n                                            )}\r\n                                        </div>\r\n                                        <span className=\"text-slate-200\">{option}</span>\r\n                                    </div>\r\n                                </motion.button>\r\n                            ))}\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n\r\n                {/* Navigation */}\r\n                <div className=\"p-6 border-t border-slate-700 bg-slate-900 flex gap-3\">\r\n                    <button\r\n                        onClick={handlePrevious}\r\n                        disabled={currentQuestionIndex === 0}\r\n                        className=\"flex-1 py-2 px-4 rounded-lg bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed text-slate-100 font-semibold transition-colors\"\r\n                    >\r\n                        Previous\r\n                    </button>\r\n                    {currentQuestionIndex < questions.length - 1 ? (\r\n                        <button\r\n                            onClick={handleNext}\r\n                            disabled={!isAnswered}\r\n                            className=\"flex-1 py-2 px-4 rounded-lg bg-blue-600 hover:bg-blue-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold transition-colors\"\r\n                        >\r\n                            Next\r\n                        </button>\r\n                    ) : (\r\n                        <motion.button\r\n                            onClick={handleSubmit}\r\n                            disabled={!answersComplete || submitting}\r\n                            className=\"flex-1 py-2 px-4 rounded-lg bg-green-600 hover:bg-green-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold transition-colors flex items-center justify-center gap-2\"\r\n                            whileHover={{ scale: 1.02 }}\r\n                            whileTap={{ scale: 0.98 }}\r\n                        >\r\n                            {submitting ? (\r\n                                <>\r\n                                    <Loader className=\"w-4 h-4 animate-spin\" />\r\n                                    Submitting...\r\n                                </>\r\n                            ) : (\r\n                                <>\r\n                                    <CheckCircle2 className=\"w-4 h-4\" />\r\n                                    Submit Assessment\r\n                                </>\r\n                            )}\r\n                        </motion.button>\r\n                    )}\r\n                </div>\r\n            </motion.div>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default SkillAssessmentModal;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillTreeGameMap.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[70,77],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'currentLevelIndex' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":22,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":22,"endColumn":29,"suggestions":[{"messageId":"removeVar","data":{"varName":"currentLevelIndex"},"fix":{"range":[866,883],"text":""},"desc":"Remove unused variable 'currentLevelIndex'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'generateLevels', 'navigate', and 'savedLevels'. Either include them or remove the dependency array.","line":51,"column":8,"nodeType":"ArrayExpression","endLine":51,"endColumn":15,"suggestions":[{"desc":"Update the dependencies array to be: [generateLevels, navigate, savedLevels, topic]","fix":{"range":[2219,2226],"text":"[generateLevels, navigate, savedLevels, topic]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'assessmentResult' and 'topic'. Either include them or remove the dependency array.","line":66,"column":8,"nodeType":"ArrayExpression","endLine":66,"endColumn":31,"suggestions":[{"desc":"Update the dependencies array to be: [levels, currentGameId, topic, assessmentResult]","fix":{"range":[2763,2786],"text":"[levels, currentGameId, topic, assessmentResult]"}}]},{"ruleId":"no-unused-vars","severity":2,"message":"'index' is defined but never used.","line":172,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":172,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"index"},"fix":{"range":[7200,7207],"text":""},"desc":"Remove unused variable 'index'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'total' is defined but never used.","line":354,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":354,"endColumn":43,"suggestions":[{"messageId":"removeVar","data":{"varName":"total"},"fix":{"range":[14219,14226],"text":""},"desc":"Remove unused variable 'total'."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useLocation, useNavigate } from 'react-router-dom';\r\nimport {\r\n    Lock, Star, CheckCircle2, Play, Trophy, Zap,\r\n    ChevronLeft, ChevronRight, BookOpen, Target, Sparkles,\r\n    ArrowLeft, Loader2, Crown, Flame, Gift, Medal\r\n} from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SkillTreeGameMap = () => {\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n    const scrollRef = useRef(null);\r\n    \r\n    const { topic, assessmentResult, answers, gameId, savedLevels } = location.state || {};\r\n    \r\n    const [levels, setLevels] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [selectedLevel, setSelectedLevel] = useState(null);\r\n    const [currentLevelIndex, setCurrentLevelIndex] = useState(0);\r\n    const [showLevelModal, setShowLevelModal] = useState(false);\r\n    const [playingLevel, setPlayingLevel] = useState(null);\r\n    const [levelQuestions, setLevelQuestions] = useState([]);\r\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n    const [selectedAnswer, setSelectedAnswer] = useState(null);\r\n    const [score, setScore] = useState(0);\r\n    const [finalScore, setFinalScore] = useState(0); // Store final score for results display\r\n    const [showResults, setShowResults] = useState(false);\r\n    const [currentGameId, setCurrentGameId] = useState(gameId || null);\r\n\r\n    useEffect(() => {\r\n        if (topic) {\r\n            if (savedLevels && savedLevels.length > 0) {\r\n                // Use saved levels from database\r\n                setLevels(savedLevels);\r\n                const firstUnlocked = savedLevels.findIndex(l => l.status === 'unlocked');\r\n                if (firstUnlocked !== -1) {\r\n                    setCurrentLevelIndex(firstUnlocked);\r\n                }\r\n                setLoading(false);\r\n            } else {\r\n                // Generate new levels\r\n                generateLevels();\r\n            }\r\n        } else {\r\n            // No topic provided, redirect back\r\n            navigate('/gamification/skill-tree');\r\n        }\r\n    }, [topic]);\r\n\r\n    // Auto-save progress when component unmounts or levels change\r\n    useEffect(() => {\r\n        // Save progress to localStorage as backup\r\n        if (levels.length > 0 && topic) {\r\n            const progressBackup = {\r\n                topic,\r\n                assessmentResult,\r\n                levels,\r\n                gameId: currentGameId,\r\n                lastSaved: new Date().toISOString()\r\n            };\r\n            localStorage.setItem(`skillTree_backup_${topic}`, JSON.stringify(progressBackup));\r\n        }\r\n    }, [levels, currentGameId]);\r\n\r\n    const generateLevels = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/generate-levels`,\r\n                { \r\n                    topic,\r\n                    assessmentResult,\r\n                    answers\r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            \r\n            const generatedLevels = response.data.levels || [];\r\n            \r\n            if (generatedLevels.length === 0) {\r\n                console.warn('[SkillTreeGameMap] API returned empty levels, using fallback');\r\n                generateFallbackLevels();\r\n                return;\r\n            }\r\n            \r\n            setLevels(generatedLevels);\r\n            \r\n            // Find the first unlocked level\r\n            const firstUnlocked = generatedLevels.findIndex(l => l.status === 'unlocked');\r\n            if (firstUnlocked !== -1) {\r\n                setCurrentLevelIndex(firstUnlocked);\r\n            }\r\n\r\n            // Save the game with generated levels\r\n            await saveGameProgress(generatedLevels);\r\n        } catch (error) {\r\n            console.error('[SkillTreeGameMap] Error generating levels:', error.response?.data || error.message);\r\n            // Use fallback levels silently - no error toast needed\r\n            console.info('[SkillTreeGameMap] Using fallback level generation');\r\n            generateFallbackLevels();\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const saveGameProgress = async (levelsData) => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/games`,\r\n                { \r\n                    topic,\r\n                    assessmentResult,\r\n                    levels: levelsData\r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            if (response.data.game?._id) {\r\n                setCurrentGameId(response.data.game._id);\r\n                console.log('[SkillTreeGameMap] Game saved with ID:', response.data.game._id);\r\n            }\r\n        } catch (error) {\r\n            console.error('[SkillTreeGameMap] Error saving game:', error);\r\n            toast.error('Failed to save game progress');\r\n        }\r\n    };\r\n\r\n    const generateFallbackLevels = () => {\r\n        const knowledgeLevel = assessmentResult?.level || 'Beginner';\r\n        const totalLevels = knowledgeLevel === 'Expert' ? 20 : \r\n                          knowledgeLevel === 'Advanced' ? 25 :\r\n                          knowledgeLevel === 'Intermediate' ? 30 : 35;\r\n\r\n        const stages = [\r\n            'Introduction to', 'Basics of', 'Understanding', 'Exploring', 'Learning',\r\n            'Fundamentals of', 'Core Concepts', 'Key Principles', 'Essential', 'Building Blocks',\r\n            'Intermediate', 'Developing', 'Practicing', 'Applying', 'Working with',\r\n            'Advanced', 'Deep Dive into', 'Mastering', 'Expert Level', 'Professional'\r\n        ];\r\n        \r\n        const suffixes = [\r\n            'Concepts', 'Techniques', 'Methods', 'Approaches', 'Skills',\r\n            'Strategies', 'Applications', 'Patterns', 'Practices', 'Principles'\r\n        ];\r\n\r\n        const fallbackLevels = Array.from({ length: totalLevels }, (_, i) => {\r\n            const stageIdx = Math.floor(i / 5) % stages.length;\r\n            const suffixIdx = i % suffixes.length;\r\n            return {\r\n                id: i + 1,\r\n                name: `${stages[stageIdx]} ${topic} ${suffixes[suffixIdx]}`,\r\n                description: `Master ${topic} - Stage ${Math.floor(i / 5) + 1}`,\r\n                difficulty: i < Math.floor(totalLevels * 0.3) ? 'easy' : \r\n                           i < Math.floor(totalLevels * 0.7) ? 'medium' : 'hard',\r\n                status: i === 0 ? 'unlocked' : 'locked',\r\n                stars: 0,\r\n                xp: (i + 1) * 10\r\n            };\r\n        });\r\n        \r\n        setLevels(fallbackLevels);\r\n        setCurrentLevelIndex(0);\r\n        \r\n        // Save fallback levels to database\r\n        saveGameProgress(fallbackLevels);\r\n    };\r\n\r\n    const handleLevelClick = (level, index) => {\r\n        if (level.status === 'locked') {\r\n            toast.error('Complete previous levels to unlock this one!');\r\n            return;\r\n        }\r\n        setSelectedLevel(level);\r\n        setShowLevelModal(true);\r\n    };\r\n\r\n    const startLevel = async () => {\r\n        if (!selectedLevel) return;\r\n        \r\n        setShowLevelModal(false);\r\n        setPlayingLevel(selectedLevel);\r\n        setCurrentQuestionIndex(0);\r\n        setScore(0);\r\n        setSelectedAnswer(null);\r\n        setShowResults(false);\r\n        \r\n        // Fetch questions for this level\r\n        await fetchLevelQuestions(selectedLevel);\r\n    };\r\n\r\n    const handleAnswerSelect = (index) => {\r\n        if (selectedAnswer !== null) return;\r\n        setSelectedAnswer(index);\r\n        \r\n        const isCorrect = index === levelQuestions[currentQuestionIndex].correctIndex;\r\n        const newScore = isCorrect ? score + 1 : score;\r\n        \r\n        if (isCorrect) {\r\n            setScore(newScore);\r\n        }\r\n        \r\n        // Move to next question after delay\r\n        setTimeout(() => {\r\n            if (currentQuestionIndex < levelQuestions.length - 1) {\r\n                setCurrentQuestionIndex(prev => prev + 1);\r\n                setSelectedAnswer(null);\r\n            } else {\r\n                // Level complete - pass the final score directly\r\n                completeLevelHandler(newScore);\r\n            }\r\n        }, 1500);\r\n    };\r\n\r\n    const completeLevelHandler = async (completedScore) => {\r\n        const totalQuestions = levelQuestions.length;\r\n        const percentage = (completedScore / totalQuestions) * 100;\r\n        const earnedStars = percentage >= 90 ? 3 : percentage >= 70 ? 2 : percentage >= 50 ? 1 : 0;\r\n        \r\n        setFinalScore(completedScore); // Store for results display\r\n        setShowResults(true);\r\n        \r\n        // Calculate updated levels\r\n        const updatedLevels = levels.map((level, idx) => {\r\n            if (level.id === playingLevel.id) {\r\n                return { ...level, status: 'completed', stars: Math.max(level.stars, earnedStars) };\r\n            }\r\n            // Unlock next level\r\n            if (idx === levels.findIndex(l => l.id === playingLevel.id) + 1 && level.status === 'locked') {\r\n                return { ...level, status: 'unlocked' };\r\n            }\r\n            return level;\r\n        });\r\n\r\n        // Update level status\r\n        if (earnedStars > 0) {\r\n            setLevels(updatedLevels);\r\n            \r\n            // Save progress to the game document if we have a gameId\r\n            if (currentGameId) {\r\n                try {\r\n                    const token = localStorage.getItem('authToken');\r\n                    const response = await axios.put(\r\n                        `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/games/${currentGameId}/level/${playingLevel.id}`,\r\n                        { \r\n                            stars: earnedStars,\r\n                            score: completedScore,\r\n                            totalQuestions,\r\n                            status: 'completed'\r\n                        },\r\n                        { headers: { Authorization: `Bearer ${token}` } }\r\n                    );\r\n                    // Show XP earned if any\r\n                    if (response.data.xpEarned > 0) {\r\n                        toast.success(`+${response.data.xpEarned} XP earned!`, { icon: 'â­' });\r\n                    }\r\n                } catch (error) {\r\n                    console.error('Error saving level progress to game:', error);\r\n                    toast.error('Failed to save progress');\r\n                }\r\n            } else {\r\n                // Save as new game if no gameId\r\n                await saveGameProgress(updatedLevels);\r\n            }\r\n\r\n            // Also save to gamification profile for XP\r\n            try {\r\n                const token = localStorage.getItem('authToken');\r\n                await axios.post(\r\n                    `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/complete-level`,\r\n                    { \r\n                        topic,\r\n                        levelId: playingLevel.id,\r\n                        stars: earnedStars,\r\n                        score: completedScore,\r\n                        totalQuestions\r\n                    },\r\n                    { headers: { Authorization: `Bearer ${token}` } }\r\n                );\r\n            } catch (error) {\r\n                console.error('Error saving level progress:', error);\r\n            }\r\n        }\r\n    };\r\n\r\n    const closeLevel = () => {\r\n        setPlayingLevel(null);\r\n        setLevelQuestions([]);\r\n        setShowResults(false);\r\n        setScore(0);\r\n        setFinalScore(0);\r\n        setSelectedAnswer(null);\r\n    };\r\n\r\n    const goToNextLevel = () => {\r\n        // Find current level index and get next level\r\n        const currentIndex = levels.findIndex(l => l.id === playingLevel.id);\r\n        const nextLevel = levels[currentIndex + 1];\r\n        \r\n        if (nextLevel && nextLevel.status === 'unlocked') {\r\n            // Reset current level state\r\n            setLevelQuestions([]);\r\n            setShowResults(false);\r\n            setScore(0);\r\n            setFinalScore(0);\r\n            setCurrentQuestionIndex(0);\r\n            setSelectedAnswer(null);\r\n            \r\n            // Set next level as selected and start it\r\n            setSelectedLevel(nextLevel);\r\n            setPlayingLevel(nextLevel);\r\n            \r\n            // Fetch questions for next level\r\n            fetchLevelQuestions(nextLevel);\r\n        } else {\r\n            // No next level or it's locked - go back to map\r\n            closeLevel();\r\n        }\r\n    };\r\n\r\n    const fetchLevelQuestions = async (level) => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/level-questions`,\r\n                { \r\n                    topic,\r\n                    levelName: level.name,\r\n                    difficulty: level.difficulty\r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setLevelQuestions(response.data.questions || []);\r\n        } catch (error) {\r\n            console.error('[SkillTreeGameMap] Error fetching questions:', error);\r\n            // Generate fallback questions\r\n            const fallbackQuestions = generateFallbackQuestions(level);\r\n            setLevelQuestions(fallbackQuestions);\r\n        }\r\n    };\r\n\r\n    const generateFallbackQuestions = (level) => {\r\n        return Array.from({ length: 5 }, (_, i) => ({\r\n            question: `Question ${i + 1} about ${level.name}`,\r\n            options: ['Option A', 'Option B', 'Option C', 'Option D'],\r\n            correctIndex: Math.floor(Math.random() * 4)\r\n        }));\r\n    };\r\n\r\n    // Get path positions for candy crush style layout - CURVED PATH\r\n    const getLevelPosition = (index, total) => {\r\n        const amplitude = 35; // How far left/right the zigzag goes\r\n        const verticalSpacing = 100; // Space between levels vertically\r\n        \r\n        // Create a smooth sine wave pattern\r\n        const x = 50 + Math.sin(index * 0.8) * amplitude;\r\n        const y = 60 + (index * verticalSpacing);\r\n        \r\n        return { x, y, index };\r\n    };\r\n\r\n    // Get level colors based on difficulty\r\n    const getLevelColors = (level, index) => {\r\n        if (level.status === 'completed') {\r\n            return {\r\n                bg: 'from-emerald-400 via-green-500 to-teal-600',\r\n                shadow: 'shadow-emerald-500/50',\r\n                glow: 'bg-emerald-400'\r\n            };\r\n        }\r\n        if (level.status === 'unlocked') {\r\n            // Rotating vibrant colors for unlocked\r\n            const colors = [\r\n                { bg: 'from-pink-500 via-rose-500 to-red-500', shadow: 'shadow-pink-500/50', glow: 'bg-pink-400' },\r\n                { bg: 'from-purple-500 via-violet-500 to-indigo-500', shadow: 'shadow-purple-500/50', glow: 'bg-purple-400' },\r\n                { bg: 'from-cyan-400 via-blue-500 to-indigo-500', shadow: 'shadow-cyan-500/50', glow: 'bg-cyan-400' },\r\n                { bg: 'from-orange-400 via-amber-500 to-yellow-500', shadow: 'shadow-orange-500/50', glow: 'bg-orange-400' },\r\n            ];\r\n            return colors[index % colors.length];\r\n        }\r\n        return {\r\n            bg: 'from-slate-600 to-slate-700',\r\n            shadow: 'shadow-slate-700/30',\r\n            glow: 'bg-slate-500'\r\n        };\r\n    };\r\n\r\n    const renderStars = (count, size = 'sm') => {\r\n        const sizeClass = size === 'lg' ? 'w-6 h-6' : 'w-4 h-4';\r\n        return (\r\n            <div className=\"flex gap-0.5\">\r\n                {[1, 2, 3].map(star => (\r\n                    <Star \r\n                        key={star}\r\n                        className={`${sizeClass} ${star <= count ? 'text-yellow-400 fill-yellow-400' : 'text-gray-600'}`}\r\n                    />\r\n                ))}\r\n            </div>\r\n        );\r\n    };\r\n\r\n    // Capitalize first letter of each word\r\n    const formatTopic = (str) => {\r\n        if (!str) return '';\r\n        return str.split(' ').map(word => \r\n            word.charAt(0).toUpperCase() + word.slice(1)\r\n        ).join(' ');\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-950 to-slate-900 flex items-center justify-center\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.9 }}\r\n                    animate={{ opacity: 1, scale: 1 }}\r\n                    className=\"text-center\"\r\n                >\r\n                    <Loader2 className=\"w-16 h-16 text-purple-400 animate-spin mx-auto mb-4\" />\r\n                    <h2 className=\"text-2xl font-bold text-white mb-2\">Building Your Skill Tree</h2>\r\n                    <p className=\"text-purple-300\">Personalizing levels for {topic}...</p>\r\n                </motion.div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    // Show error state if API failed\r\n    // Playing a level\r\n    if (playingLevel && levelQuestions.length > 0) {\r\n        const currentQuestion = levelQuestions[currentQuestionIndex];\r\n        \r\n        if (showResults) {\r\n            const percentage = (finalScore / levelQuestions.length) * 100;\r\n            const earnedStars = percentage >= 90 ? 3 : percentage >= 70 ? 2 : percentage >= 50 ? 1 : 0;\r\n            \r\n            return (\r\n                <div className=\"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-950 to-slate-900 flex items-center justify-center p-6\">\r\n                    <motion.div\r\n                        initial={{ opacity: 0, scale: 0.8 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        className=\"bg-slate-800/80 backdrop-blur-sm rounded-3xl p-8 max-w-md w-full text-center border border-purple-500/30\"\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0 }}\r\n                            animate={{ scale: 1 }}\r\n                            transition={{ delay: 0.2, type: 'spring' }}\r\n                            className={`w-24 h-24 rounded-full mx-auto mb-6 flex items-center justify-center ${\r\n                                earnedStars >= 2 ? 'bg-gradient-to-br from-yellow-500 to-orange-500' : \r\n                                earnedStars === 1 ? 'bg-gradient-to-br from-blue-500 to-cyan-500' :\r\n                                'bg-gradient-to-br from-gray-500 to-gray-600'\r\n                            }`}\r\n                        >\r\n                            {earnedStars >= 2 ? (\r\n                                <Trophy className=\"w-12 h-12 text-white\" />\r\n                            ) : earnedStars === 1 ? (\r\n                                <CheckCircle2 className=\"w-12 h-12 text-white\" />\r\n                            ) : (\r\n                                <Target className=\"w-12 h-12 text-white\" />\r\n                            )}\r\n                        </motion.div>\r\n\r\n                        <h2 className=\"text-3xl font-bold text-white mb-2\">\r\n                            {earnedStars >= 2 ? 'Excellent!' : earnedStars === 1 ? 'Good Job!' : 'Keep Trying!'}\r\n                        </h2>\r\n                        \r\n                        <p className=\"text-purple-300 mb-4\">{playingLevel.name} Complete</p>\r\n                        \r\n                        <div className=\"flex justify-center mb-6\">\r\n                            {renderStars(earnedStars, 'lg')}\r\n                        </div>\r\n\r\n                        <div className=\"bg-slate-900/50 rounded-xl p-4 mb-6\">\r\n                            <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\r\n                                <span>Score</span>\r\n                                <span className=\"text-white font-bold\">{finalScore}/{levelQuestions.length}</span>\r\n                            </div>\r\n                            <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\r\n                                <span>Accuracy</span>\r\n                                <span className=\"text-white font-bold\">{Math.round(percentage)}%</span>\r\n                            </div>\r\n                            {playingLevel.status !== 'completed' && earnedStars > 0 && (\r\n                                <div className=\"flex justify-between text-sm text-slate-400\">\r\n                                    <span>XP Earned</span>\r\n                                    <span className=\"text-yellow-400 font-bold\">+{earnedStars === 3 ? 10 : earnedStars === 2 ? 8 : 5} XP</span>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-3\">\r\n                            <motion.button\r\n                                onClick={closeLevel}\r\n                                className=\"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-semibold text-white transition-colors\"\r\n                                whileHover={{ scale: 1.02 }}\r\n                                whileTap={{ scale: 0.98 }}\r\n                            >\r\n                                Back to Map\r\n                            </motion.button>\r\n                            {earnedStars === 0 ? (\r\n                                // No stars - show Retry button\r\n                                <motion.button\r\n                                    onClick={() => {\r\n                                        setShowResults(false);\r\n                                        setCurrentQuestionIndex(0);\r\n                                        setScore(0);\r\n                                        setFinalScore(0);\r\n                                        setSelectedAnswer(null);\r\n                                    }}\r\n                                    className=\"flex-1 px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl font-semibold text-white\"\r\n                                    whileHover={{ scale: 1.02 }}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                >\r\n                                    Retry\r\n                                </motion.button>\r\n                            ) : (\r\n                                // At least 1 star - show Next Level button\r\n                                <motion.button\r\n                                    onClick={goToNextLevel}\r\n                                    className=\"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-500 rounded-xl font-semibold text-white\"\r\n                                    whileHover={{ scale: 1.02 }}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                >\r\n                                    Next Level â†’\r\n                                </motion.button>\r\n                            )}\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n            );\r\n        }\r\n\r\n        return (\r\n            <div className=\"min-h-screen max-h-screen overflow-hidden bg-gradient-to-b from-indigo-950 via-purple-950 to-slate-900 p-6\">\r\n                <div className=\"max-w-2xl mx-auto h-full flex flex-col\">\r\n                    {/* Header */}\r\n                    <div className=\"flex items-center justify-between mb-4 flex-shrink-0\">\r\n                        <button\r\n                            onClick={closeLevel}\r\n                            className=\"p-2 rounded-lg bg-slate-800/50 text-slate-400 hover:text-white transition-colors\"\r\n                        >\r\n                            <ArrowLeft className=\"w-6 h-6\" />\r\n                        </button>\r\n                        <div className=\"text-center\">\r\n                            <h3 className=\"text-lg font-semibold text-white\">{playingLevel.name}</h3>\r\n                            <p className=\"text-sm text-purple-300\">{topic}</p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 bg-slate-800/50 rounded-lg px-3 py-1\">\r\n                            <Zap className=\"w-4 h-4 text-yellow-400\" />\r\n                            <span className=\"text-white font-bold\">{score}</span>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Progress */}\r\n                    <div className=\"mb-4 flex-shrink-0\">\r\n                        <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\r\n                            <span>Question {currentQuestionIndex + 1} of {levelQuestions.length}</span>\r\n                        </div>\r\n                        <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\r\n                            <motion.div\r\n                                className=\"h-full bg-gradient-to-r from-purple-500 to-pink-500\"\r\n                                initial={{ width: 0 }}\r\n                                animate={{ width: `${((currentQuestionIndex + 1) / levelQuestions.length) * 100}%` }}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Question Card - Scrollable */}\r\n                    <div className=\"flex-1 overflow-y-auto pr-2 game-scrollbar\">\r\n                        <motion.div\r\n                            key={currentQuestionIndex}\r\n                            initial={{ opacity: 0, x: 50 }}\r\n                            animate={{ opacity: 1, x: 0 }}\r\n                            className=\"bg-slate-800/60 backdrop-blur-sm rounded-2xl p-6 border border-purple-500/30 mb-4\"\r\n                        >\r\n                            <h2 className=\"text-xl font-semibold text-white mb-6 leading-relaxed\">\r\n                                {currentQuestion.question}\r\n                            </h2>\r\n\r\n                            <div className=\"space-y-3\">\r\n                                {currentQuestion.options.map((option, idx) => {\r\n                                    const isSelected = selectedAnswer === idx;\r\n                                    const isCorrect = idx === currentQuestion.correctIndex;\r\n                                    const showResult = selectedAnswer !== null;\r\n\r\n                                    return (\r\n                                        <motion.button\r\n                                            key={idx}\r\n                                            onClick={() => handleAnswerSelect(idx)}\r\n                                            disabled={selectedAnswer !== null}\r\n                                            className={`w-full p-4 rounded-xl text-left transition-all ${\r\n                                                showResult\r\n                                                    ? isCorrect\r\n                                                        ? 'bg-green-500/20 border-2 border-green-500 text-green-300'\r\n                                                        : isSelected\r\n                                                            ? 'bg-red-500/20 border-2 border-red-500 text-red-300'\r\n                                                            : 'bg-slate-700/50 border border-slate-600 text-slate-400'\r\n                                                    : 'bg-slate-700/50 border border-slate-600 text-white hover:bg-slate-700 hover:border-purple-500'\r\n                                            }`}\r\n                                            whileHover={selectedAnswer === null ? { scale: 1.02 } : {}}\r\n                                            whileTap={selectedAnswer === null ? { scale: 0.98 } : {}}\r\n                                        >\r\n                                            <div className=\"flex items-center gap-3\">\r\n                                                <span className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0 ${\r\n                                                    showResult && isCorrect ? 'bg-green-500 text-white' :\r\n                                                    showResult && isSelected ? 'bg-red-500 text-white' :\r\n                                                    'bg-slate-600 text-slate-300'\r\n                                                }`}>\r\n                                                    {String.fromCharCode(65 + idx)}\r\n                                                </span>\r\n                                                <span className=\"flex-1\">{option}</span>\r\n                                            </div>\r\n                                        </motion.button>\r\n                                    );\r\n                                })}\r\n                            </div>\r\n                        </motion.div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-b from-indigo-950 via-purple-950 to-slate-900 overflow-hidden\">\r\n            {/* Animated Background Stars */}\r\n            <div className=\"fixed inset-0 overflow-hidden pointer-events-none\">\r\n                {[...Array(20)].map((_, i) => (\r\n                    <motion.div\r\n                        key={i}\r\n                        className=\"absolute w-1 h-1 bg-white rounded-full\"\r\n                        style={{\r\n                            left: `${Math.random() * 100}%`,\r\n                            top: `${Math.random() * 100}%`,\r\n                        }}\r\n                        animate={{\r\n                            opacity: [0.2, 1, 0.2],\r\n                            scale: [1, 1.5, 1],\r\n                        }}\r\n                        transition={{\r\n                            duration: 2 + Math.random() * 2,\r\n                            repeat: Infinity,\r\n                            delay: Math.random() * 2,\r\n                        }}\r\n                    />\r\n                ))}\r\n            </div>\r\n\r\n            {/* Header */}\r\n            <div className=\"sticky top-0 z-20 bg-gradient-to-b from-slate-900 via-slate-900/95 to-transparent pb-4\">\r\n                <div className=\"bg-slate-900/90 backdrop-blur-sm border-b border-purple-500/20 p-4\">\r\n                    <div className=\"max-w-4xl mx-auto flex items-center justify-between\">\r\n                        <button\r\n                            onClick={() => navigate('/gamification/skill-tree')}\r\n                            className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors\"\r\n                        >\r\n                            <ArrowLeft className=\"w-5 h-5\" />\r\n                            <span>Back</span>\r\n                        </button>\r\n                        <div className=\"text-center\">\r\n                            <h1 className=\"text-xl font-bold text-white capitalize\">{formatTopic(topic)}</h1>\r\n                            <p className=\"text-sm text-purple-300\">Skill Tree Adventure</p>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-2 bg-gradient-to-r from-purple-500/20 to-pink-500/20 rounded-lg px-3 py-1.5 border border-purple-500/30\">\r\n                            <Trophy className=\"w-4 h-4 text-yellow-400\" />\r\n                            <span className=\"text-white font-bold\">\r\n                                {levels.filter(l => l.status === 'completed').length}/{levels.length}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                {/* Progress Bar */}\r\n                <div className=\"max-w-md mx-auto mt-3 px-6\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"flex-1 h-3 bg-slate-800/80 rounded-full overflow-hidden border border-purple-500/20\">\r\n                            <motion.div \r\n                                className=\"h-full bg-gradient-to-r from-purple-500 via-pink-500 to-orange-400\"\r\n                                initial={{ width: 0 }}\r\n                                animate={{ width: `${(levels.filter(l => l.status === 'completed').length / levels.length) * 100}%` }}\r\n                                transition={{ duration: 0.5 }}\r\n                            />\r\n                        </div>\r\n                        <div className=\"flex items-center gap-1\">\r\n                            <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                            <span className=\"text-sm font-bold text-yellow-400\">\r\n                                {levels.reduce((sum, l) => sum + (l.stars || 0), 0)}\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Level Map */}\r\n            <div \r\n                ref={scrollRef}\r\n                className=\"overflow-y-auto px-4 py-4\"\r\n                style={{ height: 'calc(100vh - 120px)' }}\r\n            >\r\n                <div \r\n                    className=\"relative max-w-sm mx-auto\"\r\n                    style={{ minHeight: `${levels.length * 100 + 100}px` }}\r\n                >\r\n                    {/* Decorative path background */}\r\n                    <div className=\"absolute inset-0 pointer-events-none\">\r\n                        <svg \r\n                            className=\"absolute inset-0 w-full h-full\"\r\n                            style={{ minHeight: `${levels.length * 100 + 100}px` }}\r\n                        >\r\n                            <defs>\r\n                                <linearGradient id=\"pathGradient\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">\r\n                                    <stop offset=\"0%\" stopColor=\"rgba(168, 85, 247, 0.3)\" />\r\n                                    <stop offset=\"100%\" stopColor=\"rgba(236, 72, 153, 0.3)\" />\r\n                                </linearGradient>\r\n                                <filter id=\"glow\">\r\n                                    <feGaussianBlur stdDeviation=\"3\" result=\"coloredBlur\"/>\r\n                                    <feMerge>\r\n                                        <feMergeNode in=\"coloredBlur\"/>\r\n                                        <feMergeNode in=\"SourceGraphic\"/>\r\n                                    </feMerge>\r\n                                </filter>\r\n                            </defs>\r\n                            \r\n                            {/* Main curved path */}\r\n                            {levels.length > 1 && (\r\n                                <path\r\n                                    d={levels.map((_, idx) => {\r\n                                        const pos = getLevelPosition(idx, levels.length);\r\n                                        return idx === 0 \r\n                                            ? `M ${pos.x}% ${pos.y}` \r\n                                            : `L ${pos.x}% ${pos.y}`;\r\n                                    }).join(' ')}\r\n                                    fill=\"none\"\r\n                                    stroke=\"url(#pathGradient)\"\r\n                                    strokeWidth=\"8\"\r\n                                    strokeLinecap=\"round\"\r\n                                    strokeLinejoin=\"round\"\r\n                                    filter=\"url(#glow)\"\r\n                                />\r\n                            )}\r\n                            \r\n                            {/* Completed path overlay */}\r\n                            {levels.some(l => l.status === 'completed') && (\r\n                                <path\r\n                                    d={levels.slice(0, levels.findIndex(l => l.status !== 'completed') + 1 || levels.length).map((_, idx) => {\r\n                                        const pos = getLevelPosition(idx, levels.length);\r\n                                        return idx === 0 \r\n                                            ? `M ${pos.x}% ${pos.y}` \r\n                                            : `L ${pos.x}% ${pos.y}`;\r\n                                    }).join(' ')}\r\n                                    fill=\"none\"\r\n                                    stroke=\"rgba(34, 197, 94, 0.6)\"\r\n                                    strokeWidth=\"6\"\r\n                                    strokeLinecap=\"round\"\r\n                                    strokeLinejoin=\"round\"\r\n                                />\r\n                            )}\r\n                        </svg>\r\n                    </div>\r\n\r\n                    {/* Level nodes */}\r\n                    {levels.map((level, idx) => {\r\n                        const pos = getLevelPosition(idx, levels.length);\r\n                        const isLocked = level.status === 'locked';\r\n                        const isCompleted = level.status === 'completed';\r\n                        const isUnlocked = level.status === 'unlocked';\r\n                        const colors = getLevelColors(level, idx);\r\n                        const isBossLevel = (idx + 1) % 5 === 0; // Every 5th level is a boss\r\n                        \r\n                        return (\r\n                            <motion.div\r\n                                key={level.id}\r\n                                className=\"absolute transform -translate-x-1/2 -translate-y-1/2\"\r\n                                style={{ left: `${pos.x}%`, top: pos.y }}\r\n                                initial={{ scale: 0, opacity: 0 }}\r\n                                animate={{ scale: 1, opacity: 1 }}\r\n                                transition={{ delay: idx * 0.03, type: 'spring', stiffness: 200 }}\r\n                            >\r\n                                {/* Decorative ring for special levels */}\r\n                                {isBossLevel && !isLocked && (\r\n                                    <motion.div\r\n                                        className=\"absolute inset-0 -m-3 rounded-full border-4 border-yellow-400/50\"\r\n                                        animate={{ rotate: 360 }}\r\n                                        transition={{ duration: 10, repeat: Infinity, ease: 'linear' }}\r\n                                    >\r\n                                        <div className=\"absolute -top-1 left-1/2 transform -translate-x-1/2 w-2 h-2 bg-yellow-400 rounded-full\" />\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                <motion.button\r\n                                    onClick={() => handleLevelClick(level, idx)}\r\n                                    className={`relative flex items-center justify-center shadow-xl transition-all ${\r\n                                        isBossLevel \r\n                                            ? 'w-20 h-20 rounded-2xl rotate-45' \r\n                                            : 'w-16 h-16 rounded-full'\r\n                                    } bg-gradient-to-br ${colors.bg} ${colors.shadow} ${\r\n                                        isLocked ? 'opacity-60' : ''\r\n                                    }`}\r\n                                    whileHover={!isLocked ? { scale: 1.15, rotate: isBossLevel ? 45 : 0 } : {}}\r\n                                    whileTap={!isLocked ? { scale: 0.95 } : {}}\r\n                                    disabled={isLocked}\r\n                                >\r\n                                    {/* Inner content - counter-rotate for boss levels */}\r\n                                    <div className={isBossLevel ? '-rotate-45' : ''}>\r\n                                        {isLocked ? (\r\n                                            <Lock className=\"w-6 h-6 text-slate-400\" />\r\n                                        ) : isCompleted ? (\r\n                                            <div className=\"flex flex-col items-center\">\r\n                                                <CheckCircle2 className=\"w-6 h-6 text-white\" />\r\n                                            </div>\r\n                                        ) : isBossLevel ? (\r\n                                            <Crown className=\"w-7 h-7 text-yellow-300\" />\r\n                                        ) : (\r\n                                            <span className=\"text-2xl font-black text-white drop-shadow-lg\">{level.id}</span>\r\n                                        )}\r\n                                    </div>\r\n                                    \r\n                                    {/* Pulse animation for unlocked levels */}\r\n                                    {isUnlocked && (\r\n                                        <>\r\n                                            <motion.div\r\n                                                className={`absolute inset-0 ${isBossLevel ? 'rounded-2xl' : 'rounded-full'} ${colors.glow}`}\r\n                                                animate={{ scale: [1, 1.4, 1], opacity: [0.4, 0, 0.4] }}\r\n                                                transition={{ duration: 1.5, repeat: Infinity }}\r\n                                            />\r\n                                            {/* Sparkle effect */}\r\n                                            <motion.div\r\n                                                className=\"absolute -top-1 -right-1\"\r\n                                                animate={{ rotate: 360, scale: [1, 1.2, 1] }}\r\n                                                transition={{ duration: 2, repeat: Infinity }}\r\n                                            >\r\n                                                <Sparkles className=\"w-4 h-4 text-yellow-300\" />\r\n                                            </motion.div>\r\n                                        </>\r\n                                    )}\r\n\r\n                                    {/* Flame effect for streak */}\r\n                                    {isUnlocked && idx > 0 && levels[idx - 1]?.status === 'completed' && (\r\n                                        <motion.div\r\n                                            className=\"absolute -top-3 left-1/2 transform -translate-x-1/2\"\r\n                                            animate={{ y: [-2, 2, -2] }}\r\n                                            transition={{ duration: 0.5, repeat: Infinity }}\r\n                                        >\r\n                                            <Flame className=\"w-5 h-5 text-orange-400\" />\r\n                                        </motion.div>\r\n                                    )}\r\n                                </motion.button>\r\n\r\n                                {/* Level name label */}\r\n                                {!isLocked && (\r\n                                    <motion.div\r\n                                        className={`absolute ${pos.x > 50 ? 'right-full mr-3' : 'left-full ml-3'} top-1/2 transform -translate-y-1/2 whitespace-nowrap`}\r\n                                        initial={{ opacity: 0, x: pos.x > 50 ? 10 : -10 }}\r\n                                        animate={{ opacity: 1, x: 0 }}\r\n                                        transition={{ delay: idx * 0.03 + 0.2 }}\r\n                                    >\r\n                                        <div className=\"bg-slate-800/90 backdrop-blur-sm rounded-lg px-3 py-1.5 border border-purple-500/20\">\r\n                                            <p className=\"text-xs font-semibold text-white truncate max-w-[120px]\">{level.name}</p>\r\n                                            {isCompleted && level.stars > 0 && (\r\n                                                <div className=\"flex gap-0.5 mt-0.5\">\r\n                                                    {[1, 2, 3].map(star => (\r\n                                                        <Star \r\n                                                            key={star}\r\n                                                            className={`w-3 h-3 ${star <= level.stars ? 'text-yellow-400 fill-yellow-400' : 'text-gray-600'}`}\r\n                                                        />\r\n                                                    ))}\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </motion.div>\r\n                                )}\r\n                            </motion.div>\r\n                        );\r\n                    })}\r\n                    \r\n                    {/* End goal decoration */}\r\n                    <motion.div\r\n                        className=\"absolute transform -translate-x-1/2\"\r\n                        style={{ \r\n                            left: `${getLevelPosition(levels.length - 1, levels.length).x}%`, \r\n                            top: getLevelPosition(levels.length - 1, levels.length).y + 80 \r\n                        }}\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ delay: 0.5 }}\r\n                    >\r\n                        <div className=\"flex flex-col items-center\">\r\n                            <motion.div\r\n                                animate={{ y: [-5, 5, -5] }}\r\n                                transition={{ duration: 2, repeat: Infinity }}\r\n                            >\r\n                                <Gift className=\"w-10 h-10 text-yellow-400\" />\r\n                            </motion.div>\r\n                            <p className=\"text-sm font-bold text-purple-300 mt-2\">Master {formatTopic(topic)}!</p>\r\n                        </div>\r\n                    </motion.div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Level Modal */}\r\n            <AnimatePresence>\r\n                {showLevelModal && selectedLevel && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4\"\r\n                        onClick={() => setShowLevelModal(false)}\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.8, opacity: 0, y: 50 }}\r\n                            animate={{ scale: 1, opacity: 1, y: 0 }}\r\n                            exit={{ scale: 0.8, opacity: 0, y: 50 }}\r\n                            className=\"relative bg-gradient-to-b from-slate-800 to-slate-900 rounded-3xl p-6 max-w-sm w-full border border-purple-500/30 shadow-2xl shadow-purple-500/20\"\r\n                            onClick={e => e.stopPropagation()}\r\n                        >\r\n                            {/* Decorative top banner */}\r\n                            <div className=\"absolute -top-3 left-1/2 transform -translate-x-1/2 z-10\">\r\n                                <div className={`text-white text-xs font-bold px-4 py-1 rounded-full shadow-lg ${\r\n                                    selectedLevel.difficulty === 'hard' \r\n                                        ? 'bg-gradient-to-r from-red-500 to-orange-500' \r\n                                        : selectedLevel.difficulty === 'medium'\r\n                                            ? 'bg-gradient-to-r from-yellow-500 to-amber-500'\r\n                                            : 'bg-gradient-to-r from-green-500 to-emerald-500'\r\n                                }`}>\r\n                                    {selectedLevel.difficulty?.toUpperCase() || 'EASY'}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"text-center mb-6 pt-2\">\r\n                                {/* Level icon with animation */}\r\n                                <motion.div \r\n                                    className={`w-24 h-24 rounded-full mx-auto mb-4 flex items-center justify-center relative ${\r\n                                        selectedLevel.status === 'completed'\r\n                                            ? 'bg-gradient-to-br from-emerald-400 to-teal-600'\r\n                                            : 'bg-gradient-to-br from-purple-500 via-pink-500 to-rose-500'\r\n                                    }`}\r\n                                    animate={{ rotate: [0, 5, -5, 0] }}\r\n                                    transition={{ duration: 2, repeat: Infinity }}\r\n                                >\r\n                                    {selectedLevel.status === 'completed' ? (\r\n                                        <Trophy className=\"w-12 h-12 text-yellow-300\" />\r\n                                    ) : (\r\n                                        <span className=\"text-4xl font-black text-white drop-shadow-lg\">{selectedLevel.id}</span>\r\n                                    )}\r\n                                    \r\n                                    {/* Sparkles around */}\r\n                                    <motion.div\r\n                                        className=\"absolute -top-2 -right-2\"\r\n                                        animate={{ scale: [1, 1.2, 1], rotate: 360 }}\r\n                                        transition={{ duration: 3, repeat: Infinity }}\r\n                                    >\r\n                                        <Sparkles className=\"w-6 h-6 text-yellow-400\" />\r\n                                    </motion.div>\r\n                                </motion.div>\r\n                                \r\n                                <h3 className=\"text-2xl font-bold text-white mb-2\">{selectedLevel.name}</h3>\r\n                                <p className=\"text-slate-400 text-sm\">{selectedLevel.description}</p>\r\n                                \r\n                                {selectedLevel.status === 'completed' && (\r\n                                    <motion.div \r\n                                        className=\"flex justify-center mt-4 gap-1\"\r\n                                        initial={{ scale: 0 }}\r\n                                        animate={{ scale: 1 }}\r\n                                        transition={{ delay: 0.2 }}\r\n                                    >\r\n                                        {[1, 2, 3].map(star => (\r\n                                            <motion.div\r\n                                                key={star}\r\n                                                initial={{ rotate: -30, scale: 0 }}\r\n                                                animate={{ rotate: 0, scale: 1 }}\r\n                                                transition={{ delay: 0.1 * star }}\r\n                                            >\r\n                                                <Star \r\n                                                    className={`w-8 h-8 ${star <= selectedLevel.stars ? 'text-yellow-400 fill-yellow-400' : 'text-gray-600'}`}\r\n                                                />\r\n                                            </motion.div>\r\n                                        ))}\r\n                                    </motion.div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Stats grid */}\r\n                            <div className=\"grid grid-cols-2 gap-3 mb-6\">\r\n                                <div className=\"bg-slate-800/50 rounded-xl p-3 text-center border border-slate-700/50\">\r\n                                    <Target className=\"w-5 h-5 text-cyan-400 mx-auto mb-1\" />\r\n                                    <p className=\"text-xs text-slate-400\">Questions</p>\r\n                                    <p className=\"text-lg font-bold text-white\">5</p>\r\n                                </div>\r\n                                <div className=\"bg-slate-800/50 rounded-xl p-3 text-center border border-slate-700/50\">\r\n                                    <Zap className=\"w-5 h-5 text-yellow-400 mx-auto mb-1\" />\r\n                                    <p className=\"text-xs text-slate-400\">XP Reward</p>\r\n                                    <p className=\"text-lg font-bold text-white\">\r\n                                        {selectedLevel.status === 'completed' ? 'âœ“' : '5-10'}\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* XP breakdown */}\r\n                            {selectedLevel.status !== 'completed' && (\r\n                                <div className=\"bg-gradient-to-r from-purple-900/30 to-pink-900/30 rounded-xl p-3 mb-6 border border-purple-500/20\">\r\n                                    <p className=\"text-xs text-center text-slate-400 mb-2\">XP based on stars earned</p>\r\n                                    <div className=\"flex justify-around\">\r\n                                        <div className=\"text-center\">\r\n                                            <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400 mx-auto\" />\r\n                                            <p className=\"text-sm font-bold text-white\">5 XP</p>\r\n                                        </div>\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"flex\">\r\n                                                <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                                <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                            </div>\r\n                                            <p className=\"text-sm font-bold text-white\">8 XP</p>\r\n                                        </div>\r\n                                        <div className=\"text-center\">\r\n                                            <div className=\"flex\">\r\n                                                <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                                <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                                <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                            </div>\r\n                                            <p className=\"text-sm font-bold text-white\">10 XP</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            <div className=\"flex gap-3\">\r\n                                <motion.button\r\n                                    onClick={() => setShowLevelModal(false)}\r\n                                    className=\"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-semibold text-white transition-colors\"\r\n                                    whileHover={{ scale: 1.02 }}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                >\r\n                                    Close\r\n                                </motion.button>\r\n                                <motion.button\r\n                                    onClick={startLevel}\r\n                                    className=\"flex-1 px-4 py-3 bg-gradient-to-r from-purple-600 via-pink-500 to-rose-500 rounded-xl font-semibold text-white flex items-center justify-center gap-2 shadow-lg shadow-purple-500/30\"\r\n                                    whileHover={{ scale: 1.05 }}\r\n                                    whileTap={{ scale: 0.95 }}\r\n                                >\r\n                                    <Play className=\"w-5 h-5\" />\r\n                                    {selectedLevel.status === 'completed' ? 'Replay' : 'Play!'}\r\n                                </motion.button>\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkillTreeGameMap;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillTreeGames.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[62,69],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'saveNewGame'. Either include it or remove the dependency array.","line":32,"column":8,"nodeType":"ArrayExpression","endLine":32,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [newGameData, saveNewGame]","fix":{"range":[1112,1125],"text":"[newGameData, saveNewGame]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport {\r\n    Gamepad2, Plus, Trophy, Star, ChevronRight, Trash2,\r\n    Clock, Target, Zap, BookOpen, Loader2, Play, ArrowLeft\r\n} from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SkillTreeGames = () => {\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const [games, setGames] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [deleteConfirm, setDeleteConfirm] = useState(null);\r\n\r\n    // Check if we just created a new game from assessment\r\n    const newGameData = location.state?.newGame;\r\n\r\n    useEffect(() => {\r\n        fetchGames();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        // If we have new game data, save it\r\n        if (newGameData) {\r\n            saveNewGame(newGameData);\r\n            // Clear the state to prevent re-saving on refresh\r\n            window.history.replaceState({}, document.title);\r\n        }\r\n    }, [newGameData]);\r\n\r\n    // Redirect to new game page if no games exist (and not coming with new game data)\r\n    useEffect(() => {\r\n        if (!loading && games.length === 0 && !newGameData) {\r\n            navigate('/gamification/skill-tree/new', { state: { hasGames: false } });\r\n        }\r\n    }, [loading, games, newGameData, navigate]);\r\n\r\n    const fetchGames = async () => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.get(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/games`,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setGames(response.data.games || []);\r\n        } catch (error) {\r\n            console.error('[SkillTreeGames] Error fetching games:', error);\r\n            toast.error('Failed to load your games');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const saveNewGame = async (gameData) => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/games`,\r\n                gameData,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            // Refresh games list\r\n            fetchGames();\r\n            toast.success(`\"${gameData.topic}\" skill tree created!`);\r\n        } catch (error) {\r\n            console.error('[SkillTreeGames] Error saving game:', error);\r\n            toast.error('Failed to save game');\r\n        }\r\n    };\r\n\r\n    const handlePlayGame = (game) => {\r\n        navigate('/gamification/skill-tree/map', {\r\n            state: {\r\n                topic: game.topic,\r\n                assessmentResult: game.assessmentResult,\r\n                gameId: game._id,\r\n                savedLevels: game.levels\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleDeleteGame = async (gameId) => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            await axios.delete(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/games/${gameId}`,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setGames(prev => prev.filter(g => g._id !== gameId));\r\n            toast.success('Game deleted');\r\n            setDeleteConfirm(null);\r\n        } catch (error) {\r\n            console.error('[SkillTreeGames] Error deleting game:', error);\r\n            toast.error('Failed to delete game');\r\n        }\r\n    };\r\n\r\n    const handleCreateNew = () => {\r\n        navigate('/gamification/skill-tree/new', { state: { hasGames: games.length > 0 } });\r\n    };\r\n\r\n    const getProgressPercentage = (game) => {\r\n        if (!game.levels || game.levels.length === 0) return 0;\r\n        const completed = game.levels.filter(l => l.status === 'completed').length;\r\n        return Math.round((completed / game.levels.length) * 100);\r\n    };\r\n\r\n    const getTotalStars = (game) => {\r\n        if (!game.levels) return 0;\r\n        return game.levels.reduce((sum, l) => sum + (l.stars || 0), 0);\r\n    };\r\n\r\n    const getMaxStars = (game) => {\r\n        if (!game.levels) return 0;\r\n        return game.levels.length * 3;\r\n    };\r\n\r\n    // Capitalize first letter of each word\r\n    const formatTopic = (topic) => {\r\n        if (!topic) return '';\r\n        return topic.split(' ').map(word => \r\n            word.charAt(0).toUpperCase() + word.slice(1)\r\n        ).join(' ');\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"min-h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center\">\r\n                <Loader2 className=\"w-12 h-12 text-purple-400 animate-spin\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 p-6\">\r\n            <div className=\"max-w-5xl mx-auto\">\r\n                {/* Back Button */}\r\n                <motion.button\r\n                    onClick={() => navigate('/')}\r\n                    className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors mb-6\"\r\n                    initial={{ opacity: 0, x: -20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    whileHover={{ x: -5 }}\r\n                >\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                    <span>Back</span>\r\n                </motion.button>\r\n\r\n                {/* Header */}\r\n                <motion.div\r\n                    className=\"text-center mb-10\"\r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                >\r\n                    <div className=\"w-16 h-16 bg-gradient-to-br from-purple-500 to-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-purple-500/30\">\r\n                        <Gamepad2 className=\"w-8 h-8 text-white\" />\r\n                    </div>\r\n                    <h1 className=\"text-3xl font-bold text-white mb-2\">My Skill Trees</h1>\r\n                    <p className=\"text-slate-400\">Continue learning or start a new adventure</p>\r\n                </motion.div>\r\n\r\n                {/* Games Grid */}\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                    {/* Create New Game Card */}\r\n                    <motion.button\r\n                        onClick={handleCreateNew}\r\n                        className=\"bg-slate-800/40 backdrop-blur-sm border-2 border-dashed border-slate-600 rounded-2xl p-6 flex flex-col items-center justify-center min-h-[280px] hover:border-purple-500 hover:bg-slate-800/60 transition-all group\"\r\n                        initial={{ opacity: 0, scale: 0.9 }}\r\n                        animate={{ opacity: 1, scale: 1 }}\r\n                        whileHover={{ scale: 1.02 }}\r\n                        whileTap={{ scale: 0.98 }}\r\n                    >\r\n                        <div className=\"w-16 h-16 bg-slate-700 group-hover:bg-purple-500/20 rounded-full flex items-center justify-center mb-4 transition-colors\">\r\n                            <Plus className=\"w-8 h-8 text-slate-400 group-hover:text-purple-400 transition-colors\" />\r\n                        </div>\r\n                        <h3 className=\"text-lg font-semibold text-slate-300 group-hover:text-white transition-colors\">\r\n                            New Skill Tree\r\n                        </h3>\r\n                        <p className=\"text-sm text-slate-500 mt-1\">Start a new learning adventure</p>\r\n                    </motion.button>\r\n\r\n                    {/* Existing Games */}\r\n                    {games.map((game, index) => {\r\n                        const progress = getProgressPercentage(game);\r\n                        const stars = getTotalStars(game);\r\n                        const maxStars = getMaxStars(game);\r\n                        const completedLevels = game.levels?.filter(l => l.status === 'completed').length || 0;\r\n                        const totalLevels = game.levels?.length || 0;\r\n\r\n                        return (\r\n                            <motion.div\r\n                                key={game._id}\r\n                                className=\"bg-slate-800/60 backdrop-blur-sm rounded-2xl overflow-hidden border border-slate-700/50 hover:border-purple-500/50 transition-all group\"\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: index * 0.1 }}\r\n                            >\r\n                                {/* Card Header - Topic Color */}\r\n                                <div className=\"h-24 bg-gradient-to-br from-purple-600 via-pink-500 to-orange-500 relative\">\r\n                                    <div className=\"absolute inset-0 bg-black/20\" />\r\n                                    <div className=\"absolute bottom-3 left-4\">\r\n                                        <span className=\"px-3 py-1 bg-black/30 backdrop-blur-sm rounded-full text-xs font-medium text-white\">\r\n                                            {game.assessmentResult?.level || 'Beginner'}\r\n                                        </span>\r\n                                    </div>\r\n                                    {/* Delete button */}\r\n                                    <button\r\n                                        onClick={(e) => {\r\n                                            e.stopPropagation();\r\n                                            setDeleteConfirm(game._id);\r\n                                        }}\r\n                                        className=\"absolute top-3 right-3 p-2 bg-black/30 hover:bg-red-500/80 rounded-lg opacity-0 group-hover:opacity-100 transition-all\"\r\n                                    >\r\n                                        <Trash2 className=\"w-4 h-4 text-white\" />\r\n                                    </button>\r\n                                </div>\r\n\r\n                                {/* Card Content */}\r\n                                <div className=\"p-5\">\r\n                                    <h3 className=\"text-xl font-bold text-white mb-1 truncate capitalize\">\r\n                                        {formatTopic(game.topic)}\r\n                                    </h3>\r\n                                    <p className=\"text-sm text-slate-400 mb-4 flex items-center gap-2\">\r\n                                        <Clock className=\"w-4 h-4\" />\r\n                                        {new Date(game.updatedAt || game.createdAt).toLocaleDateString()}\r\n                                    </p>\r\n\r\n                                    {/* Progress Bar */}\r\n                                    <div className=\"mb-4\">\r\n                                        <div className=\"flex justify-between text-xs text-slate-400 mb-1\">\r\n                                            <span>Progress</span>\r\n                                            <span>{progress}%</span>\r\n                                        </div>\r\n                                        <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\r\n                                            <motion.div\r\n                                                className=\"h-full bg-gradient-to-r from-purple-500 to-pink-500\"\r\n                                                initial={{ width: 0 }}\r\n                                                animate={{ width: `${progress}%` }}\r\n                                                transition={{ delay: 0.3 }}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Stats */}\r\n                                    <div className=\"flex items-center justify-between mb-4\">\r\n                                        <div className=\"flex items-center gap-1 text-sm\">\r\n                                            <Target className=\"w-4 h-4 text-blue-400\" />\r\n                                            <span className=\"text-slate-300\">{completedLevels}/{totalLevels}</span>\r\n                                            <span className=\"text-slate-500\">levels</span>\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-1 text-sm\">\r\n                                            <Star className=\"w-4 h-4 text-yellow-400 fill-yellow-400\" />\r\n                                            <span className=\"text-slate-300\">{stars}/{maxStars}</span>\r\n                                        </div>\r\n                                    </div>\r\n\r\n                                    {/* Play Button */}\r\n                                    <motion.button\r\n                                        onClick={() => handlePlayGame(game)}\r\n                                        className=\"w-full py-3 bg-gradient-to-r from-purple-600 to-pink-500 hover:from-purple-500 hover:to-pink-400 rounded-xl font-semibold text-white flex items-center justify-center gap-2 transition-all\"\r\n                                        whileHover={{ scale: 1.02 }}\r\n                                        whileTap={{ scale: 0.98 }}\r\n                                    >\r\n                                        <Play className=\"w-5 h-5\" />\r\n                                        {progress > 0 ? 'Continue' : 'Start'}\r\n                                    </motion.button>\r\n                                </div>\r\n                            </motion.div>\r\n                        );\r\n                    })}\r\n                </div>\r\n\r\n                {/* Empty State */}\r\n                {games.length === 0 && (\r\n                    <motion.div\r\n                        className=\"text-center py-12\"\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        transition={{ delay: 0.3 }}\r\n                    >\r\n                        <BookOpen className=\"w-16 h-16 text-slate-600 mx-auto mb-4\" />\r\n                        <h3 className=\"text-xl font-semibold text-slate-400 mb-2\">No skill trees yet</h3>\r\n                        <p className=\"text-slate-500 mb-6\">Create your first skill tree to start learning!</p>\r\n                    </motion.div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Delete Confirmation Modal */}\r\n            <AnimatePresence>\r\n                {deleteConfirm && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4\"\r\n                        onClick={() => setDeleteConfirm(null)}\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.9, opacity: 0 }}\r\n                            animate={{ scale: 1, opacity: 1 }}\r\n                            exit={{ scale: 0.9, opacity: 0 }}\r\n                            className=\"bg-slate-800 rounded-2xl p-6 max-w-sm w-full border border-slate-700\"\r\n                            onClick={e => e.stopPropagation()}\r\n                        >\r\n                            <h3 className=\"text-xl font-bold text-white mb-2\">Delete Skill Tree?</h3>\r\n                            <p className=\"text-slate-400 mb-6\">\r\n                                This will permanently delete all your progress in this skill tree. This action cannot be undone.\r\n                            </p>\r\n                            <div className=\"flex gap-3\">\r\n                                <button\r\n                                    onClick={() => setDeleteConfirm(null)}\r\n                                    className=\"flex-1 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-semibold text-white transition-colors\"\r\n                                >\r\n                                    Cancel\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => handleDeleteGame(deleteConfirm)}\r\n                                    className=\"flex-1 py-3 bg-red-500 hover:bg-red-600 rounded-xl font-semibold text-white transition-colors\"\r\n                                >\r\n                                    Delete\r\n                                </button>\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkillTreeGames;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillTreeLanding.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[51,58],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { \r\n    Gamepad2, MapPin, Star, \r\n    ChevronRight, Sparkles, BookOpen, ArrowLeft,\r\n    Brain, Loader2, CheckCircle2, MessageCircle\r\n} from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SkillTreeLanding = () => {\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n    const hasGames = location.state?.hasGames ?? false;\r\n    const [isHovering, setIsHovering] = useState(false);\r\n    const [step, setStep] = useState('start'); // 'start', 'topic', 'assessment', 'complete'\r\n    const [topic, setTopic] = useState('');\r\n    const [questions, setQuestions] = useState([]);\r\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n    const [answers, setAnswers] = useState([]);\r\n    const [currentAnswer, setCurrentAnswer] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n    const [assessmentResult, setAssessmentResult] = useState(null);\r\n\r\n    const handleStartGame = () => {\r\n        setStep('topic');\r\n    };\r\n\r\n    const handleNext = async () => {\r\n        if (topic.trim()) {\r\n            setLoading(true);\r\n            try {\r\n                const token = localStorage.getItem('authToken');\r\n                const response = await axios.post(\r\n                    `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/diagnostic`,\r\n                    { topic: topic.trim() },\r\n                    { headers: { Authorization: `Bearer ${token}` } }\r\n                );\r\n                const questions = response.data.questions || [];\r\n                if (questions.length > 0) {\r\n                    setQuestions(questions);\r\n                    setStep('assessment');\r\n                } else {\r\n                    // No questions returned - skip assessment\r\n                    toast.info('Skipping assessment - starting as Beginner');\r\n                    proceedWithoutAssessment();\r\n                }\r\n            } catch (error) {\r\n                console.error('[SkillTreeLanding] Error generating questions:', error);\r\n                toast.info('Skipping assessment - starting as Beginner');\r\n                // Fallback: proceed directly to map without assessment\r\n                proceedWithoutAssessment();\r\n            } finally {\r\n                setLoading(false);\r\n            }\r\n        }\r\n    };\r\n\r\n    const proceedWithoutAssessment = () => {\r\n        // Navigate directly to map with beginner assessment\r\n        navigate('/gamification/skill-tree/map', { \r\n            state: { \r\n                topic: topic.trim(),\r\n                assessmentResult: { level: 'Beginner', summary: 'Starting fresh!' }\r\n            }\r\n        });\r\n    };\r\n\r\n    const handleAnswerSubmit = () => {\r\n        if (!currentAnswer.trim()) return;\r\n\r\n        const newAnswers = [...answers, { \r\n            question: questions[currentQuestionIndex].question,\r\n            answer: currentAnswer.trim() \r\n        }];\r\n        setAnswers(newAnswers);\r\n        setCurrentAnswer('');\r\n\r\n        if (currentQuestionIndex < questions.length - 1) {\r\n            setCurrentQuestionIndex(currentQuestionIndex + 1);\r\n        } else {\r\n            // All questions answered - submit assessment\r\n            submitAssessment(newAnswers);\r\n        }\r\n    };\r\n\r\n    const submitAssessment = async (finalAnswers) => {\r\n        setLoading(true);\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.post(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree/diagnostic/submit`,\r\n                { \r\n                    topic: topic.trim(),\r\n                    answers: finalAnswers \r\n                },\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setAssessmentResult(response.data);\r\n            setStep('complete');\r\n        } catch (error) {\r\n            console.error('[SkillTreeLanding] Error submitting assessment:', error);\r\n            toast.error('Failed to analyze responses');\r\n            // Proceed anyway - go to games page with new game data\r\n            navigate('/gamification/skill-tree', { \r\n                state: { \r\n                    newGame: {\r\n                        topic: topic.trim(), \r\n                        assessmentResult: { level: 'Beginner' },\r\n                        answers: finalAnswers\r\n                    }\r\n                } \r\n            });\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleProceedToMap = () => {\r\n        // Navigate to games page with new game data\r\n        navigate('/gamification/skill-tree', { \r\n            state: { \r\n                newGame: {\r\n                    topic: topic.trim(), \r\n                    assessmentResult,\r\n                    answers\r\n                }\r\n            } \r\n        });\r\n    };\r\n\r\n    const handleBack = () => {\r\n        if (step === 'topic') {\r\n            setStep('start');\r\n            setTopic('');\r\n        } else if (step === 'assessment') {\r\n            setStep('topic');\r\n            setQuestions([]);\r\n            setCurrentQuestionIndex(0);\r\n            setAnswers([]);\r\n            setCurrentAnswer('');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen max-h-screen overflow-y-auto bg-gradient-to-b from-slate-900 via-slate-800 to-slate-900 p-6\">\r\n            <div className=\"max-w-4xl mx-auto pb-20\">\r\n                {/* Back Button */}\r\n                <motion.button\r\n                    onClick={() => navigate(hasGames ? '/gamification/skill-tree' : '/')}\r\n                    className=\"flex items-center gap-2 text-slate-400 hover:text-white transition-colors mb-6\"\r\n                    initial={{ opacity: 0, x: -20 }}\r\n                    animate={{ opacity: 1, x: 0 }}\r\n                    whileHover={{ x: -5 }}\r\n                >\r\n                    <ArrowLeft className=\"w-5 h-5\" />\r\n                    <span>Back</span>\r\n                </motion.button>\r\n\r\n                {/* Hero Section */}\r\n                <motion.div\r\n                    className=\"text-center mb-12\"\r\n                    initial={{ opacity: 0, y: -20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ duration: 0.6 }}\r\n                >\r\n                    {/* Animated Icon */}\r\n                    <motion.div\r\n                        className=\"relative inline-block mb-6\"\r\n                        animate={{ \r\n                            rotate: [0, 5, -5, 0],\r\n                        }}\r\n                        transition={{ \r\n                            duration: 4, \r\n                            repeat: Infinity,\r\n                            ease: \"easeInOut\"\r\n                        }}\r\n                    >\r\n                        <div className=\"w-24 h-24 bg-gradient-to-br from-blue-500 via-cyan-400 to-emerald-400 rounded-2xl flex items-center justify-center shadow-2xl shadow-blue-500/30\">\r\n                            <MapPin className=\"w-12 h-12 text-white\" />\r\n                        </div>\r\n                        {/* Floating particles */}\r\n                        <motion.div\r\n                            className=\"absolute -top-2 -right-2\"\r\n                            animate={{ y: [-5, 5, -5], opacity: [0.5, 1, 0.5] }}\r\n                            transition={{ duration: 2, repeat: Infinity }}\r\n                        >\r\n                            <Sparkles className=\"w-6 h-6 text-yellow-400\" />\r\n                        </motion.div>\r\n                        <motion.div\r\n                            className=\"absolute -bottom-1 -left-2\"\r\n                            animate={{ y: [5, -5, 5], opacity: [0.7, 1, 0.7] }}\r\n                            transition={{ duration: 2.5, repeat: Infinity }}\r\n                        >\r\n                            <Star className=\"w-5 h-5 text-cyan-400\" />\r\n                        </motion.div>\r\n                    </motion.div>\r\n\r\n                    <h1 className=\"text-4xl md:text-5xl font-bold text-white mb-4\">\r\n                        Skill Tree\r\n                        <span className=\"text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-cyan-400\"> Adventure</span>\r\n                    </h1>\r\n                    <p className=\"text-lg text-slate-400 max-w-2xl mx-auto\">\r\n                        Embark on your learning journey! Explore the fog of war, unlock new skills, \r\n                        and master topics to reveal the complete knowledge map.\r\n                    </p>\r\n                </motion.div>\r\n\r\n                <AnimatePresence mode=\"wait\">\r\n                    {step === 'start' && (\r\n                        /* Start Game Button */\r\n                        <motion.div\r\n                            key=\"start-button\"\r\n                            className=\"flex justify-center mb-12\"\r\n                            initial={{ opacity: 0, scale: 0.9 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            exit={{ opacity: 0, scale: 0.9 }}\r\n                            transition={{ delay: 0.4 }}\r\n                        >\r\n                            <motion.button\r\n                                onClick={handleStartGame}\r\n                                onMouseEnter={() => setIsHovering(true)}\r\n                                onMouseLeave={() => setIsHovering(false)}\r\n                                className=\"relative group px-12 py-5 bg-gradient-to-r from-blue-600 via-cyan-500 to-emerald-500 rounded-2xl font-bold text-xl text-white shadow-2xl shadow-blue-500/30 overflow-hidden\"\r\n                                whileHover={{ scale: 1.05 }}\r\n                                whileTap={{ scale: 0.98 }}\r\n                            >\r\n                                {/* Animated background */}\r\n                                <motion.div\r\n                                    className=\"absolute inset-0 bg-gradient-to-r from-blue-400 via-cyan-400 to-emerald-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300\"\r\n                                />\r\n                                \r\n                                {/* Shine effect */}\r\n                                <motion.div\r\n                                    className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -skew-x-12\"\r\n                                    initial={{ x: '-200%' }}\r\n                                    animate={isHovering ? { x: '200%' } : { x: '-200%' }}\r\n                                    transition={{ duration: 0.8 }}\r\n                                />\r\n\r\n                                {/* Button content */}\r\n                                <span className=\"relative flex items-center gap-3\">\r\n                                    <Gamepad2 className=\"w-7 h-7\" />\r\n                                    Start the Game\r\n                                    <motion.span\r\n                                        animate={{ x: [0, 5, 0] }}\r\n                                        transition={{ duration: 1, repeat: Infinity }}\r\n                                    >\r\n                                        <ChevronRight className=\"w-6 h-6\" />\r\n                                    </motion.span>\r\n                                </span>\r\n                            </motion.button>\r\n                        </motion.div>\r\n                    )}\r\n\r\n                    {step === 'topic' && (\r\n                        /* Topic Input Section */\r\n                        <motion.div\r\n                            key=\"topic-input\"\r\n                            className=\"max-w-xl mx-auto mb-12\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            exit={{ opacity: 0, y: -20 }}\r\n                            transition={{ duration: 0.4 }}\r\n                        >\r\n                            <div className=\"bg-slate-800/60 backdrop-blur-sm rounded-2xl p-8 border border-slate-700/50\">\r\n                                <div className=\"flex items-center gap-3 mb-6\">\r\n                                    <div className=\"w-12 h-12 bg-gradient-to-br from-blue-500 to-cyan-400 rounded-xl flex items-center justify-center\">\r\n                                        <BookOpen className=\"w-6 h-6 text-white\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-xl font-semibold text-white\">Choose Your Topic</h3>\r\n                                        <p className=\"text-sm text-slate-400\">Enter a course or topic to explore</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={topic}\r\n                                    onChange={(e) => setTopic(e.target.value)}\r\n                                    onKeyDown={(e) => e.key === 'Enter' && !loading && handleNext()}\r\n                                    className=\"w-full px-5 py-4 bg-slate-900/50 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-cyan-500 focus:ring-2 focus:ring-cyan-500/20 transition-all text-lg\"\r\n                                    autoFocus\r\n                                    disabled={loading}\r\n                                />\r\n\r\n                                <div className=\"flex gap-4 mt-6\">\r\n                                    <motion.button\r\n                                        onClick={handleBack}\r\n                                        disabled={loading}\r\n                                        className=\"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-semibold text-slate-300 flex items-center justify-center gap-2 transition-colors disabled:opacity-50\"\r\n                                        whileHover={{ scale: 1.02 }}\r\n                                        whileTap={{ scale: 0.98 }}\r\n                                    >\r\n                                        <ArrowLeft className=\"w-5 h-5\" />\r\n                                        Back\r\n                                    </motion.button>\r\n                                    <motion.button\r\n                                        onClick={handleNext}\r\n                                        disabled={!topic.trim() || loading}\r\n                                        className={`flex-1 px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 transition-all ${\r\n                                            topic.trim() && !loading\r\n                                                ? 'bg-gradient-to-r from-blue-600 to-cyan-500 text-white shadow-lg shadow-blue-500/30'\r\n                                                : 'bg-slate-700 text-slate-500 cursor-not-allowed'\r\n                                        }`}\r\n                                        whileHover={topic.trim() && !loading ? { scale: 1.02 } : {}}\r\n                                        whileTap={topic.trim() && !loading ? { scale: 0.98 } : {}}\r\n                                    >\r\n                                        {loading ? (\r\n                                            <>\r\n                                                <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                                                Preparing...\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                Next\r\n                                                <ChevronRight className=\"w-5 h-5\" />\r\n                                            </>\r\n                                        )}\r\n                                    </motion.button>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    )}\r\n\r\n                    {step === 'assessment' && (\r\n                        /* Socratic Assessment Section */\r\n                        <motion.div\r\n                            key=\"assessment\"\r\n                            className=\"max-w-2xl mx-auto mb-12\"\r\n                            initial={{ opacity: 0, y: 20 }}\r\n                            animate={{ opacity: 1, y: 0 }}\r\n                            exit={{ opacity: 0, y: -20 }}\r\n                            transition={{ duration: 0.4 }}\r\n                        >\r\n                            <div className=\"bg-slate-800/60 backdrop-blur-sm rounded-2xl p-8 border border-slate-700/50\">\r\n                                {/* Header */}\r\n                                <div className=\"flex items-center gap-3 mb-6\">\r\n                                    <div className=\"w-12 h-12 bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center\">\r\n                                        <Brain className=\"w-6 h-6 text-white\" />\r\n                                    </div>\r\n                                    <div>\r\n                                        <h3 className=\"text-xl font-semibold text-white\">Knowledge Assessment</h3>\r\n                                        <p className=\"text-sm text-slate-400\">Let's understand your current knowledge of {topic}</p>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Progress */}\r\n                                <div className=\"mb-6\">\r\n                                    <div className=\"flex items-center justify-between text-sm text-slate-400 mb-2\">\r\n                                        <span>Question {currentQuestionIndex + 1} of {questions.length}</span>\r\n                                        <span>{Math.round(((currentQuestionIndex) / questions.length) * 100)}% complete</span>\r\n                                    </div>\r\n                                    <div className=\"h-2 bg-slate-700 rounded-full overflow-hidden\">\r\n                                        <motion.div\r\n                                            className=\"h-full bg-gradient-to-r from-purple-500 to-pink-500\"\r\n                                            initial={{ width: 0 }}\r\n                                            animate={{ width: `${((currentQuestionIndex) / questions.length) * 100}%` }}\r\n                                            transition={{ duration: 0.3 }}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Question */}\r\n                                {questions[currentQuestionIndex] && (\r\n                                    <motion.div\r\n                                        key={currentQuestionIndex}\r\n                                        initial={{ opacity: 0, x: 20 }}\r\n                                        animate={{ opacity: 1, x: 0 }}\r\n                                        className=\"mb-6\"\r\n                                    >\r\n                                        <div className=\"flex items-start gap-3 mb-4\">\r\n                                            <MessageCircle className=\"w-5 h-5 text-purple-400 mt-1 shrink-0\" />\r\n                                            <p className=\"text-lg text-white leading-relaxed\">\r\n                                                {questions[currentQuestionIndex].question}\r\n                                            </p>\r\n                                        </div>\r\n                                        \r\n                                        <textarea\r\n                                            value={currentAnswer}\r\n                                            onChange={(e) => setCurrentAnswer(e.target.value)}\r\n                                            onKeyDown={(e) => {\r\n                                                if (e.key === 'Enter' && !e.shiftKey && !loading) {\r\n                                                    e.preventDefault();\r\n                                                    handleAnswerSubmit();\r\n                                                }\r\n                                            }}\r\n                                            placeholder=\"Share your thoughts... (Press Enter to submit)\"\r\n                                            className=\"w-full px-5 py-4 bg-slate-900/50 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 transition-all resize-none\"\r\n                                            rows={4}\r\n                                            autoFocus\r\n                                            disabled={loading}\r\n                                        />\r\n                                    </motion.div>\r\n                                )}\r\n\r\n                                {/* Buttons */}\r\n                                <div className=\"flex gap-4\">\r\n                                    <motion.button\r\n                                        onClick={handleBack}\r\n                                        disabled={loading}\r\n                                        className=\"px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-semibold text-slate-300 flex items-center justify-center gap-2 transition-colors disabled:opacity-50\"\r\n                                        whileHover={{ scale: 1.02 }}\r\n                                        whileTap={{ scale: 0.98 }}\r\n                                    >\r\n                                        <ArrowLeft className=\"w-5 h-5\" />\r\n                                        Back\r\n                                    </motion.button>\r\n                                    <motion.button\r\n                                        onClick={handleAnswerSubmit}\r\n                                        disabled={!currentAnswer.trim() || loading}\r\n                                        className={`flex-1 px-6 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 transition-all ${\r\n                                            currentAnswer.trim() && !loading\r\n                                                ? 'bg-gradient-to-r from-purple-600 to-pink-500 text-white shadow-lg shadow-purple-500/30'\r\n                                                : 'bg-slate-700 text-slate-500 cursor-not-allowed'\r\n                                        }`}\r\n                                        whileHover={currentAnswer.trim() && !loading ? { scale: 1.02 } : {}}\r\n                                        whileTap={currentAnswer.trim() && !loading ? { scale: 0.98 } : {}}\r\n                                    >\r\n                                        {loading ? (\r\n                                            <>\r\n                                                <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                                                Analyzing...\r\n                                            </>\r\n                                        ) : currentQuestionIndex < questions.length - 1 ? (\r\n                                            <>\r\n                                                Next Question\r\n                                                <ChevronRight className=\"w-5 h-5\" />\r\n                                            </>\r\n                                        ) : (\r\n                                            <>\r\n                                                Complete Assessment\r\n                                                <CheckCircle2 className=\"w-5 h-5\" />\r\n                                            </>\r\n                                        )}\r\n                                    </motion.button>\r\n                                </div>\r\n                            </div>\r\n                        </motion.div>\r\n                    )}\r\n\r\n                    {step === 'complete' && (\r\n                        /* Assessment Complete Section */\r\n                        <motion.div\r\n                            key=\"complete\"\r\n                            className=\"max-w-xl mx-auto mb-12\"\r\n                            initial={{ opacity: 0, scale: 0.9 }}\r\n                            animate={{ opacity: 1, scale: 1 }}\r\n                            transition={{ duration: 0.4 }}\r\n                        >\r\n                            <div className=\"bg-slate-800/60 backdrop-blur-sm rounded-2xl p-8 border border-slate-700/50 text-center\">\r\n                                <motion.div\r\n                                    initial={{ scale: 0 }}\r\n                                    animate={{ scale: 1 }}\r\n                                    transition={{ type: 'spring', delay: 0.2 }}\r\n                                    className=\"w-20 h-20 bg-gradient-to-br from-emerald-500 to-cyan-500 rounded-full flex items-center justify-center mx-auto mb-6\"\r\n                                >\r\n                                    <CheckCircle2 className=\"w-10 h-10 text-white\" />\r\n                                </motion.div>\r\n\r\n                                <h3 className=\"text-2xl font-bold text-white mb-2\">Assessment Complete!</h3>\r\n                                <p className=\"text-slate-400 mb-6\">\r\n                                    We've analyzed your responses and prepared a personalized skill tree for <span className=\"text-cyan-400 font-semibold\">{topic}</span>\r\n                                </p>\r\n\r\n                                {assessmentResult && (\r\n                                    <div className=\"bg-slate-900/50 rounded-xl p-4 mb-6 text-left\">\r\n                                        <p className=\"text-sm text-slate-400 mb-2\">Your starting level:</p>\r\n                                        <p className=\"text-lg font-semibold text-white\">{assessmentResult.level || 'Beginner'}</p>\r\n                                        {assessmentResult.summary && (\r\n                                            <p className=\"text-sm text-slate-400 mt-2\">{assessmentResult.summary}</p>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n\r\n                                <motion.button\r\n                                    onClick={handleProceedToMap}\r\n                                    className=\"w-full px-8 py-4 bg-gradient-to-r from-blue-600 via-cyan-500 to-emerald-500 rounded-xl font-bold text-lg text-white shadow-xl shadow-blue-500/30 flex items-center justify-center gap-3\"\r\n                                    whileHover={{ scale: 1.02 }}\r\n                                    whileTap={{ scale: 0.98 }}\r\n                                >\r\n                                    <MapPin className=\"w-6 h-6\" />\r\n                                    Explore Your Skill Tree\r\n                                    <ChevronRight className=\"w-6 h-6\" />\r\n                                </motion.button>\r\n                            </div>\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n\r\n                {/* Instructions */}\r\n                <motion.div\r\n                    className=\"bg-slate-800/30 backdrop-blur-sm rounded-xl p-6 border border-slate-700/50\"\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    transition={{ delay: 0.6 }}\r\n                >\r\n                    <h3 className=\"text-lg font-semibold text-white mb-4 flex items-center gap-2\">\r\n                        <Gamepad2 className=\"w-5 h-5 text-blue-400\" />\r\n                        How to Play\r\n                    </h3>\r\n                    <ul className=\"space-y-3 text-sm text-slate-400\">\r\n                        <li className=\"flex items-start gap-3\">\r\n                            <span className=\"w-6 h-6 bg-blue-500/20 rounded-full flex items-center justify-center text-blue-400 text-xs font-bold shrink-0\">1</span>\r\n                            <span>Enter a <strong className=\"text-slate-300\">topic you want to learn</strong> and complete a quick assessment</span>\r\n                        </li>\r\n                        <li className=\"flex items-start gap-3\">\r\n                            <span className=\"w-6 h-6 bg-cyan-500/20 rounded-full flex items-center justify-center text-cyan-400 text-xs font-bold shrink-0\">2</span>\r\n                            <span>AI generates <strong className=\"text-cyan-400\">personalized levels</strong> based on your knowledge level</span>\r\n                        </li>\r\n                        <li className=\"flex items-start gap-3\">\r\n                            <span className=\"w-6 h-6 bg-emerald-500/20 rounded-full flex items-center justify-center text-emerald-400 text-xs font-bold shrink-0\">3</span>\r\n                            <span>Complete quiz levels to <strong className=\"text-emerald-400\">earn stars</strong> (â­50%, â­â­70%, â­â­â­90%) and unlock the next level</span>\r\n                        </li>\r\n                        <li className=\"flex items-start gap-3\">\r\n                            <span className=\"w-6 h-6 bg-yellow-500/20 rounded-full flex items-center justify-center text-yellow-400 text-xs font-bold shrink-0\">4</span>\r\n                            <span>Earn <strong className=\"text-yellow-400\">XP rewards</strong> on first completion: â­5xp, â­â­8xp, â­â­â­10xp</span>\r\n                        </li>\r\n                    </ul>\r\n                </motion.div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkillTreeLanding;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillTreeMap.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":1,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[43,56],"text":""},"desc":"Remove unused variable 'useCallback'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[83,90],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'renderSkillTree' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":139,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":139,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"renderSkillTree"},"fix":{"range":[5230,6266],"text":""},"desc":"Remove unused variable 'renderSkillTree'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport {\r\n    Lock, Unlock, CheckCircle2, Zap, TrendingUp, ChevronRight,\r\n    BarChart3, Eye, EyeOff, MapPin, AlertCircle\r\n} from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\nimport SkillAssessmentModal from './SkillAssessmentModal';\r\n\r\nconst SkillTreeMap = () => {\r\n    const canvasRef = useRef(null);\r\n    const [skillTree, setSkillTree] = useState([]);\r\n    const [selectedSkill, setSelectedSkill] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [hoveredSkill, setHoveredSkill] = useState(null);\r\n    const [viewMode, setViewMode] = useState('fog'); // 'fog' or 'detail'\r\n    const [zoomLevel, setZoomLevel] = useState(1);\r\n    const [panOffset, setPanOffset] = useState({ x: 0, y: 0 });\r\n    const [isDragging, setIsDragging] = useState(false);\r\n    const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\r\n    const [showAssessment, setShowAssessment] = useState(false);\r\n\r\n    // Fetch skill tree data\r\n    useEffect(() => {\r\n        fetchSkillTree();\r\n    }, []);\r\n\r\n    const fetchSkillTree = async () => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.get(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/skill-tree`,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n            setSkillTree(response.data.skillTree || []);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('[SkillTreeMap] Error fetching skill tree:', error);\r\n            toast.error('Failed to load skill tree');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Calculate visual properties for a skill node based on its state\r\n    const getNodeVisuals = (skill) => {\r\n        const baseColors = {\r\n            locked: { bg: '#1f2937', border: '#374151', text: '#9ca3af', glow: 'rgba(31, 41, 55, 0.5)' },\r\n            unlocked: { bg: '#1e40af', border: '#3b82f6', text: '#93c5fd', glow: 'rgba(59, 130, 246, 0.3)' },\r\n            mastered: { bg: '#059669', border: '#10b981', text: '#6ee7b7', glow: 'rgba(16, 185, 129, 0.5)' }\r\n        };\r\n\r\n        const state = skill.status === 'mastered' ? 'mastered' : \r\n                     skill.status === 'unlocked' ? 'unlocked' : 'locked';\r\n\r\n        return {\r\n            ...baseColors[state],\r\n            state,\r\n            opacity: skill.status === 'locked' ? 0.5 : 1,\r\n            scale: hoveredSkill === skill.skillId ? 1.1 : 1\r\n        };\r\n    };\r\n\r\n    // Handle zoom\r\n    const handleWheel = (e) => {\r\n        e.preventDefault();\r\n        const newZoom = e.deltaY < 0 ? zoomLevel * 1.1 : zoomLevel / 1.1;\r\n        setZoomLevel(Math.max(0.5, Math.min(3, newZoom)));\r\n    };\r\n\r\n    // Handle pan\r\n    const handleMouseDown = (e) => {\r\n        if (e.button === 2) { // Right mouse button for panning\r\n            setIsDragging(true);\r\n            setDragStart({ x: e.clientX - panOffset.x, y: e.clientY - panOffset.y });\r\n        }\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n        if (isDragging) {\r\n            setPanOffset({\r\n                x: e.clientX - dragStart.x,\r\n                y: e.clientY - dragStart.y\r\n            });\r\n        }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n        setIsDragging(false);\r\n    };\r\n\r\n    // Calculate node position on canvas\r\n    const getNodePosition = (skill) => {\r\n        const canvasWidth = canvasRef.current?.clientWidth || 1000;\r\n        const canvasHeight = canvasRef.current?.clientHeight || 600;\r\n\r\n        // Normalize position to canvas size\r\n        const x = (skill.position.x / 100) * canvasWidth * zoomLevel + panOffset.x;\r\n        const y = (skill.position.y / 100) * canvasHeight * zoomLevel + panOffset.y;\r\n\r\n        return { x, y };\r\n    };\r\n\r\n    // Draw edges between skills (connections)\r\n    const drawEdges = () => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const ctx = canvasRef.current.getContext('2d');\r\n        ctx.strokeStyle = 'rgba(107, 114, 128, 0.3)';\r\n        ctx.lineWidth = 2;\r\n\r\n        skillTree.forEach((skill) => {\r\n            const { x: x1, y: y1 } = getNodePosition(skill);\r\n\r\n            skill.prerequisites?.forEach((prereqId) => {\r\n                const prereq = skillTree.find(s => s.skillId === prereqId);\r\n                if (prereq) {\r\n                    const { x: x2, y: y2 } = getNodePosition(prereq);\r\n\r\n                    // Dashed line for unlocked skills\r\n                    if (skill.status === 'unlocked' || skill.status === 'mastered') {\r\n                        ctx.setLineDash([5, 5]);\r\n                        ctx.strokeStyle = 'rgba(59, 130, 246, 0.4)';\r\n                    } else {\r\n                        ctx.setLineDash([]);\r\n                        ctx.strokeStyle = 'rgba(107, 114, 128, 0.2)';\r\n                    }\r\n\r\n                    ctx.beginPath();\r\n                    ctx.moveTo(x1, y1);\r\n                    ctx.lineTo(x2, y2);\r\n                    ctx.stroke();\r\n                }\r\n            });\r\n        });\r\n    };\r\n\r\n    // Render the canvas-based skill tree\r\n    const renderSkillTree = () => {\r\n        if (!canvasRef.current) return;\r\n\r\n        const ctx = canvasRef.current.getContext('2d');\r\n        const rect = canvasRef.current.getBoundingClientRect();\r\n        canvasRef.current.width = rect.width;\r\n        canvasRef.current.height = rect.height;\r\n\r\n        // Clear canvas with fog effect\r\n        ctx.fillStyle = 'rgba(15, 23, 42, 0.95)';\r\n        ctx.fillRect(0, 0, rect.width, rect.height);\r\n\r\n        // Draw grid for reference\r\n        ctx.strokeStyle = 'rgba(107, 114, 128, 0.1)';\r\n        ctx.lineWidth = 1;\r\n        for (let i = 0; i < rect.width; i += 50) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(i, 0);\r\n            ctx.lineTo(i, rect.height);\r\n            ctx.stroke();\r\n        }\r\n        for (let i = 0; i < rect.height; i += 50) {\r\n            ctx.beginPath();\r\n            ctx.moveTo(0, i);\r\n            ctx.lineTo(rect.width, i);\r\n            ctx.stroke();\r\n        }\r\n\r\n        // Draw edges first (so they appear behind nodes)\r\n        drawEdges();\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-screen bg-slate-900\">\r\n                <div className=\"text-center\">\r\n                    <Zap className=\"w-12 h-12 text-blue-500 animate-spin mx-auto mb-4\" />\r\n                    <p className=\"text-slate-300\">Loading Skill Tree...</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"w-full h-screen flex flex-col bg-slate-950 text-slate-100\">\r\n            {/* Header */}\r\n            <div className=\"bg-gradient-to-r from-slate-800 to-slate-900 border-b border-slate-700 p-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <MapPin className=\"w-6 h-6 text-blue-400\" />\r\n                        <div>\r\n                            <h1 className=\"text-2xl font-bold text-slate-100\">Skill Tree Map</h1>\r\n                            <p className=\"text-sm text-slate-400\">Explore and master new skills</p>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-4\">\r\n                        <button\r\n                            onClick={() => setViewMode(viewMode === 'fog' ? 'detail' : 'fog')}\r\n                            className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 transition-colors\"\r\n                        >\r\n                            {viewMode === 'fog' ? (\r\n                                <><EyeOff className=\"w-4 h-4\" /> Fog Mode</>\r\n                            ) : (\r\n                                <><Eye className=\"w-4 h-4\" /> Detail Mode</>\r\n                            )}\r\n                        </button>\r\n                        <button\r\n                            onClick={() => { setZoomLevel(1); setPanOffset({ x: 0, y: 0 }); }}\r\n                            className=\"px-4 py-2 rounded-lg bg-slate-700 hover:bg-slate-600 transition-colors text-sm\"\r\n                        >\r\n                            Reset View\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Main Content */}\r\n            <div className=\"flex flex-1 gap-4 overflow-hidden p-4\">\r\n                {/* Canvas View */}\r\n                <div className=\"flex-1 relative bg-gradient-to-b from-slate-900 to-slate-950 rounded-lg overflow-hidden border border-slate-700\">\r\n                    <canvas\r\n                        ref={canvasRef}\r\n                        className=\"w-full h-full cursor-grab active:cursor-grabbing\"\r\n                        onWheel={handleWheel}\r\n                        onMouseDown={handleMouseDown}\r\n                        onMouseMove={handleMouseMove}\r\n                        onMouseUp={handleMouseUp}\r\n                        onMouseLeave={handleMouseUp}\r\n                        onContextMenu={(e) => e.preventDefault()}\r\n                    />\r\n\r\n                    {/* Skill Nodes Overlay */}\r\n                    {skillTree.map((skill) => {\r\n                        const { x, y } = getNodePosition(skill);\r\n                        const visuals = getNodeVisuals(skill);\r\n                        const nodeSize = 60;\r\n\r\n                        return (\r\n                            <motion.div\r\n                                key={skill.skillId}\r\n                                className=\"absolute\"\r\n                                style={{\r\n                                    left: `${x - nodeSize / 2}px`,\r\n                                    top: `${y - nodeSize / 2}px`,\r\n                                    width: nodeSize,\r\n                                    height: nodeSize\r\n                                }}\r\n                                onMouseEnter={() => setHoveredSkill(skill.skillId)}\r\n                                onMouseLeave={() => setHoveredSkill(null)}\r\n                                onClick={() => setSelectedSkill(skill)}\r\n                            >\r\n                                <motion.div\r\n                                    animate={{ scale: visuals.scale }}\r\n                                    whileHover={{ scale: 1.15 }}\r\n                                    transition={{ type: 'spring', stiffness: 300, damping: 30 }}\r\n                                    className=\"relative w-full h-full cursor-pointer\"\r\n                                >\r\n                                    {/* Glow effect for mastered skills */}\r\n                                    {skill.status === 'mastered' && (\r\n                                        <motion.div\r\n                                            className=\"absolute inset-0 rounded-full\"\r\n                                            style={{\r\n                                                background: `radial-gradient(circle, ${visuals.glow}, transparent)`,\r\n                                                filter: 'blur(15px)'\r\n                                            }}\r\n                                            animate={{ opacity: [0.5, 1, 0.5] }}\r\n                                            transition={{ duration: 2, repeat: Infinity }}\r\n                                        />\r\n                                    )}\r\n\r\n                                    {/* Main node circle */}\r\n                                    <motion.div\r\n                                        className=\"absolute inset-0 rounded-full border-2 flex items-center justify-center cursor-pointer hover:shadow-lg transition-shadow\"\r\n                                        style={{\r\n                                            backgroundColor: visuals.bg,\r\n                                            borderColor: visuals.border,\r\n                                            opacity: visuals.opacity,\r\n                                            boxShadow: hoveredSkill === skill.skillId ? `0 0 20px ${visuals.border}` : 'none'\r\n                                        }}\r\n                                    >\r\n                                        {skill.status === 'locked' && (\r\n                                            <Lock className=\"w-6 h-6 text-slate-500\" />\r\n                                        )}\r\n                                        {skill.status === 'unlocked' && (\r\n                                            <Unlock className=\"w-6 h-6 text-blue-400\" />\r\n                                        )}\r\n                                        {skill.status === 'mastered' && (\r\n                                            <CheckCircle2 className=\"w-6 h-6 text-green-400\" />\r\n                                        )}\r\n                                    </motion.div>\r\n\r\n                                    {/* Tooltip on hover */}\r\n                                    {hoveredSkill === skill.skillId && (\r\n                                        <motion.div\r\n                                            initial={{ opacity: 0, y: -10 }}\r\n                                            animate={{ opacity: 1, y: -70 }}\r\n                                            className=\"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 w-48 p-3 rounded-lg bg-slate-800 border border-slate-600 shadow-xl z-50 whitespace-normal text-center\"\r\n                                        >\r\n                                            <p className=\"font-semibold text-slate-100 text-sm\">{skill.name}</p>\r\n                                            <p className=\"text-xs text-slate-400 mt-1\">{skill.category}</p>\r\n                                            <p className=\"text-xs text-slate-500 mt-2\">{skill.masteryPercentage}% Mastery</p>\r\n                                        </motion.div>\r\n                                    )}\r\n                                </motion.div>\r\n                            </motion.div>\r\n                        );\r\n                    })}\r\n\r\n                    {/* Controls hint */}\r\n                    <div className=\"absolute bottom-4 left-4 text-xs text-slate-500\">\r\n                        <p>ðŸ–± Scroll to zoom â€¢ Right-click drag to pan</p>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Details Panel */}\r\n                {selectedSkill && (\r\n                    <motion.div\r\n                        initial={{ x: 400, opacity: 0 }}\r\n                        animate={{ x: 0, opacity: 1 }}\r\n                        exit={{ x: 400, opacity: 0 }}\r\n                        className=\"w-80 bg-gradient-to-b from-slate-800 to-slate-900 rounded-lg border border-slate-700 shadow-2xl overflow-hidden flex flex-col\"\r\n                    >\r\n                        {/* Header */}\r\n                        <div className=\"bg-gradient-to-r from-slate-700 to-slate-800 p-4 border-b border-slate-600\">\r\n                            <div className=\"flex items-start justify-between\">\r\n                                <div className=\"flex-1\">\r\n                                    <h2 className=\"text-xl font-bold text-slate-100\">{selectedSkill.name}</h2>\r\n                                    <p className=\"text-xs text-slate-400 mt-1\">{selectedSkill.category}</p>\r\n                                </div>\r\n                                <button\r\n                                    onClick={() => setSelectedSkill(null)}\r\n                                    className=\"text-slate-400 hover:text-slate-200\"\r\n                                >\r\n                                    âœ•\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Content */}\r\n                        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n                            {/* Status Badge */}\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <span className={`px-3 py-1 rounded-full text-xs font-semibold ${\r\n                                    selectedSkill.status === 'mastered' ? 'bg-green-900 text-green-200' :\r\n                                    selectedSkill.status === 'unlocked' ? 'bg-blue-900 text-blue-200' :\r\n                                    'bg-slate-700 text-slate-300'\r\n                                }`}>\r\n                                    {selectedSkill.status.charAt(0).toUpperCase() + selectedSkill.status.slice(1)}\r\n                                </span>\r\n                                {selectedSkill.status === 'locked' && selectedSkill.blockedBy && (\r\n                                    <span className=\"text-xs text-amber-400 flex items-center gap-1\">\r\n                                        <Lock className=\"w-3 h-3\" />\r\n                                        Requires {selectedSkill.blockedBy}\r\n                                    </span>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Description */}\r\n                            {selectedSkill.description && (\r\n                                <div>\r\n                                    <p className=\"text-xs font-semibold text-slate-300 mb-2\">Description</p>\r\n                                    <p className=\"text-sm text-slate-400\">{selectedSkill.description}</p>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Mastery Progress */}\r\n                            <div>\r\n                                <div className=\"flex items-center justify-between mb-2\">\r\n                                    <p className=\"text-xs font-semibold text-slate-300\">Mastery</p>\r\n                                    <p className=\"text-sm font-bold text-blue-400\">{selectedSkill.masteryPercentage}%</p>\r\n                                </div>\r\n                                <div className=\"w-full h-2 bg-slate-700 rounded-full overflow-hidden\">\r\n                                    <motion.div\r\n                                        className=\"h-full bg-gradient-to-r from-blue-500 to-cyan-400\"\r\n                                        animate={{ width: `${selectedSkill.masteryPercentage}%` }}\r\n                                        transition={{ duration: 0.5 }}\r\n                                    />\r\n                                </div>\r\n                                <p className=\"text-xs text-slate-500 mt-2\">\r\n                                    {selectedSkill.masteryPercentage >= selectedSkill.masteryThreshold ? (\r\n                                        <>ðŸŽ¯ Mastery Unlocked! </>\r\n                                    ) : (\r\n                                        <>Need {selectedSkill.masteryThreshold - selectedSkill.masteryPercentage}% more</>\r\n                                    )}\r\n                                </p>\r\n                            </div>\r\n\r\n                            {/* Prerequisites */}\r\n                            {selectedSkill.prerequisites && selectedSkill.prerequisites.length > 0 && (\r\n                                <div>\r\n                                    <p className=\"text-xs font-semibold text-slate-300 mb-2\">Requirements</p>\r\n                                    <div className=\"space-y-1\">\r\n                                        {selectedSkill.prerequisites.map((prereqId) => {\r\n                                            const prereq = skillTree.find(s => s.skillId === prereqId);\r\n                                            return (\r\n                                                <div key={prereqId} className=\"text-xs flex items-center gap-2\">\r\n                                                    <CheckCircle2 className={`w-3 h-3 ${prereq?.mastered ? 'text-green-400' : 'text-slate-600'}`} />\r\n                                                    <span className={prereq?.mastered ? 'text-slate-300' : 'text-slate-500'}>\r\n                                                        {prereq?.name || prereqId}\r\n                                                    </span>\r\n                                                </div>\r\n                                            );\r\n                                        })}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* Difficulty & Time */}\r\n                            <div className=\"grid grid-cols-2 gap-2\">\r\n                                <div className=\"bg-slate-700/50 rounded-lg p-2 text-center\">\r\n                                    <p className=\"text-xs text-slate-400\">Difficulty</p>\r\n                                    <p className=\"text-xs font-semibold text-slate-200 mt-1\">\r\n                                        {selectedSkill.difficulty.charAt(0).toUpperCase() + selectedSkill.difficulty.slice(1)}\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"bg-slate-700/50 rounded-lg p-2 text-center\">\r\n                                    <p className=\"text-xs text-slate-400\">Est. Time</p>\r\n                                    <p className=\"text-xs font-semibold text-slate-200 mt-1\">{selectedSkill.estimatedHours}h</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Action Button */}\r\n                        {selectedSkill.status === 'unlocked' && (\r\n                            <motion.button\r\n                                whileHover={{ scale: 1.02 }}\r\n                                whileTap={{ scale: 0.98 }}\r\n                                onClick={() => setShowAssessment(true)}\r\n                                className=\"m-4 w-full py-3 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 rounded-lg font-semibold text-white flex items-center justify-center gap-2 transition-all\"\r\n                            >\r\n                                <TrendingUp className=\"w-4 h-4\" />\r\n                                Take Assessment\r\n                            </motion.button>\r\n                        )}\r\n                    </motion.div>\r\n                )}\r\n\r\n                {/* Assessment Modal */}\r\n                <AnimatePresence>\r\n                    {showAssessment && selectedSkill && (\r\n                        <SkillAssessmentModal\r\n                            skill={selectedSkill}\r\n                            onClose={() => setShowAssessment(false)}\r\n                            onSuccess={(result) => {\r\n                                setShowAssessment(false);\r\n                                // Refresh skill tree to show updated mastery\r\n                                fetchSkillTree();\r\n                                // Update selected skill\r\n                                if (selectedSkill) {\r\n                                    const updated = skillTree.find(s => s.skillId === selectedSkill.skillId);\r\n                                    if (updated) {\r\n                                        setSelectedSkill({ ...updated, masteryPercentage: result.newMastery });\r\n                                    }\r\n                                }\r\n                            }}\r\n                        />\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n\r\n            {/* Legend */}\r\n            <div className=\"bg-slate-800 border-t border-slate-700 px-4 py-3\">\r\n                <div className=\"flex items-center gap-6 text-xs text-slate-400\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 rounded-full border-2 border-slate-600 bg-slate-700\" />\r\n                        <span>Locked</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 rounded-full border-2 border-blue-500 bg-blue-900\" />\r\n                        <span>Unlocked</span>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-4 h-4 rounded-full border-2 border-green-500 bg-green-900 shadow-lg shadow-green-500/50\" />\r\n                        <span>Mastered</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkillTreeMap;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\SkillTreeOverview.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[53,92],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'recentProgress' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"recentProgress"},"fix":{"range":[376,390],"text":""},"desc":"Remove unused variable 'recentProgress'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setRecentProgress' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":9,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":9,"endColumn":45,"suggestions":[{"messageId":"removeVar","data":{"varName":"setRecentProgress"},"fix":{"range":[390,409],"text":""},"desc":"Remove unused variable 'setRecentProgress'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { BookOpen, TrendingUp, Lock, Unlock, CheckCircle2, Award, Zap, MapPin } from 'lucide-react';\r\nimport axios from 'axios';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst SkillTreeOverview = ({ onNavigateToMap }) => {\r\n    const [stats, setStats] = useState(null);\r\n    const [recentProgress, setRecentProgress] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        fetchStats();\r\n    }, []);\r\n\r\n    const fetchStats = async () => {\r\n        try {\r\n            const token = localStorage.getItem('authToken');\r\n            const response = await axios.get(\r\n                `${import.meta.env.VITE_API_BASE_URL}/gamification/profile`,\r\n                { headers: { Authorization: `Bearer ${token}` } }\r\n            );\r\n\r\n            const skillTreeStats = response.data.skillTree || {};\r\n            setStats(skillTreeStats);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('[SkillTreeOverview] Error fetching stats:', error);\r\n            toast.error('Failed to load skill tree statistics');\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return (\r\n            <div className=\"flex items-center justify-center h-64\">\r\n                <Zap className=\"w-8 h-8 text-blue-500 animate-spin\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!stats) {\r\n        return (\r\n            <div className=\"text-center text-slate-400 py-8\">\r\n                <p>Unable to load skill tree data</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const progressPercentage = stats.progress || 0;\r\n    const unlockedPercentage = stats.totalSkills > 0 \r\n        ? Math.round((stats.unlockedCount / stats.totalSkills) * 100) \r\n        : 0;\r\n\r\n    return (\r\n        <div className=\"space-y-6\">\r\n            {/* Main Stats */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n                {/* Total Skills */}\r\n                <motion.div\r\n                    className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700\"\r\n                    whileHover={{ scale: 1.02 }}\r\n                    transition={{ type: 'spring', stiffness: 300 }}\r\n                >\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-xs text-slate-400 uppercase tracking-wider\">Total Skills</p>\r\n                            <p className=\"text-3xl font-bold text-slate-100 mt-2\">{stats.totalSkills || 0}</p>\r\n                        </div>\r\n                        <BookOpen className=\"w-8 h-8 text-blue-400 opacity-30\" />\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Unlocked Skills */}\r\n                <motion.div\r\n                    className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700\"\r\n                    whileHover={{ scale: 1.02 }}\r\n                    transition={{ type: 'spring', stiffness: 300, delay: 0.05 }}\r\n                >\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-xs text-slate-400 uppercase tracking-wider\">Unlocked</p>\r\n                            <p className=\"text-3xl font-bold text-blue-400 mt-2\">{stats.unlockedCount || 0}</p>\r\n                            <p className=\"text-xs text-slate-500 mt-1\">{unlockedPercentage}% discovered</p>\r\n                        </div>\r\n                        <Unlock className=\"w-8 h-8 text-blue-400 opacity-30\" />\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Mastered Skills */}\r\n                <motion.div\r\n                    className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700\"\r\n                    whileHover={{ scale: 1.02 }}\r\n                    transition={{ type: 'spring', stiffness: 300, delay: 0.1 }}\r\n                >\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-xs text-slate-400 uppercase tracking-wider\">Mastered</p>\r\n                            <p className=\"text-3xl font-bold text-green-400 mt-2\">{stats.masteredCount || 0}</p>\r\n                            <p className=\"text-xs text-slate-500 mt-1\">{progressPercentage}% progress</p>\r\n                        </div>\r\n                        <CheckCircle2 className=\"w-8 h-8 text-green-400 opacity-30\" />\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {/* Locked Skills */}\r\n                <motion.div\r\n                    className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700\"\r\n                    whileHover={{ scale: 1.02 }}\r\n                    transition={{ type: 'spring', stiffness: 300, delay: 0.15 }}\r\n                >\r\n                    <div className=\"flex items-center justify-between\">\r\n                        <div>\r\n                            <p className=\"text-xs text-slate-400 uppercase tracking-wider\">Locked</p>\r\n                            <p className=\"text-3xl font-bold text-slate-500 mt-2\">{stats.lockedCount || 0}</p>\r\n                            <p className=\"text-xs text-slate-500 mt-1\">to discover</p>\r\n                        </div>\r\n                        <Lock className=\"w-8 h-8 text-slate-500 opacity-30\" />\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n\r\n            {/* Overall Progress */}\r\n            <motion.div\r\n                className=\"bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-6 border border-slate-700\"\r\n                initial={{ opacity: 0, y: 10 }}\r\n                animate={{ opacity: 1, y: 0 }}\r\n                transition={{ delay: 0.2 }}\r\n            >\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <h3 className=\"text-lg font-semibold text-slate-100 flex items-center gap-2\">\r\n                        <TrendingUp className=\"w-5 h-5 text-blue-400\" />\r\n                        Overall Mastery Progress\r\n                    </h3>\r\n                    <span className=\"text-2xl font-bold text-blue-400\">{progressPercentage}%</span>\r\n                </div>\r\n\r\n                {/* Progress Bar */}\r\n                <div className=\"space-y-3\">\r\n                    <div className=\"w-full h-4 bg-slate-700 rounded-full overflow-hidden\">\r\n                        <motion.div\r\n                            className=\"h-full bg-gradient-to-r from-blue-500 via-cyan-400 to-green-400\"\r\n                            initial={{ width: 0 }}\r\n                            animate={{ width: `${progressPercentage}%` }}\r\n                            transition={{ duration: 1, ease: 'easeOut' }}\r\n                        />\r\n                    </div>\r\n\r\n                    {/* Milestone indicators */}\r\n                    <div className=\"flex justify-between text-xs text-slate-500\">\r\n                        <span>0%</span>\r\n                        <span>25%</span>\r\n                        <span>50%</span>\r\n                        <span>75%</span>\r\n                        <span>100%</span>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Status text */}\r\n                <div className=\"mt-4 p-3 bg-blue-900/20 border border-blue-700 rounded-lg\">\r\n                    <p className=\"text-sm text-blue-200\">\r\n                        {progressPercentage === 100\r\n                            ? 'ðŸŽŠ You\\'ve mastered all available skills! Keep learning new ones!'\r\n                            : progressPercentage >= 75\r\n                            ? 'ðŸš€ You\\'re almost there! Keep up the great progress!'\r\n                            : progressPercentage >= 50\r\n                            ? 'âš¡ Halfway there! Keep practicing to master more skills!'\r\n                            : progressPercentage >= 25\r\n                            ? 'ðŸŒ± Great start! Unlock and master more skills to progress!'\r\n                            : 'ðŸ“š Start your skill tree journey by unlocking the first skill!'}\r\n                    </p>\r\n                </div>\r\n            </motion.div>\r\n\r\n            {/* CTA Button */}\r\n            <motion.button\r\n                onClick={onNavigateToMap}\r\n                className=\"w-full py-4 bg-gradient-to-r from-blue-600 to-cyan-500 hover:from-blue-500 hover:to-cyan-400 rounded-lg font-semibold text-white flex items-center justify-center gap-3 transition-all shadow-lg hover:shadow-xl\"\r\n                whileHover={{ scale: 1.02 }}\r\n                whileTap={{ scale: 0.98 }}\r\n            >\r\n                <MapPin className=\"w-5 h-5\" />\r\n                Explore Full Skill Tree Map\r\n                <Zap className=\"w-5 h-5\" />\r\n            </motion.button>\r\n\r\n            {/* Info Box */}\r\n            <motion.div\r\n                className=\"bg-slate-800/50 border border-slate-700 rounded-lg p-4\"\r\n                initial={{ opacity: 0 }}\r\n                animate={{ opacity: 1 }}\r\n                transition={{ delay: 0.3 }}\r\n            >\r\n                <div className=\"space-y-2 text-xs text-slate-400\">\r\n                    <p className=\"flex items-center gap-2\">\r\n                        <span className=\"w-2 h-2 rounded-full bg-slate-600\" />\r\n                        Locked skills are hidden until you master their prerequisites\r\n                    </p>\r\n                    <p className=\"flex items-center gap-2\">\r\n                        <span className=\"w-2 h-2 rounded-full bg-blue-500\" />\r\n                        Unlocked skills are available for assessment and practice\r\n                    </p>\r\n                    <p className=\"flex items-center gap-2\">\r\n                        <span className=\"w-2 h-2 rounded-full bg-green-500\" />\r\n                        Mastered skills contribute to your overall progress\r\n                    </p>\r\n                </div>\r\n            </motion.div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SkillTreeOverview;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\gamification\\XPProgressModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'level' is defined but never used.","line":18,"column":45,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":50,"suggestions":[{"messageId":"removeVar","data":{"varName":"level"},"fix":{"range":[578,585],"text":""},"desc":"Remove unused variable 'level'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/gamification/XPProgressModal.jsx\r\nimport React, { useEffect, useState } from 'react';\r\nimport { X, Zap, TrendingUp, Target } from 'lucide-react';\r\nimport axios from 'axios';\r\n\r\nconst apiClient = axios.create({\r\n    baseURL: import.meta.env.VITE_API_BASE_URL || \"http://localhost:2000\",\r\n});\r\n\r\napiClient.interceptors.request.use((config) => {\r\n    const token = localStorage.getItem(\"authToken\");\r\n    if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n});\r\n\r\nfunction XPProgressModal({ isOpen, onClose, level }) {\r\n    const [stats, setStats] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            fetchStats();\r\n        }\r\n    }, [isOpen]);\r\n\r\n    const fetchStats = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const response = await apiClient.get('/gamification/profile');\r\n            setStats(response.data);\r\n        } catch (error) {\r\n            console.error('[XPProgressModal] Error fetching stats:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    const currentXP = stats?.totalXP || 0;\r\n    const currentLevel = stats?.level || 1;\r\n    const xpForNextLevel = stats?.xpForNextLevel || 50;\r\n\r\n    // Calculate XP for current level\r\n    const xpForCurrentLevel = currentLevel * currentLevel * 50;\r\n    const xpIntoCurrentLevel = currentXP - xpForCurrentLevel;\r\n    const xpNeededThisLevel = xpForNextLevel;\r\n    const progressPercent = (xpIntoCurrentLevel / xpNeededThisLevel) * 100;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 backdrop-blur-sm\">\r\n            <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-2xl w-full max-w-md mx-4 overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-4 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-3\">\r\n                        <div className=\"bg-white bg-opacity-20 p-2 rounded-full\">\r\n                            <Zap className=\"text-yellow-300\" size={24} />\r\n                        </div>\r\n                        <div>\r\n                            <h2 className=\"text-xl font-bold text-white\">XP Progress</h2>\r\n                            <p className=\"text-sm text-purple-200\">Level {currentLevel}</p>\r\n                        </div>\r\n                    </div>\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"text-white hover:bg-white hover:bg-opacity-20 p-1 rounded-full transition-colors\"\r\n                    >\r\n                        <X size={24} />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Content */}\r\n                <div className=\"p-6 max-h-[60vh] overflow-y-auto scrollbar-thin scrollbar-thumb-purple-500 scrollbar-track-gray-200 dark:scrollbar-track-gray-700\">\r\n                    {loading ? (\r\n                        <div className=\"flex items-center justify-center py-8\">\r\n                            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600\"></div>\r\n                        </div>\r\n                    ) : (\r\n                        <div className=\"space-y-6\">\r\n                            {/* XP Stats */}\r\n                            <div className=\"grid grid-cols-3 gap-4\">\r\n                                <div className=\"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg p-4 text-white\">\r\n                                    <div className=\"text-2xl font-bold\">{currentXP.toLocaleString()}</div>\r\n                                    <div className=\"text-xs opacity-80\">Total XP</div>\r\n                                </div>\r\n                                <div className=\"bg-gradient-to-br from-green-500 to-green-600 rounded-lg p-4 text-white\">\r\n                                    <div className=\"text-2xl font-bold\">{currentLevel}</div>\r\n                                    <div className=\"text-xs opacity-80\">Current Level</div>\r\n                                </div>\r\n                                <div className=\"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg p-4 text-white\">\r\n                                    <div className=\"text-2xl font-bold\">{currentLevel + 1}</div>\r\n                                    <div className=\"text-xs opacity-80\">Next Level</div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Progress Bar */}\r\n                            <div>\r\n                                <div className=\"flex items-center justify-between mb-2\">\r\n                                    <div className=\"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300\">\r\n                                        <Target size={16} />\r\n                                        <span>Progress to Level {currentLevel + 1}</span>\r\n                                    </div>\r\n                                    <span className=\"text-sm font-bold text-purple-600 dark:text-purple-400\">\r\n                                        {progressPercent.toFixed(1)}%\r\n                                    </span>\r\n                                </div>\r\n\r\n                                {/* Progress Bar Track */}\r\n                                <div className=\"relative w-full h-8 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden shadow-inner\">\r\n                                    {/* Animated Progress Fill */}\r\n                                    <div\r\n                                        className=\"absolute top-0 left-0 h-full bg-gradient-to-r from-purple-500 via-pink-500 to-indigo-500 rounded-full transition-all duration-1000 ease-out\"\r\n                                        style={{ width: `${Math.min(progressPercent, 100)}%` }}\r\n                                    >\r\n                                        {/* Shimmer Effect */}\r\n                                        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-shimmer\"></div>\r\n                                    </div>\r\n\r\n                                    {/* XP Text on Bar */}\r\n                                    <div className=\"absolute inset-0 flex items-center justify-center text-xs font-bold text-gray-800 dark:text-white z-10\">\r\n                                        {xpIntoCurrentLevel} / {xpNeededThisLevel} XP\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* XP Remaining */}\r\n                            <div className=\"flex items-center gap-3 bg-gradient-to-r from-orange-50 to-yellow-50 dark:from-gray-700 dark:to-gray-600 rounded-lg p-4\">\r\n                                <div className=\"bg-orange-500 p-2 rounded-full\">\r\n                                    <TrendingUp className=\"text-white\" size={20} />\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"text-sm text-gray-600 dark:text-gray-300\">XP needed for next level</div>\r\n                                    <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\r\n                                        {xpNeededThisLevel - xpIntoCurrentLevel} XP\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Quick Tips */}\r\n                            <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\r\n                                <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">ðŸ’¡ Earn More XP:</h3>\r\n                                <ul className=\"text-xs text-gray-600 dark:text-gray-400 space-y-1\">\r\n                                    <li>â€¢ Ask <strong>application</strong> questions: <span className=\"text-green-600 font-semibold\">10 XP</span></li>\r\n                                    <li>â€¢ Ask <strong>understanding</strong> questions: <span className=\"text-blue-600 font-semibold\">3 XP</span></li>\r\n                                    <li>â€¢ Build a <strong>daily streak</strong> for XP multipliers!</li>\r\n                                    <li>â€¢ Complete boss battles for bonus XP!</li>\r\n                                </ul>\r\n                            </div>\r\n\r\n                            {/* Recent Activity */}\r\n                            {stats?.recentXPHistory && stats.recentXPHistory.length > 0 && (\r\n                                <div className=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\r\n                                    <h3 className=\"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">ðŸ“œ Recent Activity:</h3>\r\n                                    <div className=\"space-y-2 max-h-32 overflow-y-auto\">\r\n                                        {stats.recentXPHistory.slice(0, 5).map((entry, idx) => (\r\n                                            <div key={idx} className=\"flex items-center justify-between text-xs\">\r\n                                                <div className=\"flex items-center gap-2\">\r\n                                                    <span className=\"text-gray-600 dark:text-gray-400\">{entry.topic}</span>\r\n                                                    <span className=\"text-gray-400 text-[10px]\">\r\n                                                        {new Date(entry.timestamp).toLocaleDateString()}\r\n                                                    </span>\r\n                                                </div>\r\n                                                <span className=\"font-semibold text-green-600 dark:text-green-400\">\r\n                                                    +{entry.amount} XP\r\n                                                </span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"bg-gray-50 dark:bg-gray-700 px-6 py-3 flex justify-end\">\r\n                    <button\r\n                        onClick={onClose}\r\n                        className=\"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium transition-colors\"\r\n                    >\r\n                        Got it!\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Shimmer Animation CSS */}\r\n            <style>{`\r\n        @keyframes shimmer {\r\n          0% { transform: translateX(-100%); }\r\n          100% { transform: translateX(100%); }\r\n        }\r\n        .animate-shimmer {\r\n          animation: shimmer 2s infinite;\r\n        }\r\n      `}</style>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default XPProgressModal;\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\AudienceSection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[84,123],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/landing/AudienceSection.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { Check } from 'lucide-react';\r\n\r\nconst studentsBenefits = [\r\n    \"Personalized 24/7 AI tutor for any subject.\",\r\n    \"Generate quizzes from lecture notes for exam prep.\",\r\n    \"Practice coding with AI-powered feedback.\",\r\n    \"Turn dense papers into easy-to-understand podcasts.\",\r\n];\r\n\r\nconst educatorsBenefits = [\r\n    \"Provide curated 'Subject' materials for your class.\",\r\n    \"Monitor student engagement through chat summaries.\",\r\n    \"Analyze common questions and content gaps.\",\r\n    \"Promote academic integrity with built-in tools.\",\r\n];\r\n\r\nconst AudienceCard = ({ title, benefits, color }) => (\r\n    <motion.div\r\n        initial={{ opacity: 0, scale: 0.95 }}\r\n        whileInView={{ opacity: 1, scale: 1 }}\r\n        viewport={{ once: true, amount: 0.5 }}\r\n        transition={{ duration: 0.5 }}\r\n        className=\"card-base p-8 h-full\"\r\n    >\r\n        <h3 className={`text-2xl font-bold mb-6 text-${color}-500 dark:text-${color}-400`}>{title}</h3>\r\n        <ul className=\"space-y-4\">\r\n            {benefits.map((benefit, i) => (\r\n                <li key={i} className=\"flex items-start gap-3\">\r\n                    <Check className={`flex-shrink-0 w-5 h-5 mt-1 text-${color}-500 dark:text-${color}-400`} />\r\n                    <span className=\"text-text-light dark:text-text-dark\">{benefit}</span>\r\n                </li>\r\n            ))}\r\n        </ul>\r\n    </motion.div>\r\n);\r\n\r\nconst AudienceSection = () => {\r\n    return (\r\n        <section id=\"for-whom\" className=\"py-20 lg:py-28 bg-background-light dark:bg-slate-900\">\r\n            <div className=\"container mx-auto px-4 sm:px-6 lg:px-8\">\r\n                <div className=\"text-center max-w-3xl mx-auto\">\r\n                    <h2 className=\"text-3xl sm:text-4xl font-extrabold\">Built for the Academic Community</h2>\r\n                    <p className=\"mt-4 text-lg text-text-muted-light dark:text-text-muted-dark\">\r\n                        Whether you're a student striving for excellence or an educator fostering it, iMentor has tools for you.\r\n                    </p>\r\n                </div>\r\n                <div className=\"mt-12 grid grid-cols-1 lg:grid-cols-2 gap-8\">\r\n                    <AudienceCard title=\"For Students\" benefits={studentsBenefits} color=\"primary\" />\r\n                    <AudienceCard title=\"For Educators\" benefits={educatorsBenefits} color=\"accent\" />\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default AudienceSection;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\CtaSection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[66,105],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport Button from '../core/Button';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst CtaSection = ({ onLoginClick }) => {\r\n    return (\r\n        <section className=\"py-20 lg:py-28\">\r\n            <div className=\"container mx-auto px-4 sm:px-6 lg:px-8\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 30 }}\r\n                    whileInView={{ opacity: 1, y: 0 }}\r\n                    viewport={{ once: true, amount: 0.5 }}\r\n                    transition={{ duration: 0.6 }}\r\n                    className=\"bg-primary/10 dark:bg-primary/20 p-8 sm:p-12 rounded-2xl text-center\"\r\n                >\r\n                    <h2 className=\"text-3xl sm:text-4xl font-extrabold text-text-light dark:text-text-dark\">\r\n                        Ready to Transform Your Learning?\r\n                    </h2>\r\n                    <p className=\"mt-4 max-w-2xl mx-auto text-lg text-text-muted-light dark:text-text-muted-dark\">\r\n                        Join thousands of students and educators leveraging AI to achieve academic success. Create your free account today.\r\n                    </p>\r\n                    <div className=\"mt-8\">\r\n                        <Button size=\"lg\" onClick={() => onLoginClick(false)}>\r\n                            Sign Up and Get Started\r\n                        </Button>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default CtaSection;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\FeaturesSection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[84,123],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":41,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":34,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[1788,1799],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/landing/FeaturesSection.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { \r\n    GraduationCap, BookOpen, BrainCircuit, Code, FileQuestion, Headphones\r\n} from 'lucide-react';\r\n\r\nconst features = [\r\n    {\r\n        icon: GraduationCap,\r\n        title: \"Personalized Study Plans\",\r\n        description: \"Describe your learning goals and get a custom, step-by-step curriculum with actionable modules designed to address your knowledge gaps.\",\r\n    },\r\n    {\r\n        icon: BookOpen,\r\n        title: \"Advanced Research Assistant\",\r\n        description: \"Engage with academic papers, search the web for real-time information, and chat with your own documents and URLs as your primary knowledge base.\",\r\n    },\r\n    {\r\n        icon: BrainCircuit,\r\n        title: \"Deep Analysis & Visualization\",\r\n        description: \"Automatically generate FAQs, key topic summaries, and mind maps from any document. Visualize concepts as interactive knowledge graphs.\",\r\n    },\r\n    {\r\n        icon: Code,\r\n        title: \"Secure Code Executor\",\r\n        description: \"Write, run, and test code in multiple languages within a secure sandbox. Get AI-powered feedback, error explanations, and test case generation.\",\r\n    },\r\n    {\r\n        icon: FileQuestion,\r\n        title: \"AI-Powered Quiz Generator\",\r\n        description: \"Upload any document (PDF, DOCX) and instantly generate a multiple-choice quiz to test your comprehension and prepare for exams.\",\r\n    },\r\n    {\r\n        icon: Headphones,\r\n        title: \"Content Creation Tools\",\r\n        description: \"Transform your study materials into engaging content. Generate high-quality audio podcasts or export detailed analysis into DOCX and PPTX formats.\",\r\n    }\r\n];\r\n\r\nconst FeatureCard = ({ icon: Icon, title, description, index }) => (\r\n    <motion.div\r\n        initial={{ opacity: 0, y: 30 }}\r\n        whileInView={{ opacity: 1, y: 0 }}\r\n        viewport={{ once: true, amount: 0.5 }}\r\n        transition={{ duration: 0.5, delay: index * 0.1 }}\r\n        className=\"card-base p-6 text-center\"\r\n    >\r\n        <div className=\"inline-flex items-center justify-center p-3 bg-primary/10 rounded-lg mb-4\">\r\n            <Icon className=\"h-8 w-8 text-primary\" />\r\n        </div>\r\n        <h3 className=\"text-lg font-semibold mb-2\">{title}</h3>\r\n        <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">{description}</p>\r\n    </motion.div>\r\n);\r\n\r\nconst FeaturesSection = () => {\r\n    return (\r\n        <section id=\"features\" className=\"py-20 lg:py-28 bg-background-light dark:bg-slate-900\">\r\n            <div className=\"container mx-auto px-4 sm:px-6 lg:px-8\">\r\n                <div className=\"text-center max-w-3xl mx-auto\">\r\n                    <h2 className=\"text-3xl sm:text-4xl font-extrabold\">A Smarter Way to Learn</h2>\r\n                    <p className=\"mt-4 text-lg text-text-muted-light dark:text-text-muted-dark\">\r\n                        iMentor is more than a chatbot. It's an all-in-one platform with specialized tools built for the demands of higher education and technical fields.\r\n                    </p>\r\n                </div>\r\n                <div className=\"mt-12 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n                    {features.map((feature, index) => (\r\n                        <FeatureCard key={feature.title} index={index} {...feature} />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default FeaturesSection;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\Footer.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\HeroSection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[118,157],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/landing/HeroSection.jsx\r\nimport React from 'react';\r\nimport Button from '../core/Button';\r\nimport { motion } from 'framer-motion';\r\nimport { ArrowRight } from 'lucide-react';\r\n\r\nconst HeroSection = ({ onLoginClick }) => {\r\n    return (\r\n        <section id=\"home\" className=\"relative pt-32 pb-20 lg:pt-48 lg:pb-28 overflow-hidden\">\r\n            <div className=\"absolute inset-0 -z-10 bg-grid-slate-300/[0.2] dark:bg-grid-slate-700/[0.2] [mask-image:linear-gradient(to_bottom,white_40%,transparent_100%)]\"></div>\r\n            <div className=\"container mx-auto px-4 sm:px-6 lg:px-8 text-center\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 20 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ duration: 0.6, ease: \"easeOut\" }}\r\n                >\r\n                    <h1 className=\"text-4xl sm:text-5xl lg:text-7xl font-extrabold tracking-tight text-text-light dark:text-text-dark\">\r\n                        Your Personal AI Mentor for\r\n                        <span className=\"block bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mt-2\">\r\n                            Higher Education\r\n                        </span>\r\n                    </h1>\r\n                    <p className=\"mt-6 max-w-2xl mx-auto text-lg text-text-muted-light dark:text-text-muted-dark\">\r\n                        Go beyond simple answers. Generate study plans, analyze research, practice coding, and get personalized feedback on any subject.\r\n                    </p>\r\n                    <div className=\"mt-8 flex justify-center items-center gap-4\">\r\n                        <Button size=\"lg\" onClick={() => onLoginClick(false)} rightIcon={<ArrowRight size={18} />}>\r\n                            Get Started for Free\r\n                        </Button>\r\n                        <a href=\"#features\">\r\n                            <Button size=\"lg\" variant=\"outline\">\r\n                                Explore Features\r\n                            </Button>\r\n                        </a>\r\n                    </div>\r\n                </motion.div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default HeroSection;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\HowItWorksSection.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[86,125],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/landing/HowItWorksSection.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport { UploadCloud, MessagesSquare, BrainCircuit, GraduationCap } from 'lucide-react';\r\n\r\nconst steps = [\r\n    {\r\n        icon: UploadCloud,\r\n        title: \"1. Build Your Knowledge Base\",\r\n        description: \"Upload your lecture notes, research papers, textbooks, or even YouTube URLs to create a personalized knowledge source.\"\r\n    },\r\n    {\r\n        icon: MessagesSquare,\r\n        title: \"2. Interact & Analyze\",\r\n        description: \"Chat with your documents, ask complex questions, and use advanced tools to generate summaries, mind maps, and FAQs.\"\r\n    },\r\n    {\r\n        icon: BrainCircuit,\r\n        title: \"3. Generate & Create\",\r\n        description: \"Transform your knowledge into practical assets. Create podcasts for auditory learning, presentations for review, or quizzes for self-assessment.\"\r\n    },\r\n    {\r\n        icon: GraduationCap,\r\n        title: \"4. Plan Your Success\",\r\n        description: \"Based on your interactions, iMentor suggests and helps you build personalized study plans to tackle your weakest areas and achieve your goals.\"\r\n    }\r\n];\r\n\r\nconst HowItWorksSection = () => {\r\n    return (\r\n        <section id=\"how-it-works\" className=\"py-20 lg:py-28\">\r\n            <div className=\"container mx-auto px-4 sm:px-6 lg:px-8\">\r\n                <div className=\"text-center max-w-3xl mx-auto\">\r\n                    <h2 className=\"text-3xl sm:text-4xl font-extrabold\">Get Started in Minutes</h2>\r\n                    <p className=\"mt-4 text-lg text-text-muted-light dark:text-text-muted-dark\">\r\n                        Unlock a powerful new way to study and research with a simple, intuitive workflow.\r\n                    </p>\r\n                </div>\r\n                <div className=\"relative mt-16\">\r\n                    <div className=\"absolute left-1/2 -translate-x-1/2 top-5 bottom-5 w-px bg-border-light dark:bg-border-dark hidden md:block\"></div>\r\n                    <div className=\"space-y-12\">\r\n                        {steps.map((step, index) => (\r\n                            <motion.div\r\n                                key={step.title}\r\n                                initial={{ opacity: 0, y: 50 }}\r\n                                whileInView={{ opacity: 1, y: 0 }}\r\n                                viewport={{ once: true, amount: 0.5 }}\r\n                                transition={{ duration: 0.5 }}\r\n                                className={`flex flex-col md:flex-row items-center gap-8 ${index % 2 === 1 ? 'md:flex-row-reverse' : ''}`}\r\n                            >\r\n                                <div className=\"flex-1 text-center md:text-left\">\r\n                                    <h3 className=\"text-2xl font-bold\">{step.title}</h3>\r\n                                    <p className=\"mt-2 text-text-muted-light dark:text-text-muted-dark\">{step.description}</p>\r\n                                </div>\r\n                                <div className=\"relative flex-shrink-0\">\r\n                                    <div className=\"absolute -inset-2.5 bg-primary/20 blur-xl rounded-full\"></div>\r\n                                    <div className=\"relative w-20 h-20 bg-surface-light dark:bg-surface-dark border-2 border-primary rounded-full flex items-center justify-center\">\r\n                                        <step.icon className=\"w-10 h-10 text-primary\" />\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"flex-1 hidden md:block\"></div>\r\n                            </motion.div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section>\r\n    );\r\n};\r\n\r\nexport default HowItWorksSection;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\LandingNav.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[189,196],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/landing/LandingNav.jsx\r\nimport React, { useState } from 'react';\r\nimport { Server, Menu, X } from 'lucide-react';\r\nimport Button from '../core/Button';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst LandingNav = ({ onLoginClick }) => {\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n    const navItems = [\"Features\", \"How It Works\", \"For Whom\"];\r\n\r\n    return (\r\n        <header className=\"fixed top-0 left-0 right-0 z-50 bg-surface-light/80 dark:bg-surface-dark/80 backdrop-blur-lg border-b border-border-light dark:border-border-dark\">\r\n            <nav className=\"container mx-auto px-4 sm:px-6 lg:px-8\">\r\n                <div className=\"flex items-center justify-between h-16\">\r\n                    <a href=\"#home\" className=\"flex items-center gap-2 text-xl font-bold text-text-light dark:text-text-dark\">\r\n                        <Server className=\"text-primary\" />\r\n                        <span>iMentor</span>\r\n                    </a>\r\n                    <div className=\"hidden md:flex items-center space-x-8\">\r\n                        {navItems.map(item => (\r\n                            <a key={item} href={`#${item.toLowerCase().replace(' ', '-')}`} className=\"text-sm font-medium text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light transition-colors\">\r\n                                {item}\r\n                            </a>\r\n                        ))}\r\n                    </div>\r\n                    <div className=\"hidden md:flex items-center space-x-2\">\r\n                        <Button variant=\"ghost\" size=\"sm\" onClick={() => onLoginClick(true)}>Login</Button>\r\n                        <Button variant=\"primary\" size=\"sm\" onClick={() => onLoginClick(false)}>Sign Up</Button>\r\n                    </div>\r\n                    <div className=\"md:hidden\">\r\n                        <button onClick={() => setIsMenuOpen(!isMenuOpen)}>\r\n                            {isMenuOpen ? <X size={24} /> : <Menu size={24} />}\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n            <AnimatePresence>\r\n                {isMenuOpen && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0, height: 0 }}\r\n                        animate={{ opacity: 1, height: 'auto' }}\r\n                        exit={{ opacity: 0, height: 0 }}\r\n                        className=\"md:hidden border-t border-border-light dark:border-border-dark\"\r\n                    >\r\n                        <div className=\"px-4 py-3 space-y-2\">\r\n                             {navItems.map(item => (\r\n                                <a key={item} href={`#${item.toLowerCase().replace(' ', '-')}`} onClick={() => setIsMenuOpen(false)} className=\"block text-sm font-medium text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light transition-colors py-1\">\r\n                                    {item}\r\n                                </a>\r\n                            ))}\r\n                            <div className=\"flex items-center space-x-2 pt-2\">\r\n                                <Button fullWidth variant=\"ghost\" size=\"sm\" onClick={() => { onLoginClick(true); setIsMenuOpen(false); }}>Login</Button>\r\n                                <Button fullWidth variant=\"primary\" size=\"sm\" onClick={() => { onLoginClick(false); setIsMenuOpen(false); }}>Sign Up</Button>\r\n                            </div>\r\n                        </div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </header>\r\n    );\r\n};\r\n\r\nexport default LandingNav;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\landing\\LandingPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\CenterPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[547,586],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'initialActivityForNewSession' is defined but never used.","line":109,"column":148,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":176,"suggestions":[{"messageId":"removeVar","data":{"varName":"initialActivityForNewSession"},"fix":{"range":[4170,4200],"text":""},"desc":"Remove unused variable 'initialActivityForNewSession'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'setInitialActivityForNewSession' is defined but never used.","line":109,"column":178,"nodeType":"Identifier","messageId":"unusedVar","endLine":109,"endColumn":209,"suggestions":[{"messageId":"removeVar","data":{"varName":"setInitialActivityForNewSession"},"fix":{"range":[4200,4233],"text":""},"desc":"Remove unused variable 'setInitialActivityForNewSession'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'activeBountyMetadata' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":125,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":125,"endColumn":32,"suggestions":[{"messageId":"removeVar","data":{"varName":"activeBountyMetadata"},"fix":{"range":[5182,5202],"text":""},"desc":"Remove unused variable 'activeBountyMetadata'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":220,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":220,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[9709,9710],"text":""},"desc":"Remove unused variable 't'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'t' is defined but never used.","line":249,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":249,"endColumn":28,"suggestions":[{"messageId":"removeVar","data":{"varName":"t"},"fix":{"range":[11313,11314],"text":""},"desc":"Remove unused variable 't'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has missing dependencies: 'activeBountyId' and 'handleBountyCompletion'. Either include them or remove the dependency array.","line":314,"column":8,"nodeType":"ArrayExpression","endLine":314,"endColumn":74,"suggestions":[{"desc":"Update the dependencies array to be: [messages, currentSessionId, systemPrompt, activeBountyId, setMessages, handleBountyCompletion]","fix":{"range":[14209,14275],"text":"[messages, currentSessionId, systemPrompt, activeBountyId, setMessages, handleBountyCompletion]"}}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'activeBountyId'. Either include it or remove the dependency array.","line":390,"column":8,"nodeType":"ArrayExpression","endLine":395,"endColumn":6,"suggestions":[{"desc":"Update the dependencies array to be: [regularUserToken, currentSessionId, isActuallySendingAPI, useWebSearch, useAcademicSearch, criticalThinkingEnabled, selectedSubject, selectedDocumentForAnalysis, setMessages, onChatProcessingChange, activeBountyId, handleStreamingSendMessage, handleStandardSendMessage]","fix":{"range":[17389,17700],"text":"[regularUserToken, currentSessionId, isActuallySendingAPI, useWebSearch, useAcademicSearch, criticalThinkingEnabled, selectedSubject, selectedDocumentForAnalysis, setMessages, onChatProcessingChange, activeBountyId, handleStreamingSendMessage, handleStandardSendMessage]"}}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/CenterPanel.jsx\r\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport ChatHistory from '../chat/ChatHistory';\r\nimport ChatInput from '../chat/ChatInput';\r\nimport PromptCoachModal from '../chat/PromptCoachModal.jsx';\r\nimport api from '../../services/api';\r\nimport { useAuth as useRegularAuth } from '../../hooks/useAuth';\r\nimport { useAppState } from '../../contexts/AppStateContext';\r\nimport toast from 'react-hot-toast';\r\nimport { motion } from 'framer-motion';\r\nimport {\r\n    BookMarked,\r\n    Code,\r\n    Sparkles,\r\n    ChevronRight,\r\n    Flame,\r\n    FileQuestion,\r\n    ShieldCheck,\r\n    GraduationCap,\r\n    Target,\r\n    Swords,\r\n    Coins,\r\n    Award,\r\n    CheckCircle,\r\n    XCircle,\r\n    X,\r\n    MapPin\r\n} from 'lucide-react';\r\n\r\nconst features = [\r\n    {\r\n        icon: GraduationCap,\r\n        title: \"Socratic Tutor Mode\",\r\n        description: \"Learn through guided questioning. The AI teaches by asking, not telling â€” just like a real tutor!\",\r\n        action: 'enableTutorMode',\r\n        status: 'active',\r\n        glowColor: 'purple'\r\n    },\r\n    {\r\n        icon: ShieldCheck,\r\n        title: \"Academic Integrity & Analysis\",\r\n        description: \"Check your text for potential plagiarism, biased language, and readability metrics.\",\r\n        path: '/tools/integrity-checker',\r\n        status: 'active',\r\n        glowColor: 'blue'\r\n    },\r\n    {\r\n        icon: MapPin,\r\n        title: 'Skill Tree Map',\r\n        description: 'Explore your learning journey with an interactive fog-of-war map. Master skills to unlock new paths!',\r\n        path: '/gamification/skill-tree',\r\n        status: 'active',\r\n        glowColor: 'cyan'\r\n    },\r\n    {\r\n        icon: Target,\r\n        title: 'Bounty Questions',\r\n        description: 'Daily personalized challenges based on your weak topics. Earn credits and XP!',\r\n        path: '/gamification/bounties',\r\n        status: 'active',\r\n        glowColor: 'green'\r\n    },\r\n    {\r\n        icon: Swords,\r\n        title: 'Boss Battles',\r\n        description: 'Test your knowledge with AI-generated boss battles. Win rewards and badges!',\r\n        path: '/gamification/boss-battles',\r\n        status: 'active',\r\n        glowColor: 'red'\r\n    },\r\n    {\r\n        icon: FileQuestion,\r\n        title: 'AI Quiz Generator',\r\n        description: 'Upload a document (PDF, DOCX, TXT) and generate a multiple-choice quiz to test your knowledge.',\r\n        path: '/tools/quiz-generator',\r\n        status: 'active',\r\n        glowColor: 'yellow'\r\n    },\r\n    {\r\n        icon: Code,\r\n        title: \"Secure Code Executor\",\r\n        description: \"Write, compile, and run code in a sandboxed environment with AI assistance.\",\r\n        path: '/tools/code-executor',\r\n        status: 'active',\r\n        glowColor: 'orange'\r\n    },\r\n    {\r\n        icon: BookMarked,\r\n        title: \"Academic Search\",\r\n        description: \"Find and synthesize information from academic papers and scholarly articles.\",\r\n        action: 'toggleAcademicSearch',\r\n        status: 'active',\r\n        glowColor: 'purple'\r\n    }\r\n];\r\n\r\nconst glowStyles = {\r\n    blue: \"hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-[0_0_20px_theme(colors.blue.500/40%)]\",\r\n    green: \"hover:border-green-400 dark:hover:border-green-500 hover:shadow-[0_0_20px_theme(colors.green.500/40%)]\",\r\n    red: \"hover:border-red-400 dark:hover:border-red-500 hover:shadow-[0_0_20px_theme(colors.red.500/40%)]\",\r\n    purple: \"hover:border-purple-400 dark:hover:border-purple-500 hover:shadow-[0_0_20px_theme(colors.purple.500/40%)]\",\r\n    orange: \"hover:border-orange-400 dark:hover:border-orange-500 hover:shadow-[0_0_20px_theme(colors.orange.500/40%)]\",\r\n    yellow: \"hover:border-yellow-400 dark:hover:border-yellow-500 hover:shadow-[0_0_20px_theme(colors.yellow.500/40%)]\",\r\n    cyan: \"hover:border-cyan-400 dark:hover:border-cyan-500 hover:shadow-[0_0_20px_theme(colors.cyan.500/40%)]\",\r\n    gray: \"\"\r\n};\r\n\r\nfunction CenterPanel({ messages, setMessages, currentSessionId, onChatProcessingChange, initialPromptForNewSession, setInitialPromptForNewSession, initialActivityForNewSession, setInitialActivityForNewSession }) {\r\n    const { token: regularUserToken } = useRegularAuth();\r\n    const { setSelectedSubject, systemPrompt, selectedDocumentForAnalysis, selectedSubject, tutorMode, setTutorMode } = useAppState();\r\n    const navigate = useNavigate();\r\n    const location = useLocation();\r\n\r\n    const [useWebSearch, setUseWebSearch] = useState(false);\r\n    const [useAcademicSearch, setUseAcademicSearch] = useState(false);\r\n    const [criticalThinkingEnabled, setCriticalThinkingEnabled] = useState(false);\r\n    const [isActuallySendingAPI, setIsActuallySendingAPI] = useState(false);\r\n    const abortControllerRef = useRef(null);\r\n    const [recommendations, setRecommendations] = useState([]);\r\n    const [isLoadingRecs, setIsLoadingRecs] = useState(true);\r\n    const [isCoachModalOpen, setIsCoachModalOpen] = useState(false);\r\n    const [coachData, setCoachData] = useState(null);\r\n    const [activeBountyId, setActiveBountyId] = useState(null);\r\n    const [activeBountyMetadata, setActiveBountyMetadata] = useState(null);\r\n\r\n    const handleStreamingSendMessage = useCallback(async (inputText, placeholderId, options) => {\r\n        const payload = {\r\n            query: inputText.trim(),\r\n            sessionId: currentSessionId,\r\n            useWebSearch: options.useWebSearch,\r\n            useAcademicSearch: options.useAcademicSearch,\r\n            systemPrompt,\r\n            criticalThinkingEnabled: options.criticalThinkingEnabled,\r\n            documentContextName: options.documentContextName,\r\n            tutorMode,\r\n        };\r\n\r\n        // --- THIS IS THE FIX ---\r\n        // Construct the full, correct API URL using the environment variable.\r\n        const apiUrl = `${import.meta.env.VITE_API_BASE_URL || 'http://localhost:5001/api'}/chat/message`;\r\n\r\n        const response = await fetch(apiUrl, {\r\n            // --- END OF FIX ---\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${regularUserToken}` },\r\n            body: JSON.stringify(payload),\r\n            signal: abortControllerRef.current.signal,\r\n        });\r\n\r\n        if (!response.ok) {\r\n            const errorData = await response.json();\r\n            throw new Error(errorData.message || `Server error: ${response.status}`);\r\n        }\r\n\r\n        const reader = response.body.getReader();\r\n        const decoder = new TextDecoder();\r\n        let finalBotMessageObject = null;\r\n        let accumulatedThinking = '';\r\n\r\n        while (true) {\r\n            const { done, value } = await reader.read();\r\n            if (done) break;\r\n\r\n            const chunk = decoder.decode(value, { stream: true });\r\n            const lines = chunk.split('\\n\\n').filter(line => line.startsWith('data: '));\r\n\r\n            for (const line of lines) {\r\n                const jsonString = line.replace('data: ', '');\r\n                try {\r\n                    const eventData = JSON.parse(jsonString);\r\n                    if (eventData.type === 'thought') {\r\n                        accumulatedThinking += eventData.content;\r\n                        setMessages(prev => prev.map(msg => msg.id === placeholderId ? { ...msg, thinking: accumulatedThinking, _accumulatedContent: accumulatedThinking } : msg));\r\n                    } else if (eventData.type === 'final_answer') {\r\n                        finalBotMessageObject = eventData.content;\r\n                    } else if (eventData.type === 'error') {\r\n                        throw new Error(eventData.content);\r\n                    }\r\n                } catch (e) {\r\n                    console.error(\"Error parsing SSE chunk:\", jsonString, e);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (finalBotMessageObject) {\r\n            // --- THIS IS THE FIX ---\r\n            // Create a new, correctly structured message object for the frontend state.\r\n            // This aligns the streaming response with the format used by chat history loading.\r\n            const finalMessage = {\r\n                ...finalBotMessageObject, // Copy all properties like thinking, references, etc.\r\n                id: finalBotMessageObject.id || placeholderId,\r\n                sender: 'bot', // Ensure sender is set\r\n                text: finalBotMessageObject.finalAnswer, // Map 'finalAnswer' to the 'text' property\r\n                isStreaming: false // Explicitly mark streaming as complete\r\n            };\r\n\r\n            // Now, update the state with the correctly formatted final message.\r\n            setMessages(prev => [\r\n                ...prev.filter(msg => msg.id !== placeholderId),\r\n                finalMessage\r\n            ]);\r\n            // --- END OF FIX ---\r\n\r\n            if (finalBotMessageObject.action && finalBotMessageObject.action.type === 'DOWNLOAD_DOCUMENT') {\r\n                toast.promise(\r\n                    api.generateDocumentFromTopic(finalBotMessageObject.action.payload),\r\n                    {\r\n                        loading: `Generating your ${finalBotMessageObject.action.payload.docType.toUpperCase()}...`,\r\n                        success: (data) => `Successfully downloaded '${data.filename}'!`,\r\n                        error: (err) => `Download failed: ${err.message}`,\r\n                    }\r\n                );\r\n            }\r\n        }\r\n    }, [currentSessionId, systemPrompt, regularUserToken, setMessages, tutorMode]);\r\n\r\n    const handleBountyCompletion = useCallback((bountyResult) => {\r\n        if (bountyResult.isCorrect) {\r\n            toast.custom((t) => (\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    className=\"bg-gradient-to-br from-green-500 to-emerald-600 text-white px-6 py-4 rounded-lg shadow-2xl max-w-md\"\r\n                >\r\n                    <div className=\"flex items-start gap-3\">\r\n                        <CheckCircle className=\"flex-shrink-0\" size={32} />\r\n                        <div>\r\n                            <h3 className=\"font-bold text-xl mb-2\">Bounty Completed! ðŸŽ‰</h3>\r\n                            <div className=\"flex items-center gap-4 text-sm\">\r\n                                <span className=\"flex items-center gap-1\">\r\n                                    <Coins size={18} />\r\n                                    +{bountyResult.creditsAwarded} Credits\r\n                                </span>\r\n                                <span className=\"flex items-center gap-1\">\r\n                                    <Award size={18} />\r\n                                    +{bountyResult.xpAwarded} XP\r\n                                </span>\r\n                            </div>\r\n                            <p className=\"text-sm opacity-90 mt-2\">\r\n                                Total: {bountyResult.newCreditsBalance} credits\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            ), { duration: 5000 });\r\n        } else {\r\n            toast.custom((t) => (\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.5, y: 50 }}\r\n                    className=\"bg-gradient-to-br from-red-500 to-rose-600 text-white px-6 py-4 rounded-lg shadow-2xl max-w-md\"\r\n                >\r\n                    <div className=\"flex items-start gap-3\">\r\n                        <XCircle className=\"flex-shrink-0\" size={32} />\r\n                        <div>\r\n                            <h3 className=\"font-bold text-xl mb-2\">Incorrect Answer</h3>\r\n                            <p className=\"text-sm opacity-90\">\r\n                                {bountyResult.message || 'Try again with a different approach!'}\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </motion.div>\r\n            ), { duration: 4000 });\r\n        }\r\n    }, []);\r\n\r\n    const handleStandardSendMessage = useCallback(async (inputText, placeholderId, options) => {\r\n        const payload = {\r\n            query: inputText.trim(),\r\n            history: messages.slice(0, -2),\r\n            sessionId: currentSessionId,\r\n            useWebSearch: options.useWebSearch,\r\n            useAcademicSearch: options.useAcademicSearch,\r\n            systemPrompt,\r\n            criticalThinkingEnabled: options.criticalThinkingEnabled,\r\n            documentContextName: options.documentContextName\r\n        };\r\n\r\n        // Add bounty information if this is a bounty answer\r\n        if (activeBountyId && options.isBountyAnswer) {\r\n            payload.bountyId = activeBountyId;\r\n            payload.bountyAnswer = inputText.trim();\r\n        }\r\n\r\n        const response = await api.sendMessage(payload);\r\n\r\n        if (response && response.reply) {\r\n            setMessages(prev => [\r\n                ...prev.filter(msg => msg.id !== placeholderId),\r\n                { ...response.reply, id: response.reply.id || placeholderId }\r\n            ]);\r\n\r\n            // Handle bounty completion if present\r\n            if (response.bountyResult) {\r\n                handleBountyCompletion(response.bountyResult);\r\n            }\r\n\r\n            if (response.reply.action && response.reply.action.type === 'DOWNLOAD_DOCUMENT') {\r\n                toast.promise(\r\n                    api.generateDocumentFromTopic(response.reply.action.payload),\r\n                    {\r\n                        loading: `Generating your ${response.reply.action.payload.docType.toUpperCase()}...`,\r\n                        success: (data) => `Successfully downloaded '${data.filename}'!`,\r\n                        error: (err) => `Download failed: ${err.message}`,\r\n                    }\r\n                );\r\n            }\r\n        } else {\r\n            throw new Error(\"Invalid response from AI service.\");\r\n        }\r\n    }, [messages, currentSessionId, systemPrompt, setMessages, tutorMode]);\r\n\r\n\r\n    const handleSendMessage = useCallback(async (inputText, options = {}) => {\r\n        if (!inputText.trim() || !regularUserToken || !currentSessionId || isActuallySendingAPI) return;\r\n\r\n        const effectiveUseWebSearch = options.useWebSearch ?? useWebSearch;\r\n        const effectiveUseAcademicSearch = options.useAcademicSearch ?? useAcademicSearch;\r\n        const effectiveCriticalThinking = options.criticalThinkingEnabled ?? criticalThinkingEnabled;\r\n        const effectiveDocumentContext = options.documentContextName ?? selectedSubject ?? selectedDocumentForAnalysis;\r\n\r\n        abortControllerRef.current = new AbortController();\r\n\r\n        const userMessage = {\r\n            id: `user-${Date.now()}`,\r\n            sender: 'user',\r\n            text: inputText.trim(),\r\n            timestamp: new Date().toISOString(),\r\n        };\r\n\r\n        const streamingPlaceholderId = `bot-streaming-${Date.now()}`;\r\n        const placeholderMessage = {\r\n            id: streamingPlaceholderId,\r\n            sender: 'bot',\r\n            text: '',\r\n            thinking: effectiveCriticalThinking ? '' : null,\r\n            isStreaming: true,\r\n            timestamp: new Date().toISOString(),\r\n            _accumulatedContent: ''\r\n        };\r\n\r\n        setMessages(prev => [...prev, userMessage, placeholderMessage]);\r\n        onChatProcessingChange(true);\r\n        setIsActuallySendingAPI(true);\r\n\r\n        try {\r\n            const handlerOptions = {\r\n                useWebSearch: effectiveUseWebSearch,\r\n                useAcademicSearch: effectiveUseAcademicSearch,\r\n                criticalThinkingEnabled: effectiveCriticalThinking,\r\n                documentContextName: effectiveDocumentContext\r\n            };\r\n\r\n            // Add bounty flag to options if we have an active bounty\r\n            const enrichedOptions = {\r\n                ...handlerOptions,\r\n                isBountyAnswer: !!activeBountyId\r\n            };\r\n\r\n            if (effectiveCriticalThinking) {\r\n                await handleStreamingSendMessage(inputText, streamingPlaceholderId, enrichedOptions);\r\n            } else {\r\n                await handleStandardSendMessage(inputText, streamingPlaceholderId, enrichedOptions);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error in handleSendMessage:\", error);\r\n\r\n            const errorMessage = error.response?.data?.message || error.message || \"An unknown error occurred.\";\r\n\r\n            setMessages(prev => prev.map(msg =>\r\n                msg.id === streamingPlaceholderId\r\n                    ? { ...msg, isStreaming: false, text: `Error: ${error.message}` }\r\n                    : msg\r\n            ));\r\n            toast.error(errorMessage);\r\n        } finally {\r\n            setIsActuallySendingAPI(false);\r\n            onChatProcessingChange(false);\r\n            setUseWebSearch(false);\r\n            setUseAcademicSearch(false);\r\n            // Clear bounty state after message is sent\r\n            if (activeBountyId) {\r\n                setActiveBountyId(null);\r\n                setActiveBountyMetadata(null);\r\n            }\r\n        }\r\n    }, [\r\n        regularUserToken, currentSessionId, isActuallySendingAPI, useWebSearch,\r\n        useAcademicSearch, criticalThinkingEnabled, selectedSubject,\r\n        selectedDocumentForAnalysis, setMessages, onChatProcessingChange,\r\n        handleStreamingSendMessage, handleStandardSendMessage, systemPrompt\r\n    ]);\r\n\r\n    useEffect(() => {\r\n        const fetchRecommendations = async () => {\r\n            if (messages.length === 0 && currentSessionId) {\r\n                setIsLoadingRecs(true);\r\n                try {\r\n                    const data = await api.getRecommendations(currentSessionId);\r\n                    setRecommendations(data.recommendations || []);\r\n                } catch (error) {\r\n                    console.error(\"Failed to fetch recommendations:\", error);\r\n                    setRecommendations([]);\r\n                } finally {\r\n                    setIsLoadingRecs(false);\r\n                }\r\n            }\r\n        };\r\n        fetchRecommendations();\r\n    }, [currentSessionId, messages.length]);\r\n\r\n    // Handle bounty question from navigation state\r\n    useEffect(() => {\r\n        if (location.state?.bountyQuestion) {\r\n            const bountyText = `ðŸŽ¯ Bounty Challenge (${location.state.bountyCredits} credits + ${location.state.bountyXP} XP)\\n\\n${location.state.bountyQuestion}`;\r\n            setInitialPromptForNewSession(bountyText);\r\n\r\n            // Store bounty metadata in component state\r\n            setActiveBountyId(location.state.bountyId);\r\n            setActiveBountyMetadata({\r\n                credits: location.state.bountyCredits,\r\n                xp: location.state.bountyXP,\r\n                topic: location.state.bountyTopic,\r\n                difficulty: location.state.bountyDifficulty\r\n            });\r\n\r\n            // Clear the navigation state to prevent re-triggering\r\n            navigate(location.pathname, { replace: true, state: {} });\r\n        }\r\n    }, [location.state, setInitialPromptForNewSession, navigate, location.pathname]);\r\n\r\n    const handleFeatureClick = (feature) => {\r\n        if (feature.path) {\r\n            navigate(feature.path);\r\n        } else if (feature.action) {\r\n            switch (feature.action) {\r\n                case 'enableTutorMode':\r\n                    setTutorMode(true);\r\n                    toast.success(\"ðŸŽ“ Tutor Mode activated!\", { duration: 3000 });\r\n                    break;\r\n                case 'toggleAcademicSearch':\r\n                    setUseAcademicSearch(true);\r\n                    toast.success(\"Academic Search has been enabled for your next message.\");\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n        }\r\n    };\r\n\r\n    const handleRecommendationClick = async (rec) => {\r\n        if (isActuallySendingAPI) return;\r\n        setUseWebSearch(false);\r\n        setUseAcademicSearch(false);\r\n\r\n        const options = {\r\n            useWebSearch: rec.actionType === 'web_search',\r\n            useAcademicSearch: rec.actionType === 'academic_search',\r\n            documentContextName: null\r\n        };\r\n\r\n        let query = rec.topic;\r\n\r\n        switch (rec.actionType) {\r\n            case 'direct_answer':\r\n                query = `Regarding the topic of \"${rec.topic}\", please provide a detailed explanation. Elaborate on the key concepts and provide clear examples.`;\r\n                break;\r\n            case 'web_search':\r\n                query = `Search the web for the latest information on: ${rec.topic}`;\r\n                break;\r\n            case 'academic_search':\r\n                query = `Find and summarize academic papers about: ${rec.topic}`;\r\n                break;\r\n            case 'document_review': {\r\n                toast.loading(`Finding the best document for \"${rec.topic}\"...`, { id: 'doc-find-toast' });\r\n                try {\r\n                    const { documentName } = await api.findDocumentForTopic(rec.topic);\r\n                    toast.success(`Focus set to document: ${documentName}`, { id: 'doc-find-toast' });\r\n                    setSelectedSubject(documentName);\r\n                    options.documentContextName = documentName;\r\n                    query = `Based on the document \"${documentName}\", please explain \"${rec.topic}\".`;\r\n                } catch (error) {\r\n                    toast.error(error.message || `Could not find a document for \"${rec.topic}\".`, { id: 'doc-find-toast' });\r\n                    return;\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                toast.error(`Unknown recommendation type: ${rec.actionType}`);\r\n                return;\r\n        }\r\n\r\n        toast.success(`Exploring \"${rec.topic}\" for you...`);\r\n        handleSendMessage(query, options);\r\n    };\r\n\r\n    const RecommendationCard = ({ rec, index }) => (\r\n        <motion.div\r\n            initial={{ opacity: 0, y: 20 }}\r\n            animate={{ opacity: 1, y: 0 }}\r\n            transition={{ duration: 0.5, delay: index * 0.1, ease: \"easeOut\" }}\r\n            className=\"relative p-[2px] rounded-lg group\"\r\n            style={{\r\n                background: `conic-gradient(from var(--angle), #059669, #3b82f6, #9333ea, #059669)`,\r\n                animation: 'spin-border 6s linear infinite',\r\n            }}\r\n        >\r\n            <button\r\n                onClick={() => handleRecommendationClick(rec)}\r\n                disabled={isActuallySendingAPI}\r\n                className=\"w-full h-full text-left bg-surface-light dark:bg-slate-800 rounded-[7px] p-4 flex flex-col justify-between transition-colors duration-300 hover:bg-gray-50 dark:hover:bg-slate-700 disabled:opacity-60\"\r\n            >\r\n                <div>\r\n                    <div className=\"flex items-center gap-2 mb-2\">\r\n                        <Sparkles size={16} className=\"text-primary dark:text-teal-400 flex-shrink-0 twinkling-text\" />\r\n                        <p className=\"text-sm font-semibold text-primary dark:text-primary-light uppercase tracking-wider truncate\" title={rec.topic}>\r\n                            {rec.topic}\r\n                        </p>\r\n                    </div>\r\n                    <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark mt-1 h-16\">\r\n                        {rec.suggestion_text}\r\n                    </p>\r\n                </div>\r\n                <div className=\"mt-4 text-sm font-bold text-teal-500 dark:text-teal-400 self-start flex items-center gap-1.5 transition-transform duration-300 group-hover:translate-x-1\">\r\n                    Explore Now\r\n                    <ChevronRight size={18} />\r\n                </div>\r\n            </button>\r\n        </motion.div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-background-light dark:bg-background-dark rounded-lg shadow-inner\">\r\n            {/* Tutor Mode Banner */}\r\n            {tutorMode && (\r\n                <div className=\"flex-shrink-0 bg-gradient-to-r from-primary/10 to-purple-500/10 border-b border-primary/30 px-4 py-2 flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"p-1.5 rounded-md bg-primary/20\">\r\n                            <GraduationCap size={16} className=\"text-primary\" />\r\n                        </div>\r\n                        <span className=\"text-sm font-medium text-text-light dark:text-text-dark\">\r\n                            Tutor Mode Active\r\n                        </span>\r\n                        <span className=\"text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-orange-500/20 text-orange-500 dark:text-orange-400\">\r\n                            Beta\r\n                        </span>\r\n                    </div>\r\n                    <button\r\n                        onClick={() => setTutorMode(false)}\r\n                        className=\"flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded-md text-gray-600 dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-500/10 transition-colors\"\r\n                        title=\"Exit Tutor Mode\"\r\n                    >\r\n                        <X size={14} />\r\n                        Exit Tutor Mode\r\n                    </button>\r\n                </div>\r\n            )}\r\n            {messages.length === 0 && !isActuallySendingAPI && currentSessionId ? (\r\n                tutorMode ? (\r\n                    /* Tutor Mode Welcome Screen */\r\n                    <div className=\"flex-1 flex flex-col justify-center items-center p-4 sm:p-8 overflow-y-auto custom-scrollbar animate-fadeIn\">\r\n                        <div className=\"w-full max-w-3xl mx-auto text-center\">\r\n                            <motion.div\r\n                                initial={{ scale: 0 }}\r\n                                animate={{ scale: 1 }}\r\n                                transition={{ type: \"spring\", duration: 0.6 }}\r\n                                className=\"inline-flex p-4 rounded-full bg-gradient-to-br from-purple-500/20 to-blue-500/20 mb-6\"\r\n                            >\r\n                                <GraduationCap size={48} className=\"text-purple-500\" />\r\n                            </motion.div>\r\n\r\n                            <motion.h1\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: 0.2 }}\r\n                                className=\"text-4xl md:text-5xl font-extrabold bg-gradient-to-r from-purple-500 via-pink-500 to-blue-500 text-transparent bg-clip-text mb-4\"\r\n                            >\r\n                                Welcome to Tutor Mode\r\n                            </motion.h1>\r\n\r\n                            <motion.p\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: 0.3 }}\r\n                                className=\"text-lg text-text-muted-light dark:text-text-muted-dark mb-8 max-w-xl mx-auto\"\r\n                            >\r\n                                I teach through <span className=\"font-semibold text-purple-500\">guided questioning</span>,\r\n                                not direct answers. Tell me what you want to learn, and I'll help you discover the answers yourself!\r\n                            </motion.p>\r\n\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: 0.4 }}\r\n                                className=\"bg-surface-light dark:bg-surface-dark/50 border border-border-light dark:border-border-dark rounded-xl p-6 mb-8\"\r\n                            >\r\n                                <h3 className=\"text-sm font-semibold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider mb-4\">\r\n                                    How it works\r\n                                </h3>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 text-left\">\r\n                                    <div className=\"flex items-start gap-3\">\r\n                                        <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-500 font-bold\">1</div>\r\n                                        <div>\r\n                                            <p className=\"font-medium text-text-light dark:text-text-dark\">Ask a topic</p>\r\n                                            <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">Tell me what you want to learn</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-start gap-3\">\r\n                                        <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-pink-500/20 flex items-center justify-center text-pink-500 font-bold\">2</div>\r\n                                        <div>\r\n                                            <p className=\"font-medium text-text-light dark:text-text-dark\">Answer questions</p>\r\n                                            <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">I'll guide you with Socratic questions</p>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className=\"flex items-start gap-3\">\r\n                                        <div className=\"flex-shrink-0 w-8 h-8 rounded-full bg-blue-500/20 flex items-center justify-center text-blue-500 font-bold\">3</div>\r\n                                        <div>\r\n                                            <p className=\"font-medium text-text-light dark:text-text-dark\">Achieve mastery</p>\r\n                                            <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">Demonstrate understanding to unlock topics</p>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </motion.div>\r\n\r\n                            <motion.div\r\n                                initial={{ opacity: 0, y: 20 }}\r\n                                animate={{ opacity: 1, y: 0 }}\r\n                                transition={{ delay: 0.5 }}\r\n                            >\r\n                                <h3 className=\"text-sm font-semibold text-text-muted-light dark:text-text-muted-dark uppercase tracking-wider mb-4\">\r\n                                    Try asking about\r\n                                </h3>\r\n                                <div className=\"flex flex-wrap justify-center gap-2\">\r\n                                    {['Machine Learning basics', 'Neural Networks', 'Data Structures', 'Algorithms', 'Python programming'].map((topic) => (\r\n                                        <button\r\n                                            key={topic}\r\n                                            onClick={() => handleSendMessage(`Teach me about ${topic}`)}\r\n                                            className=\"px-4 py-2 rounded-full bg-gradient-to-r from-purple-500/10 to-blue-500/10 border border-purple-500/30 text-sm font-medium text-purple-600 dark:text-purple-400 hover:border-purple-500 hover:shadow-lg hover:shadow-purple-500/20 transition-all duration-300\"\r\n                                        >\r\n                                            {topic}\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </motion.div>\r\n                        </div>\r\n                    </div>\r\n                ) : (\r\n                    /* Regular Welcome Screen */\r\n                    <div className=\"flex-1 flex flex-col justify-center items-center p-4 sm:p-8 overflow-y-auto custom-scrollbar animate-fadeIn\">\r\n                        <div className=\"w-full max-w-4xl mx-auto\">\r\n                            <div className=\"text-center\">\r\n                                <h1 className=\"text-5xl md:text-7xl font-extrabold bg-gradient-to-r from-purple-500 to-blue-500 text-transparent bg-clip-text mb-4\">\r\n                                    Welcome to iMentor\r\n                                </h1>\r\n                                <p className=\"text-lg md:text-xl text-text-muted-light dark:text-text-muted-dark font-medium\">\r\n                                    Your personal AI-powered guide for learning and discovery.\r\n                                </p>\r\n                            </div>\r\n\r\n                            <hr className=\"border-border-light dark:border-border-dark my-8\" />\r\n\r\n                            <div className=\"text-center\">\r\n                                <h2 className=\"text-2xl font-semibold mb-6 text-orange-500 animated-underline\">\r\n                                    What's New\r\n                                </h2>\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-2xl mx-auto\">\r\n                                    {features.map((feature, index) => (\r\n                                        <button\r\n                                            key={index}\r\n                                            onClick={() => handleFeatureClick(feature)}\r\n                                            disabled={feature.status === 'soon'}\r\n                                            className={`group relative text-left bg-surface-light dark:bg-surface-dark/50 border border-border-light dark:border-border-dark rounded-lg p-4 transition-all duration-300 ease-in-out hover:scale-105 disabled:opacity-60 disabled:cursor-not-allowed ${glowStyles[feature.glowColor]}`}\r\n                                        >\r\n                                            <div className=\"relative\">\r\n                                                {feature.title === 'Academic Integrity & Analysis' && (\r\n                                                    <div className=\"fire-tag-animation absolute -top-4 -right-3 flex items-center gap-1 bg-gradient-to-br from-red-500 to-orange-400 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg\">\r\n                                                        <Flame size={10} />\r\n                                                        HOT\r\n                                                    </div>\r\n                                                )}\r\n                                                {feature.status === 'soon' && <span className=\"absolute -top-2 -right-2 text-xs bg-yellow-400/20 text-yellow-600 dark:text-yellow-400 font-semibold px-2 py-0.5 rounded-full\">Coming Soon</span>}\r\n                                                <div className=\"flex items-center gap-3 mb-2\">\r\n                                                    <feature.icon className=\"w-6 h-6 text-primary dark:text-primary-light\" />\r\n                                                    <h3 className=\"font-semibold text-text-light dark:text-text-dark\">{feature.title}</h3>\r\n                                                </div>\r\n                                                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">{feature.description}</p>\r\n                                            </div>\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {!isLoadingRecs && recommendations.length > 0 && (\r\n                                <motion.div\r\n                                    initial={{ opacity: 0, y: 30 }}\r\n                                    animate={{ opacity: 1, y: 0 }}\r\n                                    transition={{ duration: 0.8, delay: 0.5, ease: \"easeOut\" }}\r\n                                    className=\"mt-12\"\r\n                                >\r\n                                    <div className=\"relative text-center mb-6\">\r\n                                        <hr className=\"border-border-light dark:border-border-dark\" />\r\n                                        <div className=\"absolute -top-4 left-1/2 -translate-x-1/2 bg-background-light dark:bg-background-dark px-4\">\r\n                                            <h3 className=\"text-xl font-bold flex items-center gap-2 bg-gradient-to-r from-accent to-green-400 text-transparent bg-clip-text twinkling-text\">\r\n                                                <Sparkles size={20} /> Recommended For You\r\n                                            </h3>\r\n                                        </div>\r\n                                    </div>\r\n                                    <p className=\"text-center text-sm text-text-muted-light dark:text-text-muted-dark mb-6\">\r\n                                        Based on your recent activity, here are a few suggestions to explore next.\r\n                                    </p>\r\n                                    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl mx-auto\">\r\n                                        {recommendations.map((rec, index) => (\r\n                                            <RecommendationCard key={index} rec={rec} index={index} />\r\n                                        ))}\r\n                                    </div>\r\n                                </motion.div>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )\r\n            ) : (\r\n                <ChatHistory messages={messages} onCueClick={handleSendMessage} />\r\n            )}\r\n\r\n            <ChatInput\r\n                onSendMessage={handleSendMessage}\r\n                isLoading={isActuallySendingAPI}\r\n                useWebSearch={useWebSearch}\r\n                setUseWebSearch={setUseWebSearch}\r\n                useAcademicSearch={useAcademicSearch}\r\n                setUseAcademicSearch={setUseAcademicSearch}\r\n                criticalThinkingEnabled={criticalThinkingEnabled}\r\n                setCriticalThinkingEnabled={setCriticalThinkingEnabled}\r\n                initialPrompt={initialPromptForNewSession}\r\n                setInitialPromptForNewSession={setInitialPromptForNewSession}\r\n                openCoachModalWithData={setCoachData}\r\n                setCoachModalOpen={setIsCoachModalOpen}\r\n            />\r\n            <PromptCoachModal\r\n                isOpen={isCoachModalOpen}\r\n                onClose={() => setIsCoachModalOpen(false)}\r\n                onApply={(improvedPrompt) => {\r\n                    setInitialPromptForNewSession(improvedPrompt);\r\n                }}\r\n                data={coachData}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default CenterPanel;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\LLMSelectionModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[468,507],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/LLMSelectionModal.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport api from '../../services/api.js';\r\nimport toast from 'react-hot-toast';\r\nimport { X, Save, KeyRound, AlertCircle, HardDrive } from 'lucide-react';\r\nimport Modal from '../core/Modal.jsx';\r\nimport Button from '../core/Button.jsx';\r\nimport LLMSelection from '../auth/LLMSelection.jsx';\r\nimport { motion } from 'framer-motion';\r\n\r\nfunction LLMSelectionModal({ isOpen, onClose }) {\r\n    const { selectedLLM: currentLLM, switchLLM: setGlobalLLMPreference } = useAppState();\r\n    \r\n    // State for the provider selection\r\n    const [locallySelectedLLM, setLocallySelectedLLM] = useState(currentLLM);\r\n    \r\n    // Separate state for each input field\r\n    const [geminiApiKeyInput, setGeminiApiKeyInput] = useState('');\r\n    const [ollamaUrlInput, setOllamaUrlInput] = useState('');\r\n    \r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        // Reset state every time the modal opens\r\n        if (isOpen) {\r\n            setLocallySelectedLLM(currentLLM);\r\n            setGeminiApiKeyInput(''); \r\n            setOllamaUrlInput(''); \r\n            setError('');\r\n        }\r\n    }, [isOpen, currentLLM]);\r\n\r\n    const handleSavePreference = async () => {\r\n        setLoading(true); \r\n        setError('');\r\n        \r\n        try {\r\n            // Start with the provider selection\r\n            const configData = { llmProvider: locallySelectedLLM };\r\n\r\n            // Only add other fields if the user actually typed something into them\r\n            if (geminiApiKeyInput.trim()) {\r\n                configData.apiKey = geminiApiKeyInput.trim();\r\n            }\r\n            if (ollamaUrlInput.trim()) {\r\n                configData.ollamaUrl = ollamaUrlInput.trim();\r\n            }\r\n            \r\n            await api.updateUserLLMConfig(configData);\r\n            setGlobalLLMPreference(locallySelectedLLM);\r\n            \r\n            toast.success(`LLM preference updated to ${locallySelectedLLM.toUpperCase()}.`);\r\n            onClose();\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || err.message || 'Failed to update preference.';\r\n            setError(errorMessage);\r\n            toast.error(errorMessage);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    \r\n    const inputWrapperClass = \"relative\";\r\n    const inputIconClass = \"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted-light dark:text-text-muted-dark\";\r\n    const inputFieldStyledClass = \"input-field pl-10 py-2 text-sm w-full\";\r\n\r\n    return (\r\n         <Modal isOpen={isOpen} onClose={onClose} title=\"Switch LLM Provider & Credentials\" size=\"lg\"\r\n            footerContent={\r\n                <>\r\n                    <Button onClick={onClose} variant=\"secondary\" size=\"sm\" className=\"text-xs\">Cancel</Button>\r\n                    <Button onClick={handleSavePreference} isLoading={loading} size=\"sm\" className=\"text-xs\">\r\n                        <Save size={14} className=\"mr-1.5\"/> Save Preference\r\n                    </Button>\r\n                </>\r\n            }\r\n        >\r\n            <div className=\"space-y-5\"> \r\n                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">\r\n                    Select your preferred LLM. You can also update your credentials here. <br/><strong>Leave a field blank to keep your existing setting.</strong>\r\n                </p>\r\n                <LLMSelection \r\n                    selectedLLM={locallySelectedLLM} \r\n                    onLlmChange={setLocallySelectedLLM}\r\n                    disabled={loading}\r\n                />\r\n                \r\n                <motion.div key=\"gemini-config-modal\" className=\"mt-4 space-y-1\">\r\n                    <label htmlFor=\"modalGeminiApiKey\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark\">\r\n                        Update Gemini API Key (Optional)\r\n                    </label>\r\n                    <div className={inputWrapperClass}>\r\n                        <KeyRound className={inputIconClass} />\r\n                        <input type=\"password\" id=\"modalGeminiApiKey\" className={inputFieldStyledClass} placeholder=\"Leave blank to keep existing key\" value={geminiApiKeyInput} onChange={(e) => setGeminiApiKeyInput(e.target.value)} disabled={loading} />\r\n                    </div>\r\n                </motion.div>\r\n                \r\n                <motion.div key=\"ollama-config-modal\" className=\"mt-4 space-y-1\">\r\n                    <label htmlFor=\"modalOllamaUrl\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark\">\r\n                        Update Ollama URL (Optional)\r\n                    </label>\r\n                     <div className={inputWrapperClass}>\r\n                        <HardDrive className={inputIconClass} />\r\n                        <input type=\"text\" id=\"modalOllamaUrl\" className={inputFieldStyledClass} placeholder=\"Leave blank to keep existing URL\" value={ollamaUrlInput} onChange={(e) => setOllamaUrlInput(e.target.value)} disabled={loading} />\r\n                    </div>\r\n                </motion.div>\r\n\r\n                {error && (\r\n                    <div className=\"flex items-center gap-2 p-2 text-xs text-red-700 bg-red-100 dark:bg-red-900/30 dark:text-red-300 rounded-md\">\r\n                        <AlertCircle size={16} />\r\n                        <span>{error}</span>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </Modal>\r\n    );\r\n}\r\n\r\nexport default LLMSelectionModal;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\LeftCollapsedNav.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[315,354],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/LeftCollapsedNav.jsx\r\nimport React from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport { Edit3, UploadCloud, FileText, ChevronRight, Settings2 } from 'lucide-react'; // Settings2 for fallback\r\nimport IconButton from '../core/IconButton.jsx'; \r\nimport { motion } from 'framer-motion';\r\n\r\n// Mapping icon names (or IDs) to Lucide components\r\nconst iconMap = {\r\n    prompt: Edit3,       // Icon for \"Custom Prompt\"\r\n    upload: UploadCloud, // Icon for \"Upload Document\"\r\n    docs: FileText,      // Icon for \"Document List\"\r\n};\r\n\r\nfunction LeftCollapsedNav({ isChatProcessing }) {\r\n    const { setIsLeftPanelOpen } = useAppState();\r\n\r\n    // Define the items for the collapsed navigation bar\r\n    const navItems = [\r\n        { \r\n            id: 'prompt', \r\n            label: 'Custom Prompt', \r\n            iconName: 'prompt', // Matches key in iconMap\r\n            action: () => { \r\n                setIsLeftPanelOpen(true); \r\n                // TODO: Optionally, also scroll to/focus the prompt section in LeftPanel\r\n            } \r\n        },\r\n        { \r\n            id: 'upload', \r\n            label: 'Upload Document', \r\n            iconName: 'upload', \r\n            action: () => { \r\n                setIsLeftPanelOpen(true);\r\n                // TODO: Optionally, open LeftPanel and focus/highlight upload area\r\n            } \r\n        },\r\n        { \r\n            id: 'docs', \r\n            label: 'Document List', \r\n            iconName: 'docs', \r\n            action: () => { \r\n                setIsLeftPanelOpen(true); \r\n                // TODO: Optionally, open LeftPanel scrolled to document list\r\n            } \r\n        },\r\n    ];\r\n\r\n    return (\r\n        <motion.aside\r\n            key=\"left-collapsed-nav\" // Unique key for AnimatePresence\r\n            initial={{ x: '-100%', opacity: 0 }}\r\n            animate={{ x: '0%', opacity: 1 }}\r\n            exit={{ x: '-100%', opacity: 0 }}\r\n            transition={{ type: 'spring', stiffness: 300, damping: 30 }}\r\n            // Styling for the thin vertical bar\r\n            className={`fixed left-0 top-16 bottom-0 z-30 w-14 sm:w-16 \r\n                       bg-surface-light dark:bg-surface-dark \r\n                       border-r border-border-light dark:border-border-dark \r\n                       shadow-lg flex flex-col items-center py-3 space-y-2 custom-scrollbar\r\n                       ${isChatProcessing ? 'processing-overlay' : ''}`}\r\n        >\r\n            {/* Button to open the full LeftPanel - Placed at the top */}\r\n            <IconButton \r\n                icon={ChevronRight} \r\n                onClick={() => setIsLeftPanelOpen(true)} \r\n                title=\"Open Assistant Panel\"\r\n                ariaLabel=\"Open Assistant Panel\"\r\n                variant=\"ghost\" \r\n                size=\"lg\" // Make it prominent\r\n                className=\"mb-2 text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                disabled={isChatProcessing}\r\n            />\r\n\r\n            {/* Icons for different sections of LeftPanel */}\r\n            {navItems.map(item => {\r\n                const IconComponent = iconMap[item.iconName] || Settings2; // Fallback icon\r\n                return (\r\n                    <IconButton \r\n                        key={item.id}\r\n                        icon={IconComponent}\r\n                        onClick={item.action} // Action currently just opens the panel\r\n                        title={item.label}\r\n                        ariaLabel={item.label}\r\n                        variant=\"ghost\"\r\n                        size=\"md\" \r\n                        className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                        disabled={isChatProcessing}\r\n                    />\r\n                );\r\n            })}\r\n            {/* Add a flexible spacer if you want the open button pushed further down from items */}\r\n            {/* <div className=\"flex-grow\"></div> */}\r\n        </motion.aside>\r\n    );\r\n}\r\nexport default LeftCollapsedNav;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\LeftPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":12,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[573,580],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/LeftPanel.jsx\r\nimport React, { useState, useEffect, useCallback } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport DocumentUpload from '../documents/DocumentUpload.jsx';\r\nimport KnowledgeSourceList from '../documents/KnowledgeSourceList.jsx';\r\nimport SubjectList from '../documents/SubjectList.jsx';\r\nimport {\r\n    PanelLeftClose, ChevronDown, ChevronUp, FilePlus, Settings2,\r\n    Bot, BookOpen, Lightbulb, Library\r\n} from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport toast from 'react-hot-toast';\r\nimport api from '../../services/api.js';\r\n\r\nconst PROMPT_PRESETS = [\r\n     { id: 'friendly_tutor', name: 'Friendly Tutor', icon: Bot, text: \"You are a friendly, patient, and encouraging tutor specializing in engineering and scientific topics for PhD students. Explain concepts clearly, break down complex ideas, use analogies, and offer positive reinforcement. Ask follow-up questions to ensure understanding.\" },\r\n     { id: 'concept_explorer', name: 'Concept Explorer', icon: BookOpen, text: \"You are an expert academic lecturer introducing a new, complex engineering or scientific concept. Your goal is to provide a deep, structured explanation. Define terms rigorously, outline the theory, provide relevant mathematical formulations (using Markdown), illustrative examples, and discuss applications or limitations pertinent to PhD-level research.\" },\r\n     { id: 'knowledge_check', name: 'Knowledge Check', icon: Lightbulb, text: \"You are assessing understanding of engineering/scientific topics. Ask targeted questions to test knowledge, identify misconceptions, and provide feedback on the answers. Start by asking the user what topic they want to be quizzed on.\" },\r\n     { id: 'custom', name: 'Custom Prompt', icon: Settings2, text: \"You are a helpful AI engineering tutor.\" }\r\n];\r\n\r\nfunction LeftPanel({ isChatProcessing }) {\r\n    const {\r\n        setIsLeftPanelOpen,\r\n        systemPrompt, setSystemPrompt,\r\n        selectDocumentForAnalysis, selectedDocumentForAnalysis,\r\n        selectedSubject, setSelectedSubject\r\n    } = useAppState();\r\n\r\n    const [isPromptSectionOpen, setIsPromptSectionOpen] = useState(false);\r\n    const [isSubjectSectionOpen, setIsSubjectSectionOpen] = useState(false);\r\n    const [isKnowledgeBaseOpen, setIsKnowledgeBaseOpen] = useState(false);\r\n\r\n    const [selectedPresetId, setSelectedPresetId] = useState('custom');\r\n    const [availableSubjects, setAvailableSubjects] = useState([]);\r\n    const [isLoadingSubjects, setIsLoadingSubjects] = useState(false);\r\n    const [subjectFetchError, setSubjectFetchError] = useState('');\r\n    const [refreshKey, setRefreshKey] = useState(Date.now());\r\n\r\n    useEffect(() => {\r\n        const matchedPreset = PROMPT_PRESETS.find(p => p.text === systemPrompt);\r\n        setSelectedPresetId(matchedPreset ? matchedPreset.id : 'custom');\r\n    }, [systemPrompt]);\r\n\r\n    const fetchSubjects = useCallback(async () => {\r\n        setIsLoadingSubjects(true);\r\n        setSubjectFetchError('');\r\n        try {\r\n            const response = await api.getSubjects();\r\n            const subjects = Array.isArray(response.subjects) ? response.subjects : [];\r\n            setAvailableSubjects(subjects);\r\n        } catch (error) {\r\n            const errorMsg = error.response?.data?.message || error.message || \"Failed to load subjects.\";\r\n            toast.error(errorMsg);\r\n            setSubjectFetchError(errorMsg);\r\n        } finally {\r\n            setIsLoadingSubjects(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        fetchSubjects();\r\n    }, [fetchSubjects]);\r\n\r\n    const handlePresetChange = (event) => {\r\n        const presetId = event.target.value;\r\n        setSelectedPresetId(presetId);\r\n        const selectedPreset = PROMPT_PRESETS.find(p => p.id === presetId);\r\n        if (selectedPreset) setSystemPrompt(selectedPreset.text);\r\n    };\r\n\r\n    const handleSourceAdded = () => {\r\n        toast.success(\"New source added! Refreshing list...\", { id: 'refresh-toast' });\r\n        setRefreshKey(Date.now());\r\n    };\r\n\r\n    const togglePromptSection = () => {\r\n        const nextState = !isPromptSectionOpen;\r\n        setIsPromptSectionOpen(nextState);\r\n        if (nextState) {\r\n            setIsSubjectSectionOpen(false);\r\n            setIsKnowledgeBaseOpen(false);\r\n        }\r\n    };\r\n\r\n    const toggleSubjectSection = () => {\r\n        const nextState = !isSubjectSectionOpen;\r\n        setIsSubjectSectionOpen(nextState);\r\n        if (nextState) {\r\n            setIsPromptSectionOpen(false);\r\n            setIsKnowledgeBaseOpen(false);\r\n        }\r\n    };\r\n\r\n    const toggleKnowledgeBaseSection = () => {\r\n        const nextState = !isKnowledgeBaseOpen;\r\n        setIsKnowledgeBaseOpen(nextState);\r\n        if (nextState) {\r\n            setIsPromptSectionOpen(false);\r\n            setIsSubjectSectionOpen(false);\r\n        }\r\n    };\r\n    \r\n    const sectionVariants = {\r\n        open: {\r\n            height: 'auto',\r\n            opacity: 1,\r\n            transition: { type: 'spring', stiffness: 400, damping: 40 }\r\n        },\r\n        closed: {\r\n            height: 0,\r\n            opacity: 0,\r\n            transition: { type: 'spring', stiffness: 400, damping: 40 }\r\n        }\r\n    };\r\n\r\n    const SelectedPresetIcon = PROMPT_PRESETS.find(p => p.id === selectedPresetId)?.icon || Settings2;\r\n\r\n    return (\r\n        <div className={`flex flex-col h-full ${isChatProcessing ? 'processing-overlay' : ''}`}>\r\n            <div className=\"flex items-center justify-between mb-3 px-1 pt-1\">\r\n                <h2 className=\"text-sm font-semibold text-text-light dark:text-text-dark\">Assistant Controls</h2>\r\n                <IconButton\r\n                    icon={PanelLeftClose}\r\n                    onClick={() => setIsLeftPanelOpen(false)}\r\n                    title=\"Close Assistant Panel\"\r\n                    variant=\"ghost\" size=\"sm\"\r\n                    className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary\"\r\n                />\r\n            </div>\r\n\r\n            {/* Custom Prompt Section */}\r\n            <div className=\"mb-4\">\r\n                <button onClick={togglePromptSection} className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left text-text-light dark:text-text-dark bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none shadow-sm border border-border-light dark:border-border-dark\" aria-expanded={isPromptSectionOpen}>\r\n                    <span className=\"flex items-center gap-2\"><SelectedPresetIcon size={16} className=\"text-primary dark:text-primary-light\" /> Custom Prompt</span>\r\n                    {isPromptSectionOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n                </button>\r\n                <AnimatePresence initial={false}>\r\n                    {isPromptSectionOpen && (\r\n                        <motion.div \r\n                            key=\"prompt-section-content\" \r\n                            variants={sectionVariants}\r\n                            initial=\"closed\"\r\n                            animate=\"open\"\r\n                            exit=\"closed\"\r\n                            className=\"mt-2 p-3 bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-md shadow-inner overflow-hidden\">\r\n                             <label htmlFor=\"prompt-preset-select\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">Prompt Mode:</label>\r\n                             <select id=\"prompt-preset-select\" value={selectedPresetId} onChange={handlePresetChange} className=\"input-field mb-2 text-xs py-1.5\">\r\n                                 {PROMPT_PRESETS.map(preset => (<option key={preset.id} value={preset.id}>{preset.name}</option>))}\r\n                             </select>\r\n                             <label htmlFor=\"system-prompt-area\" className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark mb-1\">System Prompt (Editable):</label>\r\n                             <textarea id=\"system-prompt-area\" value={systemPrompt} onChange={(e) => { setSystemPrompt(e.target.value); setSelectedPresetId('custom'); }} rows=\"5\" className=\"input-field text-xs custom-scrollbar\" placeholder=\"Enter system prompt...\"/>\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n\r\n            {/* Admin Subjects Section */}\r\n            <div className=\"mb-4\">\r\n                <button onClick={toggleSubjectSection} className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left text-text-light dark:text-text-dark bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none shadow-sm border border-border-light dark:border-border-dark\" aria-expanded={isSubjectSectionOpen}>\r\n                    <span className=\"flex items-center gap-2\"><Library size={16} className=\"text-primary dark:text-primary-light\" /> Admin Subjects</span>\r\n                    {isSubjectSectionOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n                </button>\r\n                <AnimatePresence initial={false}>\r\n                    {isSubjectSectionOpen && (\r\n                        <motion.div \r\n                            key=\"subject-select-content\" \r\n                            variants={sectionVariants}\r\n                            initial=\"closed\"\r\n                            animate=\"open\"\r\n                            exit=\"closed\"\r\n                            className=\"mt-2 p-3 bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-md shadow-inner overflow-hidden\">\r\n                           <SubjectList\r\n                                subjects={availableSubjects}\r\n                                selectedSubject={selectedSubject}\r\n                                onSelectSubject={setSelectedSubject}\r\n                                isLoading={isLoadingSubjects}\r\n                                error={subjectFetchError}\r\n                           />\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n\r\n            {/* User's Knowledge Base Section */}\r\n            <div className=\"flex-grow flex flex-col overflow-hidden\">\r\n                <button onClick={toggleKnowledgeBaseSection} className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left text-text-light dark:text-text-dark bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none shadow-sm border border-border-light dark:border-border-dark mb-2\" aria-expanded={isKnowledgeBaseOpen}>\r\n                    <span className=\"flex items-center gap-2\"><FilePlus size={16} className=\"text-primary dark:text-primary-light\" /> My Knowledge Base</span>\r\n                    {isKnowledgeBaseOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n                </button>\r\n                <AnimatePresence initial={false}>\r\n                    {isKnowledgeBaseOpen && (\r\n                        <motion.div \r\n                            key=\"knowledge-base-content\" \r\n                            variants={sectionVariants}\r\n                            initial=\"closed\"\r\n                            animate=\"open\"\r\n                            exit=\"closed\"\r\n                            className=\"flex-grow flex flex-col p-3 bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-md shadow-inner\">\r\n                            <DocumentUpload onSourceAdded={handleSourceAdded}  />\r\n                            <div className=\"mt-3 flex-grow overflow-y-auto custom-scrollbar\">\r\n                                <KnowledgeSourceList\r\n                                    key={refreshKey}\r\n                                    onSelectSource={selectDocumentForAnalysis}\r\n                                    selectedSource={selectedDocumentForAnalysis}\r\n                                    onRefreshNeeded={refreshKey}\r\n                                />\r\n                            </div>\r\n                        </motion.div>\r\n                    )}\r\n                </AnimatePresence>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\nexport default LeftPanel;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\RightCollapsedNav.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[274,313],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/RightCollapsedNav.jsx\r\nimport React from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport { HelpCircle, GitFork, Tags, ChevronLeft } from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst iconMap = {\r\n    HelpCircle: HelpCircle,\r\n    Tags: Tags,\r\n    GitFork: GitFork,\r\n};\r\n\r\nfunction RightCollapsedNav({ isChatProcessing }) {\r\n    const { setIsRightPanelOpen } = useAppState();\r\n\r\n    const navItems = [\r\n        { id: 'faq', label: 'FAQ Generator', iconName: 'HelpCircle', action: () => { setIsRightPanelOpen(true); /* TODO: set analysis type contextually */ } },\r\n        { id: 'topics', label: 'Key Topics Extractor', iconName: 'Tags', action: () => { setIsRightPanelOpen(true); } },\r\n        { id: 'mindmap', label: 'Mind Map Creator', iconName: 'GitFork', action: () => { setIsRightPanelOpen(true); } },\r\n    ];\r\n\r\n    return (\r\n        <motion.aside\r\n            key=\"right-collapsed-nav\"\r\n            initial={{ x: '100%', opacity: 0 }}\r\n            animate={{ x: '0%', opacity: 1 }}\r\n            exit={{ x: '100%', opacity: 0 }}\r\n            transition={{ type: 'spring', stiffness: 300, damping: 30 }}\r\n            className={`fixed right-0 top-16 bottom-0 z-30 w-14 sm:w-16 bg-surface-light dark:bg-surface-dark border-l border-border-light dark:border-border-dark shadow-lg flex-col items-center py-3 space-y-2 hidden md:flex\r\n                       ${isChatProcessing ? 'processing-overlay' : ''}`}\r\n        >\r\n            {/* Open Panel Button AT THE TOP */}\r\n            <IconButton \r\n                icon={ChevronLeft} \r\n                onClick={() => setIsRightPanelOpen(true)} \r\n                title=\"Open Analyzer Panel\"\r\n                ariaLabel=\"Open Analyzer Panel\"\r\n                variant=\"ghost\" \r\n                size=\"lg\"\r\n                className=\"mb-2 text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                disabled={isChatProcessing}\r\n            />\r\n            {navItems.map(item => {\r\n                 const Icon = iconMap[item.iconName] || HelpCircle;\r\n                return (\r\n                    <IconButton \r\n                        key={item.id}\r\n                        icon={Icon}\r\n                        onClick={item.action}\r\n                        title={item.label}\r\n                        ariaLabel={item.label}\r\n                        variant=\"ghost\"\r\n                        size=\"md\"\r\n                        className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                        disabled={isChatProcessing}\r\n                    />\r\n                );\r\n            })}\r\n        </motion.aside>\r\n    );\r\n}\r\nexport default RightCollapsedNav;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\RightPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'api' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":8,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":11,"suggestions":[{"messageId":"removeVar","data":{"varName":"api"},"fix":{"range":[436,445],"text":""},"desc":"Remove unused variable 'api'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":13,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":13,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[716,755],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'toast' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":14,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":13,"suggestions":[{"messageId":"removeVar","data":{"varName":"toast"},"fix":{"range":[764,775],"text":""},"desc":"Remove unused variable 'toast'."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/RightPanel.jsx\r\nimport React, { useState } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext';\r\nimport AnalysisToolRunner from '../analysis/AnalysisToolRunner.jsx';\r\nimport PodcastGenerator from '../analysis/PodcastGenerator.jsx';\r\nimport KnowledgeGraphViewer from '../analysis/KnowledgeGraphViewer.jsx';\r\nimport RealtimeKgPanel from '../analysis/RealtimeKgPanel.jsx';\r\nimport api from '../../services/api.js';\r\nimport { PanelRightClose, ChevronDown, ChevronUp, Telescope, Radio, BrainCircuit, Share2 } from 'lucide-react';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport Modal from '../core/Modal.jsx';\r\nimport Button from '../core/Button.jsx';\r\nimport { motion } from 'framer-motion';\r\nimport toast from 'react-hot-toast';\r\n\r\nfunction RightPanel({ isChatProcessing }) {\r\n    const { setIsRightPanelOpen, selectedDocumentForAnalysis, selectedSubject } = useAppState();\r\n    const [isAnalyzerOpen, setIsAnalyzerOpen] = useState(true);\r\n    \r\n    // --- THIS IS THE NEW STATE FOR THE LIVE KG MODAL ---\r\n    const [isLiveKgModalOpen, setIsLiveKgModalOpen] = useState(false);\r\n\r\n\r\n    const currentSelectedDocFilename = selectedDocumentForAnalysis || selectedSubject || null;\r\n    const isTargetAdminSubject = !!(selectedSubject && currentSelectedDocFilename && selectedSubject === currentSelectedDocFilename);\r\n\r\n   \r\n\r\n    return (\r\n        <>\r\n                <div className={`flex flex-col h-full p-3 sm:p-4 bg-surface-light dark:bg-surface-dark text-text-light dark:text-text-dark custom-scrollbar ${isChatProcessing ? 'processing-overlay' : ''}`}>                <div className=\"flex items-center justify-between pb-2 border-b border-border-light dark:border-border-dark\">\r\n                    <h2 className=\"text-base font-semibold\">Advanced Tools</h2>\r\n                    <IconButton\r\n                        icon={PanelRightClose}\r\n                        onClick={() => setIsRightPanelOpen(false)}\r\n                        title=\"Close Panel\"\r\n                        variant=\"ghost\" size=\"sm\"\r\n                        className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light\"\r\n                    />\r\n                </div>\r\n                \r\n                <div className=\"flex-grow space-y-4 overflow-y-auto custom-scrollbar pr-1 pt-4\">\r\n                    {/* --- THIS IS THE NEW BUTTON TO LAUNCH THE MODAL --- */}\r\n                    <div className=\"card-base p-3\">\r\n                         <div className=\"flex items-center gap-2 text-sm font-medium mb-2\">\r\n                            <Share2 size={16} className=\"text-primary dark:text-primary-light\" />\r\n                            <span>Live Concept Map</span>\r\n                        </div>\r\n                        <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark mb-3\">\r\n                            Visualize concepts from your current conversation in real-time.\r\n                        </p>\r\n                        <Button onClick={() => setIsLiveKgModalOpen(true)} variant=\"primary\" size=\"sm\" fullWidth leftIcon={<Share2 size={16} />}>\r\n                            Show Live Map\r\n                        </Button>\r\n                    </div>\r\n\r\n                    {/* --- EXISTING STATIC ANALYSIS TOOLS (Conditional) --- */}\r\n                    {currentSelectedDocFilename ? (\r\n                        <>\r\n                            <div>\r\n                                <button onClick={() => setIsAnalyzerOpen(!isAnalyzerOpen)} className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md focus:outline-none shadow-sm border border-border-light dark:border-border-dark\">\r\n                                    <span className=\"flex items-center gap-2\"><Telescope size={16} /> Document Analysis</span>\r\n                                    {isAnalyzerOpen ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\r\n                                </button>\r\n                                {isAnalyzerOpen && (\r\n                                    <motion.div initial={{ height: 0, opacity: 0 }} animate={{ height: 'auto', opacity: 1 }} exit={{ height: 0, opacity: 0 }} transition={{ duration: 0.2, ease: \"easeInOut\" }} className=\"mt-2 space-y-3 overflow-hidden\">\r\n                                        <AnalysisToolRunner toolType=\"faq\" title=\"FAQ Generator\" iconName=\"HelpCircle\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                                        <AnalysisToolRunner toolType=\"topics\" title=\"Key Topics Extractor\" iconName=\"Tags\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                                        <AnalysisToolRunner toolType=\"mindmap\" title=\"Mind Map Creator\" iconName=\"GitFork\" selectedDocumentFilename={currentSelectedDocFilename} isTargetAdminDoc={isTargetAdminSubject} />\r\n                                    </motion.div>\r\n                                )}\r\n                            </div>\r\n                            <div>\r\n                                <div className=\"w-full flex items-center justify-between px-3 py-2.5 text-sm font-medium text-left bg-gray-50 dark:bg-gray-800 rounded-md border border-border-light dark:border-border-dark\">\r\n                                   <span className=\"flex items-center gap-2\"><Radio size={16} /> Content Exporters</span>\r\n                                </div>\r\n                                 <div className=\"mt-2 space-y-3\">\r\n                                    <PodcastGenerator selectedDocumentFilename={currentSelectedDocFilename} />\r\n                                    \r\n                                </div>\r\n                            </div>\r\n                        </>\r\n                    ) : (\r\n                         <div className=\"p-4 mt-4 text-xs text-center text-text-muted-light dark:text-text-muted-dark bg-gray-50 dark:bg-gray-800 rounded-md border border-dashed border-border-light dark:border-border-dark\">\r\n                            <p>Select a document from the left panel to enable static analysis tools.</p>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            {/* --- MODAL FOR THE LIVE KG --- */}\r\n            <Modal isOpen={isLiveKgModalOpen} onClose={() => setIsLiveKgModalOpen(false)} title=\"Live Concept Map (From Conversation)\" size=\"5xl\">\r\n                <div className=\"h-[70vh]\">\r\n                   <RealtimeKgPanel />\r\n                </div>\r\n            </Modal>\r\n        </>\r\n    );\r\n}\r\nexport default RightPanel; ","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\layout\\TopNav.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'tutorMode' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":46,"suggestions":[{"messageId":"removeVar","data":{"varName":"tutorMode"},"fix":{"range":[1346,1357],"text":""},"desc":"Remove unused variable 'tutorMode'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/layout/TopNav.jsx\r\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext';\r\nimport ThemeToggle from '../common/ThemeToggle.jsx';\r\nimport LLMSelectionModal from './LLMSelectionModal.jsx';\r\nimport ProfileSettingsModal from '../profile/ProfileSettingsModal.jsx';\r\nimport { Link } from 'react-router-dom';\r\nimport {\r\n    LogOut, User, MessageSquare, History as HistoryIcon, Settings, Cpu, Zap, ServerCrash, Server, Wrench, GraduationCap\r\n} from 'lucide-react';\r\nimport ToolsModal from '../tools/ToolsModal.jsx';\r\nimport LevelBadge from '../gamification/LevelBadge.jsx';\r\nimport RankBadge from '../gamification/RankBadge.jsx';\r\nimport XPProgressModal from '../gamification/XPProgressModal.jsx';\r\nimport { useUserLevel } from '../../hooks/useUserLevel.jsx';\r\n\r\n\r\n\r\nfunction TopNav({ user: authUser, onLogout, onNewChat, onHistoryClick, orchestratorStatus, isChatProcessing }) {\r\n    const [isLLMModalOpen, setIsLLMModalOpen] = useState(false);\r\n    const [isProfileModalOpen, setIsProfileModalOpen] = useState(false);\r\n    const [isToolsModalOpen, setIsToolsModalOpen] = useState(false);\r\n    const [isXPModalOpen, setIsXPModalOpen] = useState(false);\r\n    const { level, loading: levelLoading } = useUserLevel();\r\n    const { selectedLLM, switchLLM, tutorMode, setTutorMode } = useAppState();\r\n    const handleEnableTutorMode = () => {\r\n        setTutorMode(true);\r\n    };\r\n\r\n    const [isProfileDropdownOpen, setIsProfileDropdownOpen] = useState(false);\r\n    const profileDropdownRef = useRef(null);\r\n\r\n    // Memoize status indicator to prevent unnecessary re-renders\r\n    const getStatusIndicator = useMemo(() => () => {\r\n        if (!orchestratorStatus) return <div title=\"Status unavailable\" className=\"w-4 h-4 bg-gray-400 rounded-full\"></div>;\r\n        if (orchestratorStatus.status === \"ok\") {\r\n            return <Zap size={18} className=\"text-green-400 animate-pulse\" title={`Backend Online: ${orchestratorStatus.message}`} />;\r\n        } else if (orchestratorStatus.status === \"loading\") {\r\n            return <div className=\"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-yellow-400\" title=\"Connecting...\"></div>;\r\n        } else {\r\n            return <ServerCrash size={18} className=\"text-red-400\" title={`Backend Offline: ${orchestratorStatus.message}`} />;\r\n        }\r\n    }, [orchestratorStatus]);\r\n\r\n    useEffect(() => {\r\n        function handleClickOutside(event) {\r\n            if (profileDropdownRef.current && !profileDropdownRef.current.contains(event.target)) {\r\n                setIsProfileDropdownOpen(false);\r\n            }\r\n        }\r\n        document.addEventListener(\"mousedown\", handleClickOutside);\r\n        return () => {\r\n            document.removeEventListener(\"mousedown\", handleClickOutside);\r\n        };\r\n    }, [profileDropdownRef]);\r\n\r\n    return (\r\n        <>\r\n            <nav className=\"fixed top-0 left-0 right-0 z-40 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark shadow-sm h-16 flex items-center justify-between px-2 sm:px-4\">\r\n                <div className=\"flex items-center gap-2\">\r\n                    <a href=\"/\" className=\"flex items-center gap-1.5 sm:gap-2 text-lg sm:text-xl font-semibold text-text-light dark:text-text-dark\">\r\n                        <Server size={24} className=\"text-primary dark:text-primary-light\" />\r\n                        <span className=\"hidden sm:inline\">AI Tutor</span>\r\n                    </a>\r\n                </div>\r\n\r\n                <div className=\"flex-1 flex justify-center px-2\">\r\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\r\n                        <button\r\n                            onClick={onNewChat}\r\n                            className={`flex items-center gap-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md text-sky-700 dark:text-sky-300 bg-sky-500/10 dark:bg-sky-500/20 hover:bg-sky-500/20 dark:hover:bg-sky-500/30 transition-colors ${isChatProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            disabled={isChatProcessing}\r\n                            title=\"Start a new chat session\"\r\n                        >\r\n                            <MessageSquare size={14} /> <span className=\"hidden sm:inline\">New Chat</span>\r\n                        </button>\r\n\r\n                        <button\r\n                            onClick={onHistoryClick}\r\n                            className={`flex items-center gap-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md text-teal-700 dark:text-teal-300 bg-teal-500/10 dark:bg-teal-500/20 hover:bg-teal-500/20 dark:hover:bg-teal-500/30 transition-colors ${isChatProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            disabled={isChatProcessing}\r\n                            title=\"View chat history\"\r\n                        >\r\n                            <HistoryIcon size={14} /> <span className=\"hidden sm:inline\">History</span>\r\n                        </button>\r\n\r\n                        <Link\r\n                            to=\"/study-plan\"\r\n                            className={`flex items-center gap-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md text-indigo-700 dark:text-indigo-300 bg-indigo-500/10 dark:bg-indigo-500/20 hover:bg-indigo-500/20 dark:hover:bg-indigo-500/30 transition-colors ${isChatProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            onClick={(e) => isChatProcessing && e.preventDefault()}\r\n                            title=\"Open your personalized Study Plan\"\r\n                        >\r\n                            <GraduationCap size={14} /> <span className=\"hidden sm:inline\">Study Plan</span>\r\n                        </Link>\r\n\r\n                        <button\r\n                            onClick={() => setIsToolsModalOpen(true)}\r\n                            className={`flex items-center gap-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md text-amber-700 dark:text-amber-400 bg-amber-400/20 dark:bg-amber-500/20 hover:bg-amber-400/30 dark:hover:bg-amber-500/30 transition-colors ${isChatProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            disabled={isChatProcessing}\r\n                            title=\"Open Tools\"\r\n                        >\r\n                            <Wrench size={14} /> <span className=\"hidden sm:inline\">Tools</span>\r\n                        </button>\r\n\r\n                        <button\r\n                            onClick={() => setIsLLMModalOpen(true)}\r\n                            className={`flex items-center gap-1 px-2 py-1.5 text-xs sm:text-sm font-medium rounded-md text-slate-700 dark:text-slate-300 bg-slate-500/10 dark:bg-slate-500/20 hover:bg-slate-500/20 dark:hover:bg-slate-500/30 transition-colors ${isChatProcessing ? 'opacity-50 cursor-not-allowed' : ''}`}\r\n                            disabled={isChatProcessing}\r\n                            title={`Switch LLM (Current: ${selectedLLM.toUpperCase()})`}\r\n                        >\r\n                            <Cpu size={14} /> <span className=\"hidden xs:inline\">{selectedLLM.toUpperCase()}</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n\r\n\r\n                <div className=\"flex items-center gap-1.5 sm:gap-2\">\r\n                    <div className=\"w-8 h-8 flex items-center justify-center\">\r\n                        {getStatusIndicator()}\r\n                    </div>\r\n                    <ThemeToggle disabled={isChatProcessing} />\r\n                    <div className=\"relative\" ref={profileDropdownRef}>\r\n                        {/* User Profile Button with Rank & Level Badges */}\r\n                        <div className=\"flex items-center gap-2\">\r\n                            {/* Rank Badge (Bronze, Silver, Gold, etc.) */}\r\n                            {!levelLoading && level && (\r\n                                <RankBadge\r\n                                    level={level}\r\n                                    size=\"sm\"\r\n                                    showLabel={false}\r\n                                    onClick={() => setIsXPModalOpen(true)}\r\n                                />\r\n                            )}\r\n\r\n                            {/* User Icon with Level Badge Overlay */}\r\n                            <button\r\n                                onClick={() => setIsProfileDropdownOpen(prev => !prev)}\r\n                                className=\"relative p-1.5 bg-primary-light dark:bg-primary-dark text-white rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-surface-light dark:focus:ring-offset-surface-dark focus:ring-primary\"\r\n                            >\r\n                                <User size={18} />\r\n\r\n                                {/* Level Number Badge */}\r\n                                {!levelLoading && level && (\r\n                                    <div className=\"absolute -bottom-1 -right-1 scale-90\">\r\n                                        <LevelBadge level={level} size=\"xs\" />\r\n                                    </div>\r\n                                )}\r\n                            </button>\r\n                        </div>\r\n\r\n                        {/* Profile Dropdown */}\r\n                        <div\r\n                            className={`absolute right-0 mt-2 w-48 bg-surface-light dark:bg-surface-dark rounded-md shadow-lg py-1 transition-all duration-150 ease-in-out transform origin-top-right z-50\r\n                                ${isProfileDropdownOpen\r\n                                    ? 'opacity-100 scale-100 visible'\r\n                                    : 'opacity-0 scale-95 invisible'\r\n                                }`\r\n                            }\r\n                        >\r\n                            <div className=\"px-4 py-2 text-sm text-text-light dark:text-text-dark border-b border-border-light dark:border-border-dark\">\r\n                                Signed in as <br /><strong>{authUser?.username || 'User'}</strong>\r\n                                {!levelLoading && level && (\r\n                                    <div className=\"mt-2\">\r\n                                        <RankBadge level={level} size=\"sm\" showLabel={true} />\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                            <button\r\n                                onClick={() => { setIsProfileModalOpen(true); setIsProfileDropdownOpen(false); }}\r\n                                className=\"w-full text-left px-4 py-2 text-sm text-text-light dark:text-text-dark hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2\"\r\n                            >\r\n                                <Settings size={16} /> Profile\r\n                            </button>\r\n                            <button\r\n                                onClick={() => { onLogout(); setIsProfileDropdownOpen(false); }}\r\n                                className=\"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900 flex items-center gap-2\"\r\n                            >\r\n                                <LogOut size={16} /> Logout\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </nav>\r\n            <LLMSelectionModal\r\n                isOpen={isLLMModalOpen}\r\n                onClose={() => setIsLLMModalOpen(false)}\r\n                currentLLM={selectedLLM}\r\n                onSelectLLM={(llm) => {\r\n                    switchLLM(llm);\r\n                    setIsLLMModalOpen(false);\r\n                }}\r\n            />\r\n            <ProfileSettingsModal\r\n                isOpen={isProfileModalOpen}\r\n                onClose={() => setIsProfileModalOpen(false)}\r\n            />\r\n            {/* The ToolsModal is now correctly managed here */}\r\n            <ToolsModal\r\n                isOpen={isToolsModalOpen}\r\n                onClose={() => setIsToolsModalOpen(false)}\r\n                onEnableTutorMode={handleEnableTutorMode}\r\n            />\r\n            {/* XP Progress Modal */}\r\n            <XPProgressModal\r\n                isOpen={isXPModalOpen}\r\n                onClose={() => setIsXPModalOpen(false)}\r\n                level={level}\r\n            />\r\n        </>\r\n    );\r\n}\r\nexport default TopNav;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\learning\\StudyPlanPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":11,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[678,685],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'onModuleUpdate' is defined but never used.","line":21,"column":39,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":53,"suggestions":[{"messageId":"removeVar","data":{"varName":"onModuleUpdate"},"fix":{"range":[941,957],"text":""},"desc":"Remove unused variable 'onModuleUpdate'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'newSessionId' is defined but never used.","line":58,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":58,"endColumn":26,"suggestions":[{"messageId":"removeVar","data":{"varName":"newSessionId"},"fix":{"range":[2359,2371],"text":""},"desc":"Remove unused variable 'newSessionId'."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'location.pathname'. Either include it or remove the dependency array.","line":153,"column":8,"nodeType":"ArrayExpression","endLine":153,"endColumn":34,"suggestions":[{"desc":"Update the dependencies array to be: [location.pathname, location.state, navigate]","fix":{"range":[6679,6705],"text":"[location.pathname, location.state, navigate]"}}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/learning/StudyPlanPage.jsx\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { useAppState } from '../../contexts/AppStateContext.jsx';\r\nimport { Link, useNavigate, useLocation } from 'react-router-dom';\r\nimport { Home, Plus, Loader2, AlertTriangle, CheckCircle, Lock, Circle, GraduationCap, FileText, Globe, Code, BookMarked, ChevronLeft, Sparkles, Trash2, ChevronDown, ChevronUp } from 'lucide-react';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport Button from '../core/Button';\r\nimport Modal from '../core/Modal.jsx';\r\nimport IconButton from '../core/IconButton.jsx';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst iconMap = {\r\n    direct_answer: GraduationCap,\r\n    document_review: FileText,\r\n    web_search: Globe,\r\n    academic_search: BookMarked,\r\n    code_executor: Code,\r\n};\r\n\r\nconst ModuleItem = ({ module, pathId, onModuleUpdate, isNextUp, handleNewChat, onLocalModuleUpdate }) => {\r\n    const navigate = useNavigate();\r\n    const [isUpdating, setIsUpdating] = useState(false);\r\n    const { setInitialPromptForNewSession, setInitialActivityForNewSession } = useAppState();\r\n\r\n    const handleStatusToggle = async () => {\r\n        setIsUpdating(true);\r\n        const newStatus = module.status === 'completed' ? 'not_started' : 'completed';\r\n\r\n        // Optimistic UI Update\r\n        onLocalModuleUpdate(module.moduleId, newStatus);\r\n\r\n        try {\r\n            await api.updateModuleStatus(pathId, module.moduleId, newStatus);\r\n            toast.success(`Module '${module.title}' marked as ${newStatus}.`);\r\n            // No full refetch needed, UI is already updated\r\n        } catch (error) {\r\n            toast.error(`Failed to update module: ${error.message}`);\r\n            // Revert UI on error\r\n            onLocalModuleUpdate(module.moduleId, module.status);\r\n        } finally {\r\n            setIsUpdating(false);\r\n        }\r\n    };\r\n\r\n    const handleStartModule = () => {\r\n        const { activity } = module;\r\n        \r\n        if (activity.type === 'code_executor') {\r\n            navigate('/tools/code-executor');\r\n            return;\r\n        }\r\n        \r\n        setInitialPromptForNewSession(activity.suggestedPrompt);\r\n        setInitialActivityForNewSession(activity);\r\n\r\n        handleNewChat(\r\n            (newSessionId) => {\r\n                if (activity.type === 'direct_answer' || activity.type === 'web_search' || activity.type === 'academic_search' || activity.type === 'document_review') {\r\n                    navigate('/');\r\n                }\r\n            },\r\n            true, true\r\n        );\r\n    };\r\n\r\n    const ActivityIcon = iconMap[module.activity.type] || GraduationCap;\r\n    const isLocked = module.status === 'locked';\r\n    const isCompleted = module.status === 'completed';\r\n\r\n    return (\r\n        <div className={`flex items-start gap-4 p-4 border-l-4 ${isCompleted ? 'border-green-500 bg-green-500/5' : isNextUp ? 'border-primary' : 'border-transparent'}`}>\r\n            <div className=\"flex-shrink-0 mt-1\">\r\n                {isUpdating ? (\r\n                    <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\r\n                ) : (\r\n                    <button onClick={handleStatusToggle} disabled={isLocked} className=\"disabled:opacity-50 disabled:cursor-not-allowed\">\r\n                        {isLocked ? <Lock className=\"w-6 h-6 text-text-muted-light dark:text-text-muted-dark\" /> :\r\n                         isCompleted ? <CheckCircle className=\"w-6 h-6 text-green-500\" /> :\r\n                         <Circle className=\"w-6 h-6 text-text-muted-light dark:text-text-muted-dark hover:text-primary\" />}\r\n                    </button>\r\n                )}\r\n            </div>\r\n            <div className=\"flex-grow\">\r\n                <h4 className={`font-semibold ${isCompleted ? 'line-through text-text-muted-light dark:text-text-muted-dark' : 'text-text-light dark:text-text-dark'}`}>\r\n                    {module.title}\r\n                </h4>\r\n                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark mt-1 italic\">\"{module.objective}\"</p>\r\n                <div className=\"flex items-center gap-2 text-xs mt-2 text-text-muted-light dark:text-text-muted-dark\">\r\n                    <ActivityIcon size={14} />\r\n                    <span>Activity: {module.activity.resourceName ? `${module.activity.type} (${module.activity.resourceName})` : module.activity.type}</span>\r\n                </div>\r\n            </div>\r\n            {isNextUp && !isCompleted && (\r\n                <div className=\"flex-shrink-0 self-center\">\r\n                    <Button size=\"sm\" onClick={handleStartModule}>Start Module</Button>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst CreatePlan = ({ onPlanCreated }) => {\r\n    const [goal, setGoal] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [questionnaire, setQuestionnaire] = useState(null);\r\n    const [currentStep, setCurrentStep] = useState(0);\r\n    const [answers, setAnswers] = useState([]);\r\n    const location = useLocation();\r\n    const navigate = useNavigate();\r\n    const formRef = useRef(null);\r\n\r\n    const handleInitialGenerate = useCallback(async (e) => {\r\n        if (e) e.preventDefault();\r\n        const currentGoal = goal.trim();\r\n        if (!currentGoal) {\r\n            toast.error(\"Please enter a learning goal.\");\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        try {\r\n            const response = await api.generateLearningPath(currentGoal);\r\n            if (response.isQuestionnaire) {\r\n                setQuestionnaire(response.questions);\r\n                setAnswers(new Array(response.questions.length).fill(''));\r\n                setCurrentStep(0);\r\n            } else {\r\n                toast.success(\"New study plan created successfully!\");\r\n                resetForm();\r\n                onPlanCreated();\r\n            }\r\n        } catch (error) {\r\n            toast.error(`Failed to start plan generation: ${error.message}`);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, [goal, onPlanCreated]);\r\n    \r\n    useEffect(() => {\r\n        const locationState = location.state;\r\n        if (locationState?.prefilledGoal) {\r\n            const prefilledGoal = locationState.prefilledGoal;\r\n            setGoal(prefilledGoal);\r\n            \r\n            setTimeout(() => {\r\n                if (formRef.current) {\r\n                    formRef.current.requestSubmit();\r\n                }\r\n            }, 100);\r\n\r\n            navigate(location.pathname, { replace: true, state: {} });\r\n        }\r\n    }, [location.state, navigate]);\r\n\r\n    const handleAnswerChange = (index, value) => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[index] = value;\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const handleFinalSubmit = async (e) => {\r\n        if(e) e.preventDefault();\r\n        setIsLoading(true);\r\n        const context = {\r\n            clarificationAnswers: questionnaire.map((q, i) => ({ question: q.questionText, answer: answers[i] }))\r\n        };\r\n        try {\r\n            await api.generateLearningPath(goal.trim(), context);\r\n            toast.success(\"Your personalized study plan has been created!\");\r\n            resetForm();\r\n            onPlanCreated();\r\n        } catch (error) {\r\n            toast.error(`Failed to create personalized plan: ${error.message}`);\r\n            resetForm();\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n    \r\n    const resetForm = () => {\r\n        setGoal(''); setQuestionnaire(null); setCurrentStep(0); setAnswers([]);\r\n    };\r\n\r\n    const renderContent = () => {\r\n        if (isLoading) { return ( <motion.div key=\"loading-spinner\" initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className=\"flex flex-col items-center justify-center py-12 text-center\"> <Loader2 className=\"w-12 h-12 animate-spin text-primary\" /> <p className=\"mt-4 text-lg font-semibold text-text-light dark:text-text-dark\">We're doing magic, please wait...</p> <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">Generating your personalized study plan.</p> </motion.div> ); }\r\n        if (questionnaire) {\r\n            const question = questionnaire[currentStep];\r\n            return ( <motion.div key={`question-step-${currentStep}`} initial={{ opacity: 0, x: 50 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -50 }} transition={{ duration: 0.3 }} className=\"space-y-4\"> <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">Step {currentStep + 1} of {questionnaire.length}</p> <h3 className=\"text-lg font-semibold my-2 text-text-light dark:text-text-dark\">{question.questionText}</h3> {question.type === 'multiple_choice' ? ( <div className=\"space-y-2 mt-4\">{question.options.map(option => ( <label key={option} className={`flex items-center p-3 border rounded-lg cursor-pointer transition-colors ${answers[currentStep] === option ? 'border-primary bg-primary/10' : 'border-border-light dark:border-border-dark'}`}> <input type=\"radio\" name={`q-${currentStep}`} value={option} checked={answers[currentStep] === option} onChange={() => handleAnswerChange(currentStep, option)} className=\"form-radio\" /> <span className=\"ml-3\">{option}</span> </label> ))}</div> ) : ( <input type=\"text\" value={answers[currentStep]} onChange={(e) => handleAnswerChange(currentStep, e.target.value)} className=\"input-field mt-4\" placeholder=\"Type your answer here...\" /> )} <div className=\"flex justify-between items-center mt-6\"> <Button variant=\"secondary\" onClick={() => currentStep > 0 ? setCurrentStep(s => s - 1) : resetForm()} disabled={isLoading}>{currentStep > 0 ? 'Back' : 'Cancel'}</Button> {currentStep < questionnaire.length - 1 ? ( <Button onClick={() => setCurrentStep(s => s + 1)} disabled={!answers[currentStep] || isLoading}>Next</Button> ) : ( <Button onClick={handleFinalSubmit} isLoading={isLoading} disabled={!answers[currentStep] || isLoading}>Generate My Plan</Button> )} </div> </motion.div> );\r\n        }\r\n        return ( <motion.div key=\"initial-goal-input\" initial={{ opacity: 0, x: 50 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -50 }} transition={{ duration: 0.3 }} className=\"space-y-6\"> <h2 className=\"text-lg font-semibold text-center mb-4 text-text-light dark:text-text-dark\">What is your learning goal?</h2> <textarea value={goal} onChange={(e) => setGoal(e.target.value)} placeholder=\"e.g., 'Master Python for data science'...\" className=\"input-field w-full min-h-[80px] custom-scrollbar resize-y\" disabled={isLoading} /> <Button type=\"submit\" isLoading={isLoading} leftIcon={<Sparkles size={16} />} className=\"w-full\">Generate Plan</Button> </motion.div> );\r\n    };\r\n\r\n    return ( \r\n        <form ref={formRef} id=\"create-plan-form\" onSubmit={handleInitialGenerate} className=\"p-4 sm:p-6\">\r\n            <AnimatePresence mode=\"wait\">\r\n                {renderContent()}\r\n            </AnimatePresence>\r\n        </form>\r\n    );\r\n};\r\n\r\nconst StudyPlanPage = ({ handleNewChat }) => {\r\n    const [learningPaths, setLearningPaths] = useState([]);\r\n    const [isLoading, setIsLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const [selectedStudyPlan, setSelectedStudyPlan] = useState(null);\r\n    const [showCreatePlanModal, setShowCreatePlanModal] = useState(false);\r\n    const [showDeleteConfirmModal, setShowDeleteConfirmModal] = useState(false);\r\n    const [planToDelete, setPlanToDelete] = useState(null);\r\n\r\n    const handleDeletePlan = async () => {\r\n        if (!planToDelete) return;\r\n        const toastId = toast.loading(`Deleting plan \"${planToDelete.title}\"...`);\r\n        try {\r\n            await api.deleteLearningPath(planToDelete._id);\r\n            toast.success(`Plan \"${planToDelete.title}\" deleted!`, { id: toastId });\r\n            if (selectedStudyPlan && selectedStudyPlan._id === planToDelete._id) {\r\n                setSelectedStudyPlan(null);\r\n            }\r\n            fetchPaths();\r\n        } catch (error) {\r\n            toast.error(`Failed to delete plan: ${error.message}`, { id: toastId });\r\n        } finally {\r\n            setShowDeleteConfirmModal(false);\r\n            setPlanToDelete(null);\r\n        }\r\n    };\r\n\r\n    const fetchPaths = useCallback(async () => {\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const paths = await api.getLearningPaths();\r\n            setLearningPaths(paths);\r\n        } catch (err) {\r\n            setError(err.message || 'Failed to fetch learning paths.');\r\n            toast.error(err.message || 'Failed to fetch learning paths.');\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => { fetchPaths(); }, [fetchPaths]);\r\n\r\n    const handleLocalModuleUpdate = useCallback((moduleId, newStatus) => {\r\n        setSelectedStudyPlan(currentPlan => {\r\n            if (!currentPlan) return null;\r\n            const newModules = currentPlan.modules.map(m =>\r\n                m.moduleId === moduleId ? { ...m, status: newStatus } : m\r\n            );\r\n            if (newStatus === 'completed') {\r\n                const moduleIndex = newModules.findIndex(m => m.moduleId === moduleId);\r\n                if (moduleIndex !== -1 && moduleIndex + 1 < newModules.length && newModules[moduleIndex + 1].status === 'locked') {\r\n                    newModules[moduleIndex + 1].status = 'not_started';\r\n                }\r\n            }\r\n            const updatedPlan = { ...currentPlan, modules: newModules };\r\n\r\n            // ALSO update the main list view state (learningPaths)\r\n            setLearningPaths(currentPaths => \r\n                currentPaths.map(path => \r\n                    path._id === updatedPlan._id ? updatedPlan : path\r\n                )\r\n            );\r\n            \r\n            return updatedPlan;\r\n        });\r\n    }, []);\r\n\r\n    const renderStudyPlanDetails = (plan) => {\r\n        const nextUpModule = plan.modules.find(m => m.status === 'not_started' || m.status === 'in_progress');\r\n        return (\r\n            <motion.div key={plan._id} initial={{ opacity: 0, x: 50 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -50 }} transition={{ duration: 0.3 }} className=\"card-base p-6\">\r\n                <h2 className=\"text-xl font-bold mb-4 text-text-light dark:text-text-dark\">{plan.title}</h2>\r\n                <div className=\"divide-y divide-border-light dark:divide-border-dark\">\r\n                    {plan.modules.map(module => (\r\n                        <ModuleItem\r\n                            key={module.moduleId}\r\n                            module={module}\r\n                            pathId={plan._id}\r\n                            onModuleUpdate={fetchPaths}\r\n                            onLocalModuleUpdate={handleLocalModuleUpdate}\r\n                            isNextUp={nextUpModule?.moduleId === module.moduleId}\r\n                            handleNewChat={handleNewChat}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            </motion.div>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-screen bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark font-sans\">\r\n            <header className=\"flex-shrink-0 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark h-16 flex items-center justify-center px-6 z-10\">\r\n                <h1 className=\"text-3xl font-extrabold text-primary dark:text-primary-light\">My Study Plans</h1>\r\n            </header>\r\n            <div className=\"flex-shrink-0 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark px-4 sm:px-6 py-3 flex items-center justify-between\">\r\n                {selectedStudyPlan ? (\r\n                    <button onClick={() => setSelectedStudyPlan(null)} className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light flex items-center gap-1.5 font-medium text-sm\">\r\n                        <ChevronLeft size={18} /> Back to All Plans\r\n                    </button>\r\n                ) : (\r\n                    <Link to=\"/\" className=\"text-text-muted-light dark:text-text-muted-dark hover:text-primary dark:hover:text-primary-light flex items-center gap-1.5 font-medium text-sm\">\r\n                        <ChevronLeft size={18} /> Back to Main App\r\n                    </Link>\r\n                )}\r\n                <button onClick={() => setShowCreatePlanModal(true)} className=\"animated-border-button\">\r\n                    <span>Generate New Plan âœ¨</span>\r\n                </button>\r\n            </div>\r\n            <main className=\"flex-1 overflow-y-auto p-4 sm:p-6 md:p-8 custom-scrollbar\">\r\n                <div className=\"max-w-4xl mx-auto\">\r\n                    {isLoading && ( <div className=\"text-center p-8\"> <Loader2 className=\"w-8 h-8 mx-auto animate-spin text-primary\" /> <p className=\"mt-2 text-text-muted-light dark:text-text-muted-dark\">Loading your plans...</p> </div> )}\r\n                    {error && !isLoading && ( <div className=\"p-4 bg-red-500/10 text-red-500 rounded-md text-center\"> <AlertTriangle className=\"w-6 h-6 mx-auto mb-2\" /> <p>{error}</p> <Button onClick={fetchPaths} size=\"sm\" variant=\"outline\" className=\"mt-4\">Retry</Button> </div> )}\r\n                    <AnimatePresence mode=\"wait\">\r\n                    {selectedStudyPlan ? (\r\n                        <motion.div key=\"study-plan-details-view\" initial={{ opacity: 0, x: 50 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: -50 }} transition={{ duration: 0.3 }}>\r\n                            {renderStudyPlanDetails(selectedStudyPlan)}\r\n                        </motion.div>\r\n                    ) : (\r\n                        <motion.div key=\"study-plan-list-view\" initial={{ opacity: 0, x: -50 }} animate={{ opacity: 1, x: 0 }} exit={{ opacity: 0, x: 50 }} transition={{ duration: 0.3 }}>\r\n                            {!isLoading && !error && learningPaths.length === 0 && ( <div className=\"text-center py-12 text-text-muted-light dark:text-text-muted-dark\"> <GraduationCap size={48} className=\"mx-auto opacity-50 mb-4\" /> <h3 className=\"font-semibold text-lg\">No Study Plans Found</h3> <p>Create your first plan above to get started on a personalized learning journey!</p> </div> )}\r\n                            {!isLoading && !error && learningPaths.length > 0 && (\r\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n                                    {learningPaths.map(path => {\r\n                                        const isCompleted = path.modules.every(m => m.status === 'completed');\r\n                                        const hasStarted = !isCompleted && path.modules.some(m => m.status !== 'not_started' && m.status !== 'locked');\r\n                                        let statusText = 'Not Yet Started', statusColor = 'text-gray-500 dark:text-gray-400';\r\n                                        if (isCompleted) { statusText = 'Completed'; statusColor = 'text-green-600 dark:text-green-400'; }\r\n                                        else if (hasStarted) { statusText = 'Ongoing'; statusColor = 'text-blue-600 dark:text-blue-400'; }\r\n                                        return ( \r\n                                        <motion.div key={path._id} className=\"card-base overflow-hidden p-0 relative\" initial={{ opacity: 0, y: 20 }} animate={{ opacity: 1, y: 0 }} exit={{ opacity: 0, y: -20 }} transition={{ duration: 0.3, ease: \"easeOut\" }}>\r\n                                             <div onClick={() => setSelectedStudyPlan(path)}\r\n                                                 className=\"flex items-center justify-between px-6 py-4 bg-gray-50 dark:bg-gray-800/50 border-b border-border-light dark:border-border-dark cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors\">\r\n                                                     <h2 className=\"flex-grow text-lg font-semibold text-text-light dark:text-text-dark truncate\" title={path.title}>{path.title}</h2> \r\n                                                     <div className=\"flex-shrink-0 ml-4 flex items-center gap-2\"> \r\n                                                        <span className={`text-xs font-medium ${statusColor}`}>{statusText}</span> \r\n                                                        <IconButton icon={Trash2} onClick={(e) => { e.stopPropagation(); setPlanToDelete(path); setShowDeleteConfirmModal(true); }} title=\"Delete Study Plan\" size=\"sm\" variant=\"ghost\" className=\"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300\"/> </div> </div> </motion.div> );\r\n                                    })}\r\n                                </div>\r\n                            )}\r\n                        </motion.div>\r\n                    )}\r\n                    </AnimatePresence>\r\n                </div>\r\n            </main>\r\n            <Modal isOpen={showCreatePlanModal} onClose={() => setShowCreatePlanModal(false)} title=\"Generate New Study Plan\" size=\"lg\">\r\n                <CreatePlan onPlanCreated={() => { fetchPaths(); setShowCreatePlanModal(false); }} />\r\n            </Modal>\r\n             <Modal\r\n                isOpen={showDeleteConfirmModal}\r\n                onClose={() => setShowDeleteConfirmModal(false)}\r\n                title=\"Confirm Deletion\"\r\n                size=\"sm\"\r\n                footerContent={\r\n                    <>\r\n                        <Button variant=\"secondary\" onClick={() => setShowDeleteConfirmModal(false)}>Cancel</Button>\r\n                        <Button variant=\"danger\" onClick={handleDeletePlan}>Delete</Button>\r\n                    </>\r\n                }a\r\n            >\r\n                <p className=\"text-center text-text-light dark:text-text-dark text-lg py-4\">\r\n                    Are you sure you want to delete the study plan \"{planToDelete?.title}\"?\r\n                    This action cannot be undone.\r\n                </p>\r\n            </Modal>\r\n        </div>\r\n    );\r\n};\r\nexport default StudyPlanPage;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\onboarding\\OnboardingCard.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[86,125],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":27,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":27,"endColumn":15,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[585,596],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/onboarding/OnboardingCard.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\nimport Button from '../core/Button';\r\n\r\nconst cardVariants = {\r\n    enter: (direction) => ({\r\n        x: direction > 0 ? 300 : -300,\r\n        opacity: 0,\r\n        scale: 0.95\r\n    }),\r\n    center: {\r\n        zIndex: 1,\r\n        x: 0,\r\n        opacity: 1,\r\n        scale: 1\r\n    },\r\n    exit: (direction) => ({\r\n        zIndex: 0,\r\n        x: direction < 0 ? 300 : -300,\r\n        opacity: 0,\r\n        scale: 0.95\r\n    })\r\n};\r\n\r\nconst OnboardingCard = ({\r\n    icon: Icon, title, description, visual,\r\n    isFinalStep, isFirstStep, onNext, onPrev, onSkip, onFinish\r\n}) => {\r\n    const [direction, setDirection] = React.useState(0);\r\n\r\n    const handleNext = () => { setDirection(1); onNext(); };\r\n    const handlePrev = () => { setDirection(-1); onPrev(); };\r\n\r\n    return (\r\n        <motion.div\r\n            custom={direction}\r\n            variants={cardVariants}\r\n            initial=\"enter\"\r\n            animate=\"center\"\r\n            exit=\"exit\"\r\n            transition={{\r\n                x: { type: \"spring\", stiffness: 300, damping: 30 },\r\n                opacity: { duration: 0.2 }\r\n            }}\r\n            className=\"bg-surface-light dark:bg-surface-dark rounded-2xl shadow-2xl p-6 sm:p-8 overflow-hidden\"\r\n        >\r\n            <div className=\"text-center\">\r\n                <div className=\"inline-flex items-center justify-center p-3 bg-primary/10 rounded-xl mb-4\">\r\n                    <Icon className=\"h-10 w-10 text-primary\" />\r\n                </div>\r\n                <h2 className=\"text-2xl font-bold text-text-light dark:text-text-dark\">{title}</h2>\r\n                <p className=\"mt-2 text-base text-text-muted-light dark:text-text-muted-dark max-w-md mx-auto\">{description}</p>\r\n            </div>\r\n\r\n            <div className=\"my-8 h-32 flex items-center justify-center\">\r\n                <div className=\"w-48 h-full flex items-center justify-center text-center bg-gray-50 dark:bg-gray-800 border border-border-light dark:border-border-dark rounded-lg\">\r\n                    {visual}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"flex items-center justify-between\">\r\n                <Button variant=\"ghost\" size=\"sm\" onClick={onSkip} className=\"text-text-muted-light dark:text-text-muted-dark\">\r\n                    {isFinalStep ? \"Go to App\" : \"Skip Tutorial\"}\r\n                </Button>\r\n                <div className=\"flex items-center gap-2\">\r\n                    {!isFirstStep && (\r\n                        <Button variant=\"outline\" size=\"sm\" onClick={handlePrev}>\r\n                            Back\r\n                        </Button>\r\n                    )}\r\n                    {isFinalStep ? (\r\n                        <Button size=\"sm\" onClick={onFinish}>\r\n                            Start Learning!\r\n                        </Button>\r\n                    ) : (\r\n                         <Button size=\"sm\" onClick={handleNext}>\r\n                            Next\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default OnboardingCard;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\onboarding\\OnboardingFlow.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[120,127],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":97,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":97,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleFinish'. Either include it or remove the dependency array.","line":111,"column":8,"nodeType":"ArrayExpression","endLine":111,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [handleFinish]","fix":{"range":[5736,5738],"text":"[handleFinish]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/onboarding/OnboardingFlow.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { \r\n    LayoutDashboard, UploadCloud, MessagesSquare, BrainCircuit, Telescope, Wrench, GraduationCap, PartyPopper, Plus, Sparkles, ArrowRight\r\n} from 'lucide-react';\r\nimport OnboardingCard from './OnboardingCard';\r\nimport OnboardingProgress from './OnboardingProgress';\r\nimport OnboardingVisual from './OnboardingVisual';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\n\r\nconst ONBOARDING_STEPS = [\r\n    {\r\n        icon: LayoutDashboard,\r\n        title: \"Welcome to Your AI Mentor!\",\r\n        description: \"This quick tour will show you how to get the most out of iMentor. Let's explore your new personal learning assistant.\",\r\n        visual: <div className=\"text-6xl animate-bounce\">ðŸ‘‹</div>\r\n    },\r\n    {\r\n        icon: UploadCloud,\r\n        title: \"Build Your Knowledge Base\",\r\n        description: \"Start by uploading your own documents or pasting URLs. Your AI will use these as its primary source of truth for answering your questions.\",\r\n        visual: <OnboardingVisual icon={UploadCloud} label=\"Located in Left Panel\" subLabel=\"Add Files & URLs\" />\r\n    },\r\n    {\r\n        icon: MessagesSquare,\r\n        title: \"Master the Conversation\",\r\n        description: \"Use the '+' menu to enable Web Search for current events. Click the 'âœ¨' icon to ask the Prompt Coach for help asking better questions!\",\r\n        visual: (\r\n            <div className=\"w-full h-full flex flex-col items-center justify-center p-2 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-border-light dark:border-border-dark rounded-lg\">\r\n                <p className=\"text-xs font-semibold mb-2\">In the Chat Input Bar:</p>\r\n                <div className=\"flex items-center gap-4\">\r\n                    <div className=\"flex flex-col items-center\">\r\n                        <Plus className=\"w-8 h-8 text-primary p-1 bg-primary/10 rounded\" />\r\n                        <span className=\"text-xs mt-1\">Options</span>\r\n                    </div>\r\n                    <div className=\"flex flex-col items-center\">\r\n                        <Sparkles className=\"w-8 h-8 text-amber-500 p-1 bg-amber-500/10 rounded\" />\r\n                        <span className=\"text-xs mt-1\">Coach</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    },\r\n    {\r\n        icon: BrainCircuit,\r\n        title: \"Enable Critical Thinking Mode\",\r\n        description: \"Click the 'ðŸ§ ' icon to activate a more advanced reasoning engine. The AI will think step-by-step and provide prompts to challenge its own answers.\",\r\n        visual: <OnboardingVisual icon={BrainCircuit} label=\"Located in Chat Input\" subLabel=\"Click the Brain Icon\" />\r\n    },\r\n    {\r\n        icon: Telescope,\r\n        title: \"Analyze & Synthesize Content\",\r\n        description: \"After selecting a source from your Knowledge Base, use the Right Panel to instantly generate FAQs, Mind Maps, and even full audio podcasts.\",\r\n        visual: (\r\n             <div className=\"w-full h-full flex items-center justify-center p-2 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-border-light dark:border-border-dark rounded-lg\">\r\n                <div className=\"flex items-center gap-2 text-center text-xs font-semibold text-text-muted-light dark:text-text-muted-dark\">\r\n                    <span>Select Source<br/>(Left Panel)</span>\r\n                    <ArrowRight className=\"w-6 h-6 text-primary flex-shrink-0\" />\r\n                    <span>Run Analysis<br/>(Right Panel)</span>\r\n                </div>\r\n            </div>\r\n        )\r\n    },\r\n    {\r\n        icon: Wrench,\r\n        title: \"Explore the Toolbox\",\r\n        description: \"Access powerful standalone utilities like the Secure Code Executor, AI Quiz Generator, and Academic Integrity Checker from the top navigation bar.\",\r\n        visual: <OnboardingVisual icon={Wrench} label=\"Located in Top Navigation\" subLabel=\"Click the 'Tools' Button\" />\r\n    },\r\n    {\r\n        icon: GraduationCap,\r\n        title: \"Create Your Study Plan\",\r\n        description: \"Based on your chats, iMentor can suggest personalized study plans. Visit the 'Study Plan' page to generate a step-by-step curriculum for any goal.\",\r\n        visual: <OnboardingVisual icon={GraduationCap} label=\"Located in Top Navigation\" subLabel=\"Click the 'Study Plan' Button\" />\r\n    },\r\n    {\r\n        icon: PartyPopper,\r\n        title: \"You're All Set!\",\r\n        description: \"You've mastered the basics. Now it's time to start your personalized learning journey. Let's begin!\",\r\n        visual: <div className=\"text-6xl animate-pulse\">ðŸš€</div>\r\n    }\r\n];\r\n\r\nconst OnboardingFlow = ({ onComplete }) => {\r\n    const [step, setStep] = useState(0);\r\n\r\n    const handleNext = () => setStep(prev => Math.min(prev + 1, ONBOARDING_STEPS.length - 1));\r\n    const handlePrev = () => setStep(prev => Math.max(prev - 1, 0));\r\n    \r\n    const handleFinish = async () => {\r\n        try {\r\n            await api.completeOnboarding();\r\n            toast.success(\"Welcome aboard!\");\r\n            onComplete();\r\n        } catch (error) {\r\n            toast.error(\"Could not save onboarding status, but you can proceed.\");\r\n            onComplete();\r\n        }\r\n    };\r\n    \r\n    useEffect(() => {\r\n        const handleKeyDown = (e) => {\r\n            if (e.key === 'ArrowRight') handleNext();\r\n            if (e.key === 'ArrowLeft') handlePrev();\r\n            if (e.key === 'Escape') handleFinish();\r\n        };\r\n        window.addEventListener('keydown', handleKeyDown);\r\n        return () => window.removeEventListener('keydown', handleKeyDown);\r\n    }, []);\r\n\r\n    const currentStepData = ONBOARDING_STEPS[step];\r\n\r\n    return (\r\n        <motion.div\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            className=\"fixed inset-0 z-[100] bg-black/70 backdrop-blur-md flex items-center justify-center p-4\"\r\n        >\r\n            <div className=\"w-full max-w-2xl\">\r\n                <OnboardingProgress current={step + 1} total={ONBOARDING_STEPS.length} />\r\n                <AnimatePresence mode=\"wait\">\r\n                    <OnboardingCard\r\n                        key={step}\r\n                        icon={currentStepData.icon}\r\n                        title={currentStepData.title}\r\n                        description={currentStepData.description}\r\n                        visual={currentStepData.visual}\r\n                        isFinalStep={step === ONBOARDING_STEPS.length - 1}\r\n                        onNext={handleNext}\r\n                        onPrev={handlePrev}\r\n                        onSkip={handleFinish}\r\n                        onFinish={handleFinish}\r\n                        isFirstStep={step === 0}\r\n                    />\r\n                </AnimatePresence>\r\n            </div>\r\n        </motion.div>\r\n    );\r\n};\r\n\r\nexport default OnboardingFlow;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\onboarding\\OnboardingProgress.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":3,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[90,129],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/onboarding/OnboardingProgress.jsx\r\nimport React from 'react';\r\nimport { motion } from 'framer-motion';\r\n\r\nconst OnboardingProgress = ({ current, total }) => {\r\n    const progressPercentage = (current / total) * 100;\r\n\r\n    return (\r\n        <div className=\"mb-4 text-center\">\r\n            <p className=\"text-sm font-medium text-gray-300 mb-2\">\r\n                Step {current} of {total}\r\n            </p>\r\n            <div className=\"w-full bg-slate-700/50 rounded-full h-1.5\">\r\n                <motion.div\r\n                    className=\"bg-primary h-1.5 rounded-full\"\r\n                    initial={{ width: '0%' }}\r\n                    animate={{ width: `${progressPercentage}%` }}\r\n                    transition={{ ease: \"easeInOut\", duration: 0.5 }}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OnboardingProgress;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\onboarding\\OnboardingVisual.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":4,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":39,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[118,129],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/onboarding/OnboardingVisual.jsx\r\nimport React from 'react';\r\n\r\nconst OnboardingVisual = ({ icon: Icon, label, subLabel }) => {\r\n    return (\r\n        <div className=\"w-full h-full flex flex-col items-center justify-center text-center p-4 bg-gray-50 dark:bg-gray-800 border-2 border-dashed border-border-light dark:border-border-dark rounded-lg\">\r\n            <div className=\"p-3 bg-primary/10 rounded-lg\">\r\n                <Icon className=\"w-8 h-8 text-primary\" />\r\n            </div>\r\n            <p className=\"mt-2 font-semibold text-sm text-text-light dark:text-text-dark\">{label}</p>\r\n            {subLabel && <p className=\"text-xs text-text-muted-light dark:text-text-muted-dark\">{subLabel}</p>}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default OnboardingVisual;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\profile\\ProfileSettingsModal.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'selectFieldStyledClass' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":106,"column":11,"nodeType":"Identifier","messageId":"unusedVar","endLine":106,"endColumn":33,"suggestions":[{"messageId":"removeVar","data":{"varName":"selectFieldStyledClass"},"fix":{"range":[4201,4274],"text":""},"desc":"Remove unused variable 'selectFieldStyledClass'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/profile/ProfileSettingsModal.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport Modal from '../core/Modal.jsx';\r\nimport Button from '../core/Button.jsx';\r\nimport { Save, User, School, Hash, Award, Wrench, Calendar, Lightbulb, Goal, ChevronDown } from 'lucide-react';\r\n\r\nconst yearOptions = {\r\n    \"Bachelor's\": [\"1st Year\", \"2nd Year\", \"3rd Year\", \"4th Year\"],\r\n    \"Master's\": [\"1st Year\", \"2nd Year\"],\r\n    \"PhD\": [\"Coursework\", \"Research Phase\", \"Writing Phase\"],\r\n    \"Diploma\": [\"1st Year\", \"2nd Year\", \"3rd Year\"]\r\n};\r\n\r\nconst getYearOptions = (degree) => {\r\n    return yearOptions[degree] || [\"1st Year\", \"2nd Year\", \"3rd Year\", \"4th Year\", \"Graduated\"];\r\n};\r\n\r\nconst ProfileSettingsModal = ({ isOpen, onClose }) => {\r\n    const [profile, setProfile] = useState({\r\n        name: '',\r\n        college: '',\r\n        universityNumber: '',\r\n        degreeType: '',\r\n        branch: '',\r\n        year: ''\r\n    });\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            const fetchProfile = async () => {\r\n                setIsLoading(true);\r\n                setError('');\r\n                try {\r\n                    const data = await api.getUserProfile();\r\n                    // Set profile data, ensuring defaults for any missing fields\r\n                    setProfile({\r\n                        name: data.name || '',\r\n                        college: data.college || '',\r\n                        universityNumber: data.universityNumber || '',\r\n                        degreeType: data.degreeType || \"Bachelor's\",\r\n                        branch: data.branch || 'Computer Science',\r\n                        year: data.year || '1st Year',\r\n                        learningStyle: data.learningStyle || 'Visual', // Add new field with default\r\n                        currentGoals: data.currentGoals || '' // Add new field with default\r\n                    });\r\n                } catch (err) {\r\n                    toast.error('Failed to load profile data.');\r\n                    setError(err.message || 'Could not fetch profile.');\r\n                } finally {\r\n                    setIsLoading(false);\r\n                }\r\n            };\r\n            fetchProfile();\r\n        }\r\n    }, [isOpen]);\r\n\r\n    const handleChange = (e) => {\r\n        const { name, value } = e.target;\r\n        setProfile(prev => {\r\n            const newState = { ...prev, [name]: value };\r\n            if (name === 'degreeType') {\r\n                const newYearOptions = getYearOptions(value);\r\n                newState.year = newYearOptions[0];\r\n            }\r\n            return newState;\r\n        });\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n        // Simple validation\r\n        for (const key in profile) {\r\n            // --- THIS IS THE FIX ---\r\n            // Skip validation for the optional 'currentGoals' field\r\n            if (key === 'currentGoals') {\r\n                continue;\r\n            }\r\n            // --- END FIX ---\r\n            if (!profile[key] || profile[key].trim() === '') {\r\n                toast.error(`Please fill out the '${key.replace(/([A-Z])/g, ' $1').trim()}' field.`);\r\n                return;\r\n            }\r\n        }\r\n        setIsLoading(true);\r\n        setError('');\r\n        try {\r\n            const response = await api.updateUserProfile(profile);\r\n            toast.success(response.message || 'Profile updated successfully!');\r\n            onClose();\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || err.message || 'Failed to update profile.';\r\n            setError(errorMessage);\r\n            toast.error(errorMessage);\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n    \r\n    const inputWrapperClass = \"relative\";\r\n    const inputIconClass = \"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-text-muted-light dark:text-text-muted-dark pointer-events-none\";\r\n    const inputFieldStyledClass = \"input-field pl-10 py-2.5 text-sm\";\r\n    const selectFieldStyledClass = \"input-field !pl-10 !pr-8 py-2.5 text-sm\";\r\n\r\n    return (\r\n        <Modal\r\n            isOpen={isOpen}\r\n            onClose={onClose}\r\n            title=\"Student Profile Settings\"\r\n            size=\"lg\"\r\n            footerContent={\r\n                <>\r\n                    <Button variant=\"secondary\" onClick={onClose} disabled={isLoading}>Cancel</Button>\r\n                    <Button onClick={handleSubmit} isLoading={isLoading} leftIcon={<Save size={16} />}>\r\n                        Save Changes\r\n                    </Button>\r\n                </>\r\n            }\r\n        >\r\n            <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n                {error && <p className=\"text-sm text-red-500\">{error}</p>}\r\n                \r\n                {/* --- Academic Details Section --- */}\r\n                <h3 className=\"text-sm font-semibold text-text-muted-light dark:text-text-muted-dark border-b border-border-light dark:border-border-dark pb-2\">Academic Profile</h3>\r\n                <div className={inputWrapperClass}>\r\n                    <User className={inputIconClass} />\r\n                    <input type=\"text\" name=\"name\" value={profile.name} onChange={handleChange} placeholder=\"Full Name\" className={inputFieldStyledClass} required />\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                    <div className={inputWrapperClass}>\r\n                        <School className={inputIconClass} />\r\n                        <input type=\"text\" name=\"college\" value={profile.college} onChange={handleChange} placeholder=\"College / Institution\" className={inputFieldStyledClass} required />\r\n                    </div>\r\n                    <div className={inputWrapperClass}>\r\n                        <Hash className={inputIconClass} />\r\n                        <input type=\"text\" name=\"universityNumber\" value={profile.universityNumber} onChange={handleChange} placeholder=\"University Number\" className={inputFieldStyledClass} required />\r\n                    </div>\r\n                </div>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n                    <div className={inputWrapperClass}>\r\n                        <Award className={inputIconClass} />\r\n                        <select name=\"degreeType\" value={profile.degreeType} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                            <option>Bachelor's</option><option>Master's</option><option>PhD</option><option>Diploma</option>\r\n                        </select>\r\n                        <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                    </div>\r\n                    <div className={inputWrapperClass}>\r\n                        <Wrench className={inputIconClass} />\r\n                        <select name=\"branch\" value={profile.branch} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                        <option>Computer Science</option><option>Mechanical</option><option>Electrical</option><option>Civil</option><option>Electronics</option><option>Other</option>\r\n                        </select>\r\n                        <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                    </div>\r\n                    <div className={inputWrapperClass}>\r\n                        <Calendar className={inputIconClass} />\r\n                        <select name=\"year\" value={profile.year} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                            {getYearOptions(profile.degreeType).map(option => (\r\n                                <option key={option} value={option}>{option}</option>\r\n                            ))}\r\n                        </select>\r\n                        <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                {/* --- Learning Preferences Section --- */}\r\n                <h3 className=\"text-sm font-semibold text-text-muted-light dark:text-text-muted-dark border-b border-border-light dark:border-border-dark pb-2 pt-4\">Learning Preferences</h3>\r\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 items-start\">\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark\">Preferred Learning Style</label>\r\n                        <div className={inputWrapperClass}>\r\n                            <Lightbulb className={inputIconClass} />\r\n                            <select name=\"learningStyle\" value={profile.learningStyle} onChange={handleChange} className=\"input-field !pl-10 !pr-8 py-2.5 text-sm appearance-none text-left\" required>\r\n                                <option>Visual</option>\r\n                                <option>Auditory</option>\r\n                                <option>Reading/Writing</option>\r\n                                <option>Kinesthetic</option>\r\n                            </select>\r\n                            <ChevronDown size={16} className=\"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"space-y-1\">\r\n                        <label className=\"block text-xs font-medium text-text-muted-light dark:text-text-muted-dark\">Current Learning Goals (Optional)</label>\r\n                        <div className={inputWrapperClass}>\r\n                            <Goal className={inputIconClass} />\r\n                            <textarea name=\"currentGoals\" value={profile.currentGoals} onChange={handleChange} placeholder=\"e.g., Prepare for my AI exam...\" className={`${inputFieldStyledClass} !h-[42px] resize-none`} maxLength=\"500\"></textarea>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n        </Modal>\r\n    );\r\n};\r\n\r\nexport default ProfileSettingsModal;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\AIAssistantBot.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[197,204],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/AIAssistantBot.jsx\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { Bot, Loader2, AlertTriangle, Sparkles, X } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport IconButton from '../core/IconButton';\r\nimport Button from '../core/Button';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { marked } from 'marked';\r\nimport DOMPurify from 'dompurify';\r\nimport Prism from 'prismjs';\r\n\r\nconst createMarkup = (markdownText) => {\r\n    if (!markdownText) return { __html: '' };\r\n    const rawHtml = marked.parse(markdownText);\r\n    const cleanHtml = DOMPurify.sanitize(rawHtml, { USE_PROFILES: { html: true } });\r\n    return { __html: cleanHtml };\r\n};\r\n\r\nconst AIAssistantBot = ({ code, language }) => {\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [analysis, setAnalysis] = useState('');\r\n    const [error, setError] = useState('');\r\n    const contentRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (isOpen && analysis && contentRef.current) {\r\n            const timer = setTimeout(() => Prism.highlightAllUnder(contentRef.current), 50);\r\n            return () => clearTimeout(timer);\r\n        }\r\n    }, [isOpen, analysis]);\r\n    \r\n    const handleAnalyze = async () => {\r\n        if (!code.trim()) {\r\n            toast.error(\"There is no code to analyze.\");\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        setError('');\r\n        setAnalysis('');\r\n        const toastId = toast.loading(\"AI is analyzing your code...\");\r\n\r\n        try {\r\n            const response = await api.analyzeCode({ code, language });\r\n            setAnalysis(response.analysis);\r\n            toast.success(\"Code analysis complete!\", { id: toastId });\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || \"Failed to get AI analysis.\";\r\n            setError(errorMessage);\r\n            toast.error(errorMessage, { id: toastId });\r\n        } finally {\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"fixed bottom-6 right-6 z-50\">\r\n                <motion.button\r\n                    whileHover={{ scale: 1.1, backgroundColor: \"var(--color-primary-dark)\" }}\r\n                    whileTap={{ scale: 0.9 }}\r\n                    onClick={() => setIsOpen(true)}\r\n                    title=\"AI Assistant\"\r\n                    className=\"bg-primary text-white rounded-full p-4 shadow-lg flex items-center justify-center\"\r\n                    style={{'--color-primary-dark': '#2563eb'}} // For tailwind color access in motion\r\n                >\r\n                    <Bot size={28} />\r\n                </motion.button>\r\n            </div>\r\n\r\n            <AnimatePresence>\r\n                {isOpen && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4\"\r\n                        onClick={() => setIsOpen(false)}\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.9, opacity: 0 }}\r\n                            animate={{ scale: 1, opacity: 1 }}\r\n                            exit={{ scale: 0.9, opacity: 0 }}\r\n                            onClick={(e) => e.stopPropagation()}\r\n                            className=\"bg-surface-light dark:bg-surface-dark w-full max-w-2xl h-[70vh] rounded-lg shadow-2xl flex flex-col\"\r\n                        >\r\n                            <header className=\"flex items-center justify-between p-4 border-b border-border-light dark:border-border-dark\">\r\n                                <h3 className=\"font-semibold flex items-center gap-2 text-text-light dark:text-text-dark\">\r\n                                    <Sparkles className=\"text-primary\"/> AI Assistant\r\n                                </h3>\r\n                                <IconButton icon={X} onClick={() => setIsOpen(false)} title=\"Close\" />\r\n                            </header>\r\n\r\n                            <div className=\"p-4 flex-shrink-0\">\r\n                                <Button onClick={handleAnalyze} size=\"sm\" variant=\"primary\" isLoading={isLoading} disabled={!code.trim()}>\r\n                                    Analyze Current Code\r\n                                </Button>\r\n                            </div>\r\n                            \r\n                            <div className=\"flex-grow p-4 border-t border-border-light dark:border-border-dark overflow-y-auto custom-scrollbar\">\r\n                                {isLoading && (\r\n                                    <div className=\"flex justify-center items-center h-full text-text-muted-light dark:text-text-muted-dark\">\r\n                                        <Loader2 size={24} className=\"animate-spin mr-2\" /> Analyzing...\r\n                                    </div>\r\n                                )}\r\n                                {error && !isLoading && (\r\n                                    <div className=\"p-3 text-red-400 text-sm\"><AlertTriangle className=\"inline mr-2\" />{error}</div>\r\n                                )}\r\n                                {!isLoading && !error && !analysis && (\r\n                                     <div className=\"flex justify-center items-center h-full text-center text-sm text-text-muted-light dark:text-text-muted-dark p-4\">\r\n                                        Click \"Analyze Code\" to get an AI-powered review.\r\n                                    </div>\r\n                                )}\r\n                                {analysis && !isLoading && (\r\n                                    <div \r\n                                        ref={contentRef}\r\n                                        className=\"prose prose-sm dark:prose-invert max-w-none text-text-light dark:text-text-dark\"\r\n                                        dangerouslySetInnerHTML={createMarkup(analysis)}\r\n                                    />\r\n                                )}\r\n                            </div>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default AIAssistantBot;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\AIAssistantPanel.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\AcademicIntegrityPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useCallback' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":57,"suggestions":[{"messageId":"removeVar","data":{"varName":"useCallback"},"fix":{"range":[103,116],"text":""},"desc":"Remove unused variable 'useCallback'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'monaco' is defined but never used.","line":53,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":53,"endColumn":49,"suggestions":[{"messageId":"removeVar","data":{"varName":"monaco"},"fix":{"range":[2178,2186],"text":""},"desc":"Remove unused variable 'monaco'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'pollErr' is defined but never used.","line":102,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":102,"endColumn":29},{"ruleId":"no-undef","severity":2,"message":"'monaco' is not defined.","line":133,"column":28,"nodeType":"Identifier","messageId":"undef","endLine":133,"endColumn":34}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/AcademicIntegrityPage.jsx\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Home, UploadCloud } from 'lucide-react';\r\nimport { Panel, PanelGroup, PanelResizeHandle } from 'react-resizable-panels';\r\nimport Editor from '@monaco-editor/react';\r\nimport IntegrityReportPanel from './IntegrityReportPanel';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport Button from '../core/Button';\r\nimport { useTheme } from '../../hooks/useTheme';\r\n// For client-side text extraction\r\nimport * as pdfjsLib from 'pdfjs-dist/build/pdf';\r\nimport mammoth from 'mammoth';\r\n// pdfjsLib.GlobalWorkerOptions.workerSrc = `//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjsLib.version}/pdf.worker.min.js`;\r\npdfjsLib.GlobalWorkerOptions.workerSrc = `/pdf.worker.min.mjs`;\r\n\r\n\r\n\r\n// Step 1: Navigate to the Correct Directory\r\n// // PS C:\\Users\\Asus\\Desktop\\chatbot-Team-2\\frontend>\r\n// npm install pdfjs-dist\r\n// ls node_modules/pdfjs-dist/build/\r\n// You should see pdf.worker.min.mjs listed in the output.\r\n// Step 4: Run the Correct Copy Command for Windows\r\n// copy node_modules\\pdfjs-dist\\build\\pdf.worker.min.mjs public\\\r\n\r\n\r\n\r\n\r\nconst ANALYSIS_STEPS = [\r\n    { name: \"Submitting for Analysis\", progress: 10 },\r\n    { name: \"Checking for Biased Language\", progress: 30 },\r\n    { name: \"Analyzing Readability\", progress: 50 },\r\n    { name: \"Submitting to Plagiarism Detector\", progress: 70 },\r\n    { name: \"Awaiting Plagiarism Report\", progress: 90 },\r\n    { name: \"Completed\", progress: 100 }\r\n];\r\n\r\nconst AcademicIntegrityPage = () => {\r\n    const { theme } = useTheme();\r\n    const [text, setText] = useState('');\r\n    const [report, setReport] = useState(null);\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [currentStep, setCurrentStep] = useState(0);\r\n    const [error, setError] = useState('');\r\n    const [selectedFinding, setSelectedFinding] = useState(null);\r\n    \r\n    const editorRef = useRef(null);\r\n    const decorationsRef = useRef([]);\r\n    const pollingIntervalRef = useRef(null);\r\n\r\n    const handleEditorDidMount = (editor, monaco) => {\r\n        editorRef.current = editor;\r\n    };\r\n\r\n    const handleAnalyze = async () => {\r\n        if (text.trim().length < 50) {\r\n            toast.error(\"Please provide at least 50 characters of text for analysis.\");\r\n            return;\r\n        }\r\n        setIsLoading(true);\r\n        setError('');\r\n        setReport(null);\r\n        setCurrentStep(0);\r\n\r\n        try {\r\n            const { reportId, initialReport } = await api.submitIntegrityCheck({ text });\r\n            setReport(initialReport);\r\n\r\n            if(initialReport.bias) setCurrentStep(1);\r\n            if(initialReport.readability) setCurrentStep(2);\r\n            if(initialReport.plagiarism) setCurrentStep(3);\r\n            \r\n            if (initialReport.plagiarism?.status === 'pending') {\r\n                setCurrentStep(4);\r\n                startPolling(reportId);\r\n            } else {\r\n                setIsLoading(false);\r\n                setCurrentStep(5);\r\n            }\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || \"Failed to start analysis.\";\r\n            setError(errorMessage);\r\n            toast.error(errorMessage);\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    const startPolling = (reportId) => {\r\n        pollingIntervalRef.current = setInterval(async () => {\r\n            try {\r\n                const updatedReport = await api.getIntegrityReport(reportId);\r\n                setReport(updatedReport);\r\n\r\n                if (updatedReport.plagiarism?.status === 'completed' || updatedReport.plagiarism?.status === 'error') {\r\n                    stopPolling();\r\n                    setIsLoading(false);\r\n                    setCurrentStep(5);\r\n                    toast.success(\"Plagiarism check complete!\");\r\n                }\r\n            } catch (pollErr) {\r\n                stopPolling();\r\n                setIsLoading(false);\r\n                setError(\"Failed to retrieve the final plagiarism report.\");\r\n                toast.error(\"Failed to retrieve the final plagiarism report.\");\r\n            }\r\n        }, 5000);\r\n    };\r\n    \r\n    const stopPolling = () => {\r\n        if (pollingIntervalRef.current) {\r\n            clearInterval(pollingIntervalRef.current);\r\n            pollingIntervalRef.current = null;\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        return () => stopPolling();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (!editorRef.current || !selectedFinding) return;\r\n\r\n        const editor = editorRef.current;\r\n        const model = editor.getModel();\r\n        if (!model) return;\r\n\r\n        const matches = model.findMatches(selectedFinding.text, true, false, true, null, true);\r\n        if (matches.length > 0) {\r\n            const range = matches[0].range;\r\n            const newDecorations = [{\r\n                range: new monaco.Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn),\r\n                options: { className: 'highlighted-finding', isWholeLine: false }\r\n            }];\r\n            decorationsRef.current = editor.deltaDecorations(decorationsRef.current, newDecorations);\r\n            editor.revealRangeInCenter(range);\r\n        }\r\n    }, [selectedFinding]);\r\n\r\nconst handleApplySuggestion = (finding) => {\r\n        const { text: originalText, suggestion } = finding;\r\n        const editor = editorRef.current;\r\n        if (!editor) return;\r\n\r\n        const model = editor.getModel();\r\n        if (!model) return;\r\n\r\n        // Find the first occurrence of the biased text\r\n        const matches = model.findMatches(originalText, true, false, true, null, true);\r\n\r\n        if (matches.length > 0) {\r\n            const range = matches[0].range;\r\n            \r\n            // Create an \"edit\" operation to replace the text\r\n            const op = { range: range, text: suggestion };\r\n            \r\n            // Execute the edit and clear the selection/highlight\r\n            editor.executeEdits('bias-fix', [op]);\r\n            editor.setSelection(range); // Optional: select the newly inserted text\r\n            \r\n            // Clear the highlight decoration\r\n            decorationsRef.current = editor.deltaDecorations(decorationsRef.current, []);\r\n            setSelectedFinding(null); // Clear the selected finding state\r\n            \r\n            toast.success('Suggestion applied!');\r\n        } else {\r\n            toast.error(`Could not find the text \"${originalText}\" to replace. It may have already been changed.`);\r\n        }\r\n    };\r\n\r\n    // --- THIS IS THE CORRECTED FUNCTION ---\r\n    const handleFileUpload = async (e) => {\r\n        const file = e.target.files[0];\r\n        if (!file) return;\r\n\r\n        const toastId = toast.loading(`Extracting text from ${file.name}...`);\r\n        \r\n        // This function wraps FileReader in a promise for clean async/await usage\r\n        const readFileAsArrayBuffer = (inputFile) => {\r\n            return new Promise((resolve, reject) => {\r\n                const reader = new FileReader();\r\n                reader.onload = () => resolve(reader.result);\r\n                reader.onerror = () => reject(reader.error);\r\n                reader.readAsArrayBuffer(inputFile);\r\n            });\r\n        };\r\n\r\n        try {\r\n            let extractedText = '';\r\n            const fileType = file.type;\r\n\r\n            if (fileType === 'application/pdf') {\r\n                const fileBuffer = await readFileAsArrayBuffer(file);\r\n                const typedarray = new Uint8Array(fileBuffer);\r\n                const pdf = await pdfjsLib.getDocument(typedarray).promise;\r\n                let fullText = '';\r\n                for (let i = 1; i <= pdf.numPages; i++) {\r\n                    const page = await pdf.getPage(i);\r\n                    const textContent = await page.getTextContent();\r\n                    fullText += textContent.items.map(item => item.str).join(' ');\r\n                }\r\n                extractedText = fullText;\r\n            } else if (fileType === 'application/vnd.openxmlformats-officedocument.wordprocessingml.document') {\r\n                const fileBuffer = await readFileAsArrayBuffer(file);\r\n                const { value } = await mammoth.extractRawText({ arrayBuffer: fileBuffer });\r\n                extractedText = value;\r\n            } else {\r\n                // .text() is already a promise, so it's naturally await-able\r\n                extractedText = await file.text();\r\n            }\r\n\r\n            setText(extractedText); // Set the state with the final extracted text\r\n            toast.success(\"Text extracted successfully!\", { id: toastId });\r\n\r\n        } catch (err) {\r\n            console.error(\"File extraction error:\", err);\r\n            toast.error(\"Failed to extract text from file.\", { id: toastId });\r\n        }\r\n    };\r\n    // --- END OF CORRECTION ---\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-screen bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark font-sans\">\r\n             <style>{`.highlighted-finding { background-color: #fef9c3; } .monaco-editor .margin { background-color: ${theme === 'dark' ? '#1E293B' : '#FFFFFF'}; }`}</style>\r\n            <header className=\"flex-shrink-0 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark h-16 flex items-center justify-between px-6 z-10\">\r\n                <h1 className=\"text-xl font-bold\">Academic Integrity Checker</h1>\r\n                <Link to=\"/\" className=\"flex items-center gap-2 text-sm btn btn-ghost\">\r\n                    <Home size={16}/> Back to Main App\r\n                </Link>\r\n            </header>\r\n\r\n            <div className=\"flex-1 overflow-hidden p-2 md:p-4\">\r\n                <PanelGroup direction=\"horizontal\" className=\"h-full\">\r\n                    <Panel defaultSize={50} minSize={30}>\r\n                        <div className=\"p-2 h-full flex flex-col\">\r\n                            <div className=\"flex-shrink-0 flex justify-between items-center mb-2\">\r\n                                <h2 className=\"font-semibold\">Your Document</h2>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                     <Button\r\n                                        onClick={() => document.getElementById('file-upload').click()}\r\n                                        size=\"sm\" variant=\"outline\" leftIcon={<UploadCloud size={14}/>}\r\n                                    >\r\n                                        Upload\r\n                                    </Button>\r\n                                    <input type=\"file\" id=\"file-upload\" className=\"hidden\" onChange={handleFileUpload} accept=\".pdf,.docx,.txt\" />\r\n                                    <Button onClick={handleAnalyze} size=\"sm\" isLoading={isLoading}>\r\n                                        Analyze Document\r\n                                    </Button>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex-grow border border-border-light dark:border-border-dark rounded-md overflow-hidden\">\r\n                                <Editor\r\n                                    onMount={handleEditorDidMount}\r\n                                    value={text}\r\n                                    onChange={(value) => setText(value || '')}\r\n                                    theme={theme === 'dark' ? 'vs-dark' : 'light'}\r\n                                    options={{ wordWrap: 'on', minimap: { enabled: false } }}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </Panel>\r\n                    <PanelResizeHandle className=\"w-2 panel-resize-handle\" />\r\n                    <Panel defaultSize={50} minSize={30}>\r\n                        <div className=\"p-2 h-full\">\r\n                           <IntegrityReportPanel\r\n                                report={report}\r\n                                isLoading={isLoading}\r\n                                error={error}\r\n                                steps={ANALYSIS_STEPS}\r\n                                currentStep={currentStep}\r\n                                onFindingSelect={setSelectedFinding}\r\n                                onApplySuggestion={handleApplySuggestion}\r\n                            />\r\n                        </div>\r\n                    </Panel>\r\n                </PanelGroup>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default AcademicIntegrityPage;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\CodeEditor.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\CodeEditorWrapper.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":4,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[171,178],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/CodeEditorWrapper.jsx\r\nimport React, { useState } from 'react';\r\nimport { Play, Copy, ChevronDown, Check } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport Button from '../core/Button';\r\nimport IconButton from '../core/IconButton';\r\nimport CodeEditor from './CodeEditor';\r\nimport toast from 'react-hot-toast';\r\nimport { copyToClipboard } from '../../utils/helpers';\r\n\r\nconst CodeEditorWrapper = ({ code, setCode, language, setLanguage, onExecute, isExecuting }) => {\r\n    \r\n    const [copied, setCopied] = useState(false);\r\n\r\n    const handleCopy = async () => {\r\n        const success = await copyToClipboard(code);\r\n        if (success) {\r\n            toast.success(\"Code copied to clipboard!\");\r\n            setCopied(true);\r\n            setTimeout(() => setCopied(false), 2000); // Reset after 2 seconds\r\n        } else {\r\n            toast.error(\"Failed to copy code.\");\r\n        }\r\n    };\r\n    \r\n    return (\r\n        <div className=\"flex flex-col h-full bg-surface-light dark:bg-surface-dark rounded-lg border border-border-light dark:border-border-dark\">\r\n            <header className=\"flex items-center justify-between p-2 border-b border-border-light dark:border-border-dark flex-shrink-0\">\r\n                <div className=\"relative\">\r\n                    <select \r\n                        value={language}\r\n                        onChange={(e) => setLanguage(e.target.value)}\r\n                        className=\"input-field !text-xs !py-1 !pl-3 !pr-8 appearance-none\"\r\n                    >\r\n                        <option value=\"python\">Python</option>\r\n                        <option value=\"java\">Java</option>\r\n                        <option value=\"c\">C</option>\r\n                        <option value=\"cpp\">C++</option>\r\n                    </select>\r\n                    <ChevronDown size={14} className=\"absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none text-text-muted-light dark:text-text-muted-dark\" />\r\n                </div>\r\n                <div className=\"flex items-center gap-2\">\r\n                    <IconButton \r\n                        icon={() => (\r\n                            <AnimatePresence mode=\"wait\" initial={false}>\r\n                                <motion.span\r\n                                    key={copied ? 'check' : 'copy'}\r\n                                    initial={{ opacity: 0, scale: 0.8 }}\r\n                                    animate={{ opacity: 1, scale: 1 }}\r\n                                    exit={{ opacity: 0, scale: 0.8 }}\r\n                                    transition={{ duration: 0.15 }}\r\n                                >\r\n                                    {copied ? <Check className=\"text-green-500\" /> : <Copy />}\r\n                                </motion.span>\r\n                            </AnimatePresence>\r\n                        )} \r\n                        size=\"sm\" \r\n                        onClick={handleCopy} \r\n                        title=\"Copy Code\" \r\n                    />\r\n                    <Button onClick={onExecute} size=\"sm\" leftIcon={<Play size={14}/>} isLoading={isExecuting}>\r\n                        Run\r\n                    </Button>\r\n                </div>\r\n            </header>\r\n            <div className=\"flex-grow overflow-hidden\">\r\n                <CodeEditor code={code} setCode={setCode} language={language} />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default CodeEditorWrapper;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\CodeExecutorPage.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\IntegrityReportPanel.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'Icon' is defined but never used.","line":8,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":37,"suggestions":[{"messageId":"removeVar","data":{"varName":"Icon"},"fix":{"range":[368,380],"text":""},"desc":"Remove unused variable 'Icon'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/IntegrityReportPanel.jsx\r\nimport React from 'react';\r\nimport { Loader2, AlertTriangle, ShieldCheck, CheckCircle, Percent, Lightbulb, Scale, BookOpen, Wand2 } from 'lucide-react'; // Import Wand2\r\nimport ReadabilityMetrics from './ReadabilityMetrics';\r\nimport Button from '../core/Button'; // Import Button\r\n\r\n\r\nconst Section = ({ title, icon: Icon, children }) => (\r\n    <div className=\"border border-border-light dark:border-border-dark rounded-lg overflow-hidden\">\r\n        <h3 className=\"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-800/50 border-b border-border-light dark:border-border-dark font-semibold\">\r\n            <Icon className=\"text-primary\" size={18} /> {title}\r\n        </h3>\r\n        <div className=\"p-4 text-sm\">{children}</div>\r\n    </div>\r\n);\r\n\r\nconst IntegrityReportPanel = ({ report, isLoading, error, steps, currentStep, onFindingSelect, onApplySuggestion }) => { // Add onApplySuggestion prop\r\n    \r\n    if (isLoading) {\r\n        \r\n        const stepInfo = steps[currentStep];\r\n        return (\r\n            <div className=\"h-full flex flex-col justify-center items-center text-center p-4\">\r\n                <Loader2 className=\"animate-spin text-primary\" size={40} />\r\n                <h3 className=\"mt-4 text-lg font-semibold\">Analysis in Progress...</h3>\r\n                <div className=\"w-full max-w-sm bg-gray-200 dark:bg-gray-700 rounded-full h-2 my-3\">\r\n                    <div className=\"bg-primary h-2 rounded-full transition-all duration-500\" style={{ width: `${stepInfo.progress}%` }}></div>\r\n                </div>\r\n                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">{stepInfo.name}</p>\r\n            </div>\r\n        );\r\n    }\r\n    \r\n    if (error) {\r\n        return (\r\n             <div className=\"h-full flex flex-col justify-center items-center text-center p-4 text-red-500\">\r\n                <AlertTriangle size={40} />\r\n                <h3 className=\"mt-4 text-lg font-semibold\">Analysis Failed</h3>\r\n                <p className=\"text-sm\">{error}</p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    if (!report) {\r\n        return (\r\n            <div className=\"h-full flex flex-col justify-center items-center text-center p-4\">\r\n                <ShieldCheck className=\"text-gray-400\" size={40} />\r\n                <h3 className=\"mt-4 text-lg font-semibold\">Analysis Report</h3>\r\n                <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark\">\r\n                    Your academic integrity report will appear here once the analysis is complete.\r\n                </p>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const { plagiarism, bias, readability } = report; // <-- ADDED readability\r\n\r\n    return (\r\n        <div className=\"h-full flex flex-col bg-surface-light dark:bg-surface-dark border border-border-light dark:border-border-dark rounded-lg\">\r\n            <header className=\"flex-shrink-0 p-4 border-b border-border-light dark:border-border-dark\">\r\n                <h2 className=\"font-semibold\">Analysis Report</h2>\r\n            </header>\r\n            <div className=\"flex-grow p-4 space-y-4 overflow-y-auto custom-scrollbar\">\r\n                \r\n                {/* Plagiarism Section */}\r\n                <Section title=\"Plagiarism Check\" icon={Percent}>\r\n                    {plagiarism?.status === 'pending' && <p className=\"text-text-muted-light dark:text-text-muted-dark\">Awaiting report...</p>}\r\n                    {plagiarism?.status === 'error' && <p className=\"text-red-500\">{plagiarism.message}</p>}\r\n                    {plagiarism?.status === 'completed' && plagiarism.report && (\r\n                        <div className=\"space-y-2\">\r\n                             <p><strong>Overall Similarity Score:</strong> {plagiarism.report.overall_score}%</p>\r\n                             <a href={plagiarism.report.full_report_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-primary hover:underline\">View Full Turnitin Report</a>\r\n                        </div>\r\n                    )}\r\n                </Section>\r\n                \r\n                {/* Bias Section */}\r\n                <Section title=\"Bias & Inclusivity\" icon={Scale}>\r\n                    {Array.isArray(bias) ? (\r\n                        bias.length === 0 ? (\r\n                            <p className=\"flex items-center gap-2 text-green-600\"><CheckCircle size={16}/> No potential issues found.</p>\r\n                        ) : (\r\n                            <ul className=\"space-y-3\">\r\n                                {bias.map((item, i) => (\r\n                                    // --- START OF CHANGES FOR THIS COMPONENT ---\r\n                                    <li key={i} className=\"p-3 bg-yellow-400/10 rounded-md\">\r\n                                        <div \r\n                                            className=\"cursor-pointer hover:bg-yellow-400/20 -m-1 p-1 rounded\" \r\n                                            onClick={() => onFindingSelect(item)}\r\n                                            title=\"Click to highlight in editor\"\r\n                                        >\r\n                                            <p><strong>Found:</strong> \"{item.text}\"</p>\r\n                                            <p><strong>Suggestion:</strong> \"{item.suggestion}\"</p>\r\n                                            <p className=\"text-xs mt-1 text-text-muted-light dark:text-text-muted-dark\"><strong>Reason:</strong> {item.reason}</p>\r\n                                        </div>\r\n                                        <div className=\"mt-2 text-right\">\r\n                                            <Button \r\n                                                size=\"sm\" \r\n                                                variant=\"outline\" \r\n                                                className=\"!text-xs !py-1 !px-2\"\r\n                                                leftIcon={<Wand2 size={12} />}\r\n                                                onClick={(e) => {\r\n                                                    e.stopPropagation(); // Prevent the li's onClick from firing\r\n                                                    onApplySuggestion(item);\r\n                                                }}\r\n                                            >\r\n                                                Apply Suggestion\r\n                                            </Button>\r\n                                        </div>\r\n                                    </li>\r\n                                    // --- END OF CHANGES FOR THIS COMPONENT ---\r\n                                ))}\r\n                            </ul>\r\n                        )\r\n                    ) : (\r\n                        <p className=\"text-red-500\">{bias?.message || \"An error occurred during the bias check.\"}</p>\r\n                    )}\r\n                </Section>\r\n\r\n                {/* --- NEW Readability Section --- */}\r\n                <Section title=\"Readability Analysis\" icon={BookOpen}>\r\n                    {readability?.status === 'error' ? (\r\n                        <p className=\"text-red-500\">{readability.message}</p>\r\n                    ) : (\r\n                        <ReadabilityMetrics metrics={readability} />\r\n                    )}\r\n                </Section>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default IntegrityReportPanel;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\OutputDisplay.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\QuizGeneratorPage.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":10,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[418,457],"text":""},"desc":"Remove unused variable 'motion'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'error' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":25,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"error"},"fix":{"range":[1390,1395],"text":""},"desc":"Remove unused variable 'error'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/QuizGeneratorPage.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { Home, Loader2, AlertTriangle } from 'lucide-react';\r\nimport QuizSetup from './QuizSetup';\r\nimport QuizInProgress from './QuizInProgress';\r\nimport QuizResults from './QuizResults';\r\nimport api from '../../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { motion } from 'framer-motion';\r\n\r\n// --- NEW: Simulated stages for the loading UI ---\r\nconst GENERATION_STAGES = [\r\n    { name: \"Analyzing Document\", duration: 2500, message: \"Reading and understanding the structure of your document...\" },\r\n    { name: \"Identifying Key Concepts\", duration: 3000, message: \"Extracting the most important topics and facts...\" },\r\n    { name: \"Formulating Questions\", duration: 4000, message: \"Crafting questions based on the key concepts...\" },\r\n    { name: \"Crafting Distractors\", duration: 2000, message: \"Creating plausible incorrect answers for each question...\" },\r\n    { name: \"Finalizing Quiz\", duration: 1500, message: \"Assembling the final quiz...\" }\r\n];\r\n\r\nconst QuizGeneratorPage = () => {\r\n    const [quizState, setQuizState] = useState('setup'); // 'setup', 'generating', 'in_progress', 'finished'\r\n    const [quizData, setQuizData] = useState([]);\r\n    const [userAnswers, setUserAnswers] = useState([]);\r\n    const [error, setError] = useState('');\r\n\r\n    // --- NEW: State for the progress simulation ---\r\n    const [progress, setProgress] = useState(0);\r\n    const [currentStageMessage, setCurrentStageMessage] = useState('');\r\n\r\n    // --- NEW: Effect to run the progress simulation ---\r\n    useEffect(() => {\r\n        let timeoutId;\r\n        if (quizState === 'generating') {\r\n            let elapsed = 0;\r\n            const totalDuration = GENERATION_STAGES.reduce((acc, stage) => acc + stage.duration, 0);\r\n\r\n            const runStage = (stageIndex = 0) => {\r\n                if (stageIndex >= GENERATION_STAGES.length) {\r\n                    setProgress(100);\r\n                    setCurrentStageMessage(\"Waiting for AI response...\");\r\n                    return;\r\n                }\r\n                const stage = GENERATION_STAGES[stageIndex];\r\n                setCurrentStageMessage(stage.message);\r\n                \r\n                const updateProgress = setInterval(() => {\r\n                    elapsed += 100;\r\n                    setProgress(Math.min(99, Math.floor((elapsed / totalDuration) * 100)));\r\n                }, 100);\r\n\r\n                timeoutId = setTimeout(() => {\r\n                    clearInterval(updateProgress);\r\n                    runStage(stageIndex + 1);\r\n                }, stage.duration);\r\n            };\r\n            runStage(0);\r\n        }\r\n        return () => clearTimeout(timeoutId);\r\n    }, [quizState]);\r\n\r\n    const handleGenerateQuiz = async (file, quizOption) => {\r\n        if (!file) {\r\n            toast.error(\"Please select a file to generate the quiz from.\");\r\n            return;\r\n        }\r\n        setQuizState('generating');\r\n        setError('');\r\n        try {\r\n            const data = await api.generateQuiz(file, quizOption);\r\n            if (!data.quiz || data.quiz.length === 0) {\r\n                throw new Error(\"The AI was unable to generate a quiz from this document.\");\r\n            }\r\n            setQuizData(data.quiz);\r\n            setUserAnswers(new Array(data.quiz.length).fill(null));\r\n            setQuizState('in_progress');\r\n        } catch (err) {\r\n            const errorMessage = err.response?.data?.message || err.message;\r\n            setError(errorMessage);\r\n            setQuizState('setup');\r\n            toast.error(errorMessage);\r\n        }\r\n    };\r\n\r\n    const handleQuizSubmit = (finalAnswers) => {\r\n        setUserAnswers(finalAnswers);\r\n        setQuizState('finished');\r\n    };\r\n\r\n    const handleRestart = () => {\r\n        setQuizState('setup');\r\n        setQuizData([]);\r\n        setUserAnswers([]);\r\n        setError('');\r\n    };\r\n\r\n    const renderContent = () => {\r\n        switch (quizState) {\r\n            case 'generating':\r\n                return (\r\n                    <div className=\"flex flex-col items-center justify-center text-center p-8 bg-surface-light dark:bg-surface-dark rounded-lg shadow-panel\">\r\n                        <h2 className=\"text-xl font-semibold mb-4\">Generating Your Quiz...</h2>\r\n                        <div className=\"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 my-2 max-w-md\">\r\n                            <motion.div\r\n                                className=\"bg-primary h-2.5 rounded-full\"\r\n                                initial={{ width: '0%' }}\r\n                                animate={{ width: `${progress}%` }}\r\n                                transition={{ duration: 0.5, ease: 'linear' }}\r\n                            />\r\n                        </div>\r\n                        <p className=\"text-sm text-text-muted-light dark:text-text-muted-dark mt-2 h-5 w-full\">\r\n                            {currentStageMessage || \"Initializing...\"}\r\n                        </p>\r\n                        {progress >= 99 && <Loader2 size={24} className=\"animate-spin text-primary my-4\" />}\r\n                    </div>\r\n                );\r\n            case 'in_progress':\r\n                return <QuizInProgress quizData={quizData} onSubmit={handleQuizSubmit} />;\r\n            case 'finished':\r\n                return <QuizResults quizData={quizData} userAnswers={userAnswers} onRestart={handleRestart} />;\r\n            case 'setup':\r\n            default:\r\n                return <QuizSetup onGenerate={handleGenerateQuiz} />;\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-screen bg-background-light dark:bg-background-dark text-text-light dark:text-text-dark font-sans\">\r\n            <header className=\"flex-shrink-0 bg-surface-light dark:bg-surface-dark border-b border-border-light dark:border-border-dark h-16 flex items-center justify-between px-6 z-10\">\r\n                <h1 className=\"text-xl font-bold\">AI Quiz Generator</h1>\r\n                <Link to=\"/\" className=\"flex items-center gap-2 text-sm btn btn-ghost\">\r\n                    <Home size={16} />\r\n                    Back to Main App\r\n                </Link>\r\n            </header>\r\n            <main className=\"flex-1 overflow-y-auto p-4 sm:p-6 md:p-8\">\r\n                <div className=\"max-w-4xl mx-auto\">\r\n                    {renderContent()}\r\n                </div>\r\n            </main>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default QuizGeneratorPage;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\QuizInProgress.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":2,"column":27,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":36,"suggestions":[{"messageId":"removeVar","data":{"varName":"useEffect"},"fix":{"range":[77,88],"text":""},"desc":"Remove unused variable 'useEffect'."}]},{"ruleId":"no-unused-vars","severity":2,"message":"'motion' is defined but never used. Allowed unused vars must match /^[A-Z_]/u.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":16,"suggestions":[{"messageId":"removeVar","data":{"varName":"motion"},"fix":{"range":[272,279],"text":""},"desc":"Remove unused variable 'motion'."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/components/tools/QuizInProgress.jsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport Button from '../core/Button';\r\nimport ConfirmationModal from '../core/ConfirmationModal';\r\nimport { ChevronLeft, ChevronRight } from 'lucide-react';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\n\r\nconst QuizInProgress = ({ quizData, onSubmit }) => {\r\n    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\r\n    const [answers, setAnswers] = useState(new Array(quizData.length).fill(null));\r\n    const [isConfirmModalOpen, setIsConfirmModalOpen] = useState(false);\r\n    const currentQuestion = quizData[currentQuestionIndex];\r\n    const totalQuestions = quizData.length;\r\n\r\n    const handleSelectOption = (option) => {\r\n        const newAnswers = [...answers];\r\n        newAnswers[currentQuestionIndex] = option;\r\n        setAnswers(newAnswers);\r\n    };\r\n\r\n    const goToNext = () => {\r\n        if (currentQuestionIndex < totalQuestions - 1) {\r\n            setCurrentQuestionIndex(prev => prev + 1);\r\n        }\r\n    };\r\n\r\n    const goToPrevious = () => {\r\n        if (currentQuestionIndex > 0) {\r\n            setCurrentQuestionIndex(prev => prev - 1);\r\n        }\r\n    };\r\n    \r\n    const handleSubmit = () => {\r\n        setIsConfirmModalOpen(true);\r\n    };\r\n\r\n    const handleConfirmSubmit = () => {\r\n        // This is called when the user clicks \"Confirm\" in the modal\r\n        onSubmit(answers);\r\n        setIsConfirmModalOpen(false);\r\n    };\r\n\r\n    \r\n    return (\r\n        <>\r\n            <div className=\"bg-surface-light dark:bg-surface-dark p-6 rounded-lg shadow-panel border border-border-light dark:border-border-dark\">\r\n                <div className=\"mb-4\">\r\n                    <p className=\"text-sm font-semibold text-primary\">Question {currentQuestionIndex + 1} of {totalQuestions}</p>\r\n                    <h3 className=\"text-xl font-bold mt-1\">{currentQuestion.question}</h3>\r\n                </div>\r\n                <div className=\"space-y-3 my-6\">\r\n                    {currentQuestion.options.map((option, index) => (\r\n                        <button\r\n                            key={index}\r\n                            onClick={() => handleSelectOption(option)}\r\n                            className={`w-full text-left p-4 border rounded-lg transition-all duration-150 flex items-center\r\n                                ${answers[currentQuestionIndex] === option\r\n                                    ? 'bg-primary/20 border-primary ring-2 ring-primary'\r\n                                    : 'bg-gray-50 dark:bg-gray-800 border-border-light dark:border-border-dark hover:bg-primary/10 hover:border-primary/50'\r\n                                }`}\r\n                        >\r\n                            <span className=\"font-bold mr-3 text-primary\">{(index + 10).toString(36).toUpperCase()}</span>\r\n                            <span>{option}</span>\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n                <div className=\"flex justify-between items-center mt-6 pt-4 border-t border-border-light dark:border-border-dark\">\r\n                    <Button onClick={goToPrevious} disabled={currentQuestionIndex === 0} variant=\"outline\" leftIcon={<ChevronLeft />}>\r\n                        Previous\r\n                    </Button>\r\n\r\n                    {currentQuestionIndex === totalQuestions - 1 ? (\r\n                        <Button onClick={handleSubmit} disabled={answers.some(a => a === null)}>\r\n                            Submit Answers\r\n                        </Button>\r\n                    ) : (\r\n                        <Button onClick={goToNext} disabled={currentQuestionIndex === totalQuestions - 1} rightIcon={<ChevronRight />}>\r\n                            Next\r\n                        </Button>\r\n                    )}\r\n                </div>\r\n            </div>\r\n            <ConfirmationModal\r\n                isOpen={isConfirmModalOpen}\r\n                onClose={() => setIsConfirmModalOpen(false)}\r\n                onConfirm={handleConfirmSubmit}\r\n                title=\"Submit Quiz\"\r\n                message=\"Are you sure you want to submit your answers? You won't be able to change them.\"\r\n                confirmText=\"Submit\"\r\n                confirmVariant=\"primary\"\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport default QuizInProgress;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\QuizResults.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\QuizSetup.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\ReadabilityMetrics.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\ReferenceFormatter.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\TestCaseManager.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\components\\tools\\ToolsModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\contexts\\AppStateContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":3,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":3,"endColumn":29},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":5,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":5,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useState, useContext, useEffect } from 'react';\r\n\r\nexport const AppStateContext = createContext(null);\r\n\r\nexport const useAppState = () => {\r\n    const context = useContext(AppStateContext);\r\n    if (!context) throw new Error('useAppState must be used within an AppStateProvider');\r\n    return context;\r\n};\r\n\r\nconst defaultSystemPromptText = \"You are a helpful AI engineering tutor.\";\r\n\r\nexport const AppStateProvider = ({ children }) => {\r\n    const [theme, setThemeState] = useState(() => {\r\n        const storedTheme = localStorage.getItem('theme') || 'dark';\r\n        if (typeof window !== 'undefined') {\r\n            document.documentElement.classList.remove('light', 'dark');\r\n            document.documentElement.classList.add(storedTheme);\r\n        }\r\n        return storedTheme;\r\n    });\r\n\r\n    const [selectedLLM, setSelectedLLM] = useState(localStorage.getItem('selectedLLM') || 'gemini');\r\n    const [isLeftPanelOpen, setIsLeftPanelOpen] = useState(true);\r\n    const [isRightPanelOpen, setIsRightPanelOpen] = useState(true);\r\n\r\n    const [currentSessionId, setCurrentSessionIdState] = useState(() => {\r\n        return localStorage.getItem('aiTutorSessionId') || null;\r\n    });\r\n    const [systemPrompt, setSystemPromptState] = useState(\r\n        localStorage.getItem('aiTutorSystemPrompt') || defaultSystemPromptText\r\n    );\r\n\r\n    const [selectedDocumentForAnalysis, setSelectedDocumentForAnalysisState] = useState(null);\r\n    const [selectedSubject, setSelectedSubjectState] = useState(\r\n        localStorage.getItem('aiTutorSelectedSubject') || null\r\n    );\r\n\r\n    const [isAdminSessionActive, setIsAdminSessionActiveState] = useState(() => {\r\n        return sessionStorage.getItem('isAdminSessionActive') === 'true';\r\n    });\r\n\r\n    const [initialPromptForNewSession, setInitialPromptForNewSession] = useState(null);\r\n    const [initialActivityForNewSession, setInitialActivityForNewSession] = useState(null);\r\n\r\n    // Tutor Mode (Beta) feature flag - defaults to false\r\n    const [tutorMode, setTutorMode] = useState(false);\r\n\r\n    const toggleTheme = () => {\r\n        setThemeState(prevTheme => {\r\n            const newTheme = prevTheme === 'light' ? 'dark' : 'light';\r\n            localStorage.setItem('theme', newTheme);\r\n            return newTheme;\r\n        });\r\n    };\r\n\r\n    const switchLLM = (llm) => {\r\n        setSelectedLLM(llm);\r\n        localStorage.setItem('selectedLLM', llm);\r\n        console.log(\"AppStateContext: Switched LLM to:\", llm);\r\n    };\r\n\r\n    const setSessionId = (sessionId) => {\r\n        if (sessionId) {\r\n            localStorage.setItem('aiTutorSessionId', sessionId);\r\n        } else {\r\n            localStorage.removeItem('aiTutorSessionId');\r\n\r\n            localStorage.removeItem('aiTutorSelectedSubject');\r\n            setSelectedSubjectState(null);\r\n\r\n            setSelectedDocumentForAnalysisState(null);\r\n        }\r\n        setCurrentSessionIdState(sessionId);\r\n    };\r\n\r\n    const setSystemPrompt = (promptText) => {\r\n        setSystemPromptState(promptText);\r\n        localStorage.setItem('aiTutorSystemPrompt', promptText);\r\n    };\r\n\r\n    const selectDocumentForAnalysis = (documentFilename) => {\r\n        setSelectedDocumentForAnalysisState(documentFilename);\r\n        if (documentFilename && selectedSubject !== documentFilename) {\r\n            if (selectedSubject !== null) {\r\n                setSelectedSubjectState(null);\r\n                localStorage.removeItem('aiTutorSelectedSubject');\r\n            }\r\n        }\r\n    };\r\n\r\n    const setSelectedSubject = (subjectName) => {\r\n        const newSubject = subjectName === \"none\" || !subjectName ? null : subjectName;\r\n        if (newSubject) {\r\n            localStorage.setItem('aiTutorSelectedSubject', newSubject);\r\n        } else {\r\n            localStorage.removeItem('aiTutorSelectedSubject');\r\n        }\r\n        setSelectedSubjectState(newSubject);\r\n\r\n        setSelectedDocumentForAnalysisState(newSubject);\r\n        if (newSubject) {\r\n            console.log(\"AppStateContext: Also set document for analysis tools to (admin subject):\", newSubject);\r\n        } else {\r\n            if (selectedDocumentForAnalysis === subjectName) {\r\n                setSelectedDocumentForAnalysisState(null);\r\n                console.log(\"AppStateContext: Cleared document for analysis tools as linked subject was cleared.\");\r\n            }\r\n        }\r\n    };\r\n\r\n    const setIsAdminSessionActive = (isActive) => {\r\n        if (isActive) {\r\n            sessionStorage.setItem('isAdminSessionActive', 'true');\r\n            setSessionId(null);\r\n        } else {\r\n            sessionStorage.removeItem('isAdminSessionActive');\r\n        }\r\n        setIsAdminSessionActiveState(isActive);\r\n    };\r\n\r\n    useEffect(() => {\r\n        const rootHtmlElement = document.documentElement;\r\n        rootHtmlElement.classList.remove('light', 'dark');\r\n        rootHtmlElement.classList.add(theme);\r\n        document.body.className = '';\r\n        document.body.classList.add(theme === 'dark' ? 'bg-background-dark' : 'bg-background-light');\r\n    }, [theme]);\r\n\r\n    return (\r\n        <AppStateContext.Provider value={{\r\n            theme, toggleTheme,\r\n            selectedLLM, switchLLM,\r\n            isLeftPanelOpen, setIsLeftPanelOpen,\r\n            isRightPanelOpen, setIsRightPanelOpen,\r\n            currentSessionId, setSessionId,\r\n            systemPrompt, setSystemPrompt,\r\n            selectedDocumentForAnalysis, selectDocumentForAnalysis,\r\n            selectedSubject, setSelectedSubject,\r\n            isAdminSessionActive, setIsAdminSessionActive,\r\n            initialPromptForNewSession, setInitialPromptForNewSession,\r\n            initialActivityForNewSession, setInitialActivityForNewSession,\r\n            tutorMode, setTutorMode\r\n        }}>\r\n            {children}\r\n        </AppStateContext.Provider>\r\n    );\r\n\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\contexts\\AuthContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":6,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":6,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/contexts/AuthContext.jsx\r\nimport React, { createContext, useState, useEffect, useCallback } from 'react';\r\nimport api from '../services/api.js'; \r\nimport toast from 'react-hot-toast';\r\n\r\nexport const AuthContext = createContext(null);\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [token, setTokenState] = useState(localStorage.getItem('authToken'));\r\n    const [user, setUserState] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const setToken = (newToken) => {\r\n        if (newToken) localStorage.setItem('authToken', newToken);\r\n        else localStorage.removeItem('authToken');\r\n        setTokenState(newToken);\r\n    };\r\n\r\n    const setUser = (newUser) => setUserState(newUser);\r\n    \r\n    const processAuthData = useCallback((authApiResponse) => {\r\n        if (authApiResponse && authApiResponse.token && authApiResponse._id && authApiResponse.email) {\r\n            setToken(authApiResponse.token);\r\n            const userObject = { \r\n                id: authApiResponse._id, \r\n                email: authApiResponse.email, \r\n                username: authApiResponse.username,\r\n                hasCompletedOnboarding: authApiResponse.hasCompletedOnboarding\r\n            };\r\n            setUser(userObject);\r\n             console.log(\"AuthContext: User and Token set.\", userObject);\r\n            return authApiResponse; \r\n        } else {\r\n            setToken(null);\r\n            setUser(null);\r\n            console.error(\"AuthContext: processAuthData received incomplete data for a regular user.\", authApiResponse);\r\n            throw new Error(\"Authentication response from server was incomplete for a regular user.\");\r\n        }\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const verifyTokenAndLoadUser = async () => {\r\n            const storedToken = localStorage.getItem('authToken');\r\n            if (storedToken) {\r\n                setTokenState(storedToken);\r\n                try {\r\n                    const userDataFromMe = await api.getMe();\r\n                    if (userDataFromMe && userDataFromMe._id && userDataFromMe.email) {\r\n                        setUser({ \r\n                            id: userDataFromMe._id, \r\n                            email: userDataFromMe.email, \r\n                            username: userDataFromMe.username,\r\n                            hasCompletedOnboarding: userDataFromMe.hasCompletedOnboarding\r\n                        });\r\n                    } else {\r\n                        setToken(null);\r\n                        setUser(null);\r\n                    }\r\n                } catch (error) {\r\n                    setToken(null);\r\n                    setUser(null);\r\n                    throw error;\r\n                }\r\n            }\r\n            setLoading(false);\r\n        };\r\n        verifyTokenAndLoadUser();\r\n    }, []);\r\n\r\n    const login = async (credentials) => {\r\n        setLoading(true);\r\n        try {\r\n            const data = await api.login(credentials);\r\n            if (data && data.isAdminLogin && data.token) {\r\n                setToken(data.token); \r\n            return data; \r\n            }\r\n\r\n            return processAuthData(data);\r\n        } catch (error) {\r\n            setToken(null); \r\n            setUser(null);\r\n            throw error; \r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n    \r\n    const signup = async (signupData) => {\r\n        setLoading(true);\r\n        try {\r\n            const data = await api.signup(signupData);\r\n            return processAuthData(data); \r\n        } catch (error) {\r\n            setToken(null);\r\n            setUser(null);\r\n            throw error;\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const logout = () => {\r\n        console.log(\"AuthContext: Logging out user.\");\r\n        setToken(null); \r\n        setUser(null);\r\n        toast.success(\"You have been logged out.\");\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ token, user, loading, login, signup, logout, setUser }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useAuth.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useTextToSpeech.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'handleEnd' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":40,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/hooks/useTextToSpeech.js\r\nimport { useState, useEffect, useCallback, useRef } from 'react';\r\nimport { marked } from 'marked'; // To parse markdown for plain text\r\n\r\n// Configure marked (if not already globally configured for this specific use)\r\n// It's generally better if marked is configured once, e.g. in MessageBubble or a central place.\r\n// Assuming marked is available and configured.\r\n\r\nconst getPlainTextFromMarkdown = (markdown) => {\r\n  if (!markdown) return '';\r\n  try {\r\n    // A simpler approach for plain text extraction for TTS:\r\n    // Render to a temporary element and get its text content.\r\n    // This handles complex markdown structures reasonably well for speech.\r\n    const tempDiv = document.createElement('div');\r\n    tempDiv.innerHTML = marked.parse(markdown); // marked.parse() is synchronous\r\n    let text = tempDiv.textContent || tempDiv.innerText || '';\r\n    \r\n    // Basic cleanup: remove excessive newlines/spaces that might make speech awkward\r\n    text = text.replace(/\\n+/g, ' '); // Replace newlines with spaces\r\n    text = text.replace(/\\s\\s+/g, ' '); // Replace multiple spaces with single\r\n    return text.trim();\r\n  } catch (error) {\r\n    console.error(\"Error parsing markdown for TTS:\", error);\r\n    return markdown; // Fallback to raw markdown if parsing fails\r\n  }\r\n};\r\n\r\n\r\nexport const useTextToSpeech = () => {\r\n    const [isSpeaking, setIsSpeaking] = useState(false);\r\n    const [isSupported, setIsSupported] = useState(false);\r\n    const utteranceRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        if (typeof window !== 'undefined' && window.speechSynthesis) {\r\n            setIsSupported(true);\r\n        }\r\n\r\n        const handleEnd = () => {\r\n            setIsSpeaking(false);\r\n            utteranceRef.current = null;\r\n        };\r\n        \r\n        const synth = window.speechSynthesis;\r\n        if (synth) {\r\n            // Add event listeners if needed, but onend on utterance is usually sufficient\r\n        }\r\n\r\n        return () => {\r\n            if (synth) {\r\n                synth.cancel(); // Cancel any speech on component unmount or hook cleanup\r\n            }\r\n        };\r\n    }, []);\r\n\r\n    const speak = useCallback(({ text, lang = 'en-US', voiceURI = null, rate = 1, pitch = 1, volume = 1 }) => {\r\n        if (!isSupported || !text) return;\r\n\r\n        const synth = window.speechSynthesis;\r\n        if (synth.speaking) {\r\n            synth.cancel(); // Stop any currently playing speech\r\n        }\r\n        \r\n        const plainText = getPlainTextFromMarkdown(text);\r\n        if (!plainText) {\r\n            console.warn(\"TTS: No text content to speak after parsing markdown.\");\r\n            return;\r\n        }\r\n\r\n        const newUtterance = new SpeechSynthesisUtterance(plainText);\r\n        newUtterance.lang = lang;\r\n        newUtterance.rate = rate;\r\n        newUtterance.pitch = pitch;\r\n        newUtterance.volume = volume;\r\n\r\n        if (voiceURI) {\r\n            const voices = synth.getVoices();\r\n            const selectedVoice = voices.find(voice => voice.voiceURI === voiceURI);\r\n            if (selectedVoice) {\r\n                newUtterance.voice = selectedVoice;\r\n            }\r\n        }\r\n        \r\n        newUtterance.onstart = () => {\r\n            setIsSpeaking(true);\r\n        };\r\n        newUtterance.onend = () => {\r\n            setIsSpeaking(false);\r\n            utteranceRef.current = null;\r\n        };\r\n        newUtterance.onerror = (event) => {\r\n            console.error('SpeechSynthesisUtterance.onerror', event);\r\n            setIsSpeaking(false);\r\n            utteranceRef.current = null;\r\n        };\r\n\r\n        utteranceRef.current = newUtterance;\r\n        synth.speak(newUtterance);\r\n    }, [isSupported]);\r\n\r\n    const cancel = useCallback(() => {\r\n        if (!isSupported) return;\r\n        const synth = window.speechSynthesis;\r\n        if (synth.speaking) {\r\n            synth.cancel();\r\n        }\r\n        // onend should fire and set isSpeaking to false.\r\n        // If it doesn't (e.g. cancel is abrupt), manually reset:\r\n        if (isSpeaking) {\r\n            setIsSpeaking(false);\r\n            utteranceRef.current = null;\r\n        }\r\n    }, [isSupported, isSpeaking]);\r\n\r\n    // Optional: Get available voices\r\n    const getVoices = useCallback(() => {\r\n        if (!isSupported) return [];\r\n        return window.speechSynthesis.getVoices();\r\n    }, [isSupported]);\r\n\r\n    // Voices might load asynchronously. Listen for 'voiceschanged' event.\r\n    useEffect(() => {\r\n        if (!isSupported) return;\r\n        const synth = window.speechSynthesis;\r\n        const loadVoices = () => {\r\n            // You might want to store voices in state if your UI allows voice selection\r\n            // console.log(\"Voices loaded:\", synth.getVoices());\r\n        };\r\n        synth.addEventListener('voiceschanged', loadVoices);\r\n        // Initial load if voices are already available\r\n        if (synth.getVoices().length > 0) {\r\n            loadVoices();\r\n        }\r\n        return () => synth.removeEventListener('voiceschanged', loadVoices);\r\n    }, [isSupported]);\r\n\r\n\r\n    return {\r\n        speak,\r\n        cancel,\r\n        isSpeaking,\r\n        isSupported,\r\n        getVoices,\r\n        currentlySpeakingUtterance: utteranceRef.current\r\n    };\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useTheme.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useTypingEffect.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useUserLevel.jsx","messages":[{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":44,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":44,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/hooks/useUserLevel.jsx\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nconst apiClient = axios.create({\r\n    baseURL: import.meta.env.VITE_API_BASE_URL || \"http://localhost:2000\",\r\n});\r\n\r\n// Add auth token to requests\r\napiClient.interceptors.request.use((config) => {\r\n    const token = localStorage.getItem(\"authToken\");\r\n    if (token) {\r\n        config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n});\r\n\r\n/**\r\n * Hook to fetch and cache user's gamification level\r\n * @param {string} userId - Optional user ID (defaults to current user)\r\n * @returns {object} { level, loading, error }\r\n */\r\nexport function useUserLevel(userId = null) {\r\n    const [level, setLevel] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        const fetchLevel = async () => {\r\n            try {\r\n                setLoading(true);\r\n\r\n                // Fetch from gamification profile (baseURL already includes /api)\r\n                const response = await apiClient.get('/gamification/profile');\r\n\r\n                if (response && response.data && isMounted) {\r\n                    const newLevel = response.data.level || 1;\r\n                    setLevel(newLevel);\r\n                    setError(null);\r\n                }\r\n            } catch (err) {\r\n                if (process.env.NODE_ENV === 'development') {\r\n                    console.error('[useUserLevel] Error fetching level:', err);\r\n                }\r\n                if (isMounted) {\r\n                    setError(err.message);\r\n                    setLevel(1); // Default to level 1 if error\r\n                }\r\n            } finally {\r\n                if (isMounted) {\r\n                    setLoading(false);\r\n                }\r\n            }\r\n        };\r\n\r\n        // Fetch immediately\r\n        fetchLevel();\r\n\r\n        // Refresh every 30 seconds to avoid frequent re-renders\r\n        const intervalId = setInterval(fetchLevel, 30000);\r\n\r\n        return () => {\r\n            isMounted = false;\r\n            clearInterval(intervalId);\r\n        };\r\n    }, [userId]);\r\n\r\n    return { level, loading, error };\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\hooks\\useWebSpeech.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\services\\adminApi.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\services\\api.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":132,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":132,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// frontend/src/services/api.js\r\nimport axios from \"axios\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nconst apiClient = axios.create({\r\n    baseURL: import.meta.env.VITE_API_BASE_URL || \"http://localhost:5001/api\",\r\n});\r\n\r\napiClient.interceptors.request.use(\r\n    (config) => {\r\n        const token = localStorage.getItem(\"authToken\");\r\n        if (token) {\r\n            config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n    },\r\n    (error) => {\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\napiClient.interceptors.response.use(\r\n    (response) => response,\r\n    (error) => {\r\n        if (error.response && error.response.status === 401) {\r\n            console.error(\"API Interceptor: Received 401 Unauthorized. Token might be invalid or expired.\");\r\n        }\r\n        return Promise.reject(error);\r\n    }\r\n);\r\n\r\nfunction parseAnalysisOutput(rawOutput) {\r\n    if (!rawOutput || typeof rawOutput !== 'string') {\r\n        return { content: '', thinking: '' };\r\n    }\r\n    const thinkingMatch = rawOutput.match(/<thinking>([\\s\\S]*?)<\\/thinking>/i);\r\n    let thinkingText = '';\r\n    let mainContent = rawOutput;\r\n\r\n    if (thinkingMatch && thinkingMatch[1]) {\r\n        thinkingText = thinkingMatch[1].trim();\r\n        mainContent = rawOutput.replace(/<thinking>[\\s\\S]*?<\\/thinking>\\s*/i, '').trim();\r\n    }\r\n    return { content: mainContent, thinking: thinkingText };\r\n}\r\n\r\nconst api = {\r\n    login: async (credentials) => {\r\n        const response = await apiClient.post(\"/auth/signin\", credentials);\r\n        return response.data;\r\n    },\r\n    sendOtp: async (email, password) => {\r\n        const response = await apiClient.post(\"/auth/send-otp\", { email, password });\r\n        return response.data;\r\n    },\r\n    signup: async (userData) => {\r\n        const response = await apiClient.post(\"/auth/signup\", userData);\r\n        return response.data;\r\n    },\r\n    getMe: async () => {\r\n        const response = await apiClient.get(\"/auth/me\");\r\n        return response.data;\r\n    },\r\n    completeOnboarding: async () => {\r\n        const response = await apiClient.post('/auth/complete-onboarding');\r\n        return response.data;\r\n    },\r\n    sendMessage: async (payload) => {\r\n        const response = await apiClient.post(\"/chat/message\", payload);\r\n        return response.data;\r\n    },\r\n    getChatHistory: async (sessionId) => {\r\n        const response = await apiClient.get(`/chat/session/${sessionId}`);\r\n        return response.data;\r\n    },\r\n    getChatSessions: async () => {\r\n        const response = await apiClient.get(\"/chat/sessions\");\r\n        return response.data;\r\n    },\r\n    startNewSession: async (previousSessionId, skipAnalysis = false) => {\r\n        const response = await apiClient.post(\"/chat/history\", {\r\n            previousSessionId,\r\n            skipAnalysis\r\n        });\r\n        return response.data;\r\n    },\r\n    deleteChatSession: async (sessionId) => {\r\n        const response = await apiClient.delete(`/chat/session/${sessionId}`);\r\n        return response.data;\r\n    },\r\n    uploadFile: async (formData, onUploadProgress) => {\r\n        const response = await apiClient.post(\"/upload\", formData, {\r\n            headers: { \"Content-Type\": \"multipart/form-data\" },\r\n            onUploadProgress,\r\n        });\r\n        return response.data;\r\n    },\r\n    // getFiles: async () => {\r\n    //   const response = await apiClient.get(\"/files\");\r\n    //   return response.data;\r\n    // },\r\n    // deleteFile: async (serverFilename) => {\r\n    //   const response = await apiClient.delete(`/files/${serverFilename}`);\r\n    //   return response.data;\r\n    // },\r\n    getKnowledgeSources: async () => {\r\n        const response = await apiClient.get(\"/knowledge-sources\");\r\n        return response.data;\r\n    },\r\n    deleteKnowledgeSource: async (sourceId) => {\r\n        const response = await apiClient.delete(`/knowledge-sources/${sourceId}`);\r\n        return response.data;\r\n    },\r\n    addUrlSource: async (url) => {\r\n        const response = await apiClient.post(\"/knowledge-sources\", {\r\n            type: \"url\",\r\n            content: url,\r\n        });\r\n        return response.data; // Returns the initial source object with \"processing\" status\r\n    },\r\n    updateUserLLMConfig: async (configData) => {\r\n        const response = await apiClient.put(\"/llm/config\", configData);\r\n        return response.data;\r\n    },\r\n    getOrchestratorStatus: async () => {\r\n        try {\r\n            const response = await apiClient.get(\"/network/ip\");\r\n            return {\r\n                status: \"ok\",\r\n                message: `Backend Online at ${response.data.ips[0]}`,\r\n            };\r\n        } catch (e) {\r\n            return { status: \"error\", message: \"Backend Unreachable\" };\r\n        }\r\n    },\r\n    getUserProfile: async () => {\r\n        const response = await apiClient.get(\"/user/profile\");\r\n        return response.data;\r\n    },\r\n    updateUserProfile: async (profileData) => {\r\n        const response = await apiClient.put(\"/user/profile\", profileData);\r\n        return response.data;\r\n    },\r\n    getSubjects: async () => {\r\n        const response = await apiClient.get(\"/subjects\");\r\n        return response.data;\r\n    },\r\n    requestAnalysis: async (payload) => {\r\n        const { filename, analysis_type } = payload;\r\n        if (!filename || !analysis_type) {\r\n            throw new Error(\"Filename and analysis type are required.\");\r\n        }\r\n        const toastId = toast.loading(\r\n            `Generating ${analysis_type} for \"${filename}\"...`\r\n        );\r\n        try {\r\n            const response = await apiClient.get(\r\n                `/analysis/${encodeURIComponent(filename)}`\r\n            );\r\n            const fullAnalysisObject = response.data;\r\n            const rawOutput = fullAnalysisObject[analysis_type];\r\n            if (\r\n                !rawOutput ||\r\n                typeof rawOutput !== \"string\" ||\r\n                rawOutput.trim() === \"\"\r\n            ) {\r\n                toast.success(`No stored ${analysis_type} found for \"${filename}\".`, {\r\n                    id: toastId,\r\n                });\r\n                return {\r\n                    content: `Notice: Analysis for '${analysis_type}' has not been generated yet or was empty.`,\r\n                    thinking: \"No analysis data found in  the database for this type.\",\r\n                };\r\n            }\r\n            const { content, thinking } = parseAnalysisOutput(rawOutput);\r\n            toast.success(\r\n                `Successfully generated ${analysis_type} for \"${filename}\".`,\r\n                { id: toastId }\r\n            );\r\n            return { content, thinking };\r\n        } catch (error) {\r\n            const errorMessage =\r\n                error.response?.data?.message || error.message || \"Unknown error\";\r\n            toast.error(`Error generating ${analysis_type}: ${errorMessage}`, {\r\n                id: toastId,\r\n            });\r\n            throw error;\r\n        }\r\n    },\r\n    generatePodcast: async ({\r\n        analysisContent,\r\n        sourceDocumentName,\r\n        podcastOptions,\r\n    }) => {\r\n        const response = await apiClient.post(\r\n            \"/export/podcast\",\r\n            { analysisContent, sourceDocumentName, podcastOptions },\r\n            { responseType: \"blob\" }\r\n        );\r\n        return { audioBlob: response.data, sourceDocumentName };\r\n    },\r\n    getKnowledgeGraph: async (documentName) => {\r\n        const response = await apiClient.get(\r\n            `/kg/visualize/${encodeURIComponent(documentName)}`\r\n        );\r\n        return response.data;\r\n    },\r\n    getSessionKnowledgeGraph: async (sessionId) => {\r\n        const response = await apiClient.get(\r\n            `/kg/session/${encodeURIComponent(sessionId)}`\r\n        );\r\n        return response.data;\r\n    },\r\n    executeCode: async (payload) => {\r\n        const response = await apiClient.post(\"/tools/execute\", payload);\r\n        return response.data;\r\n    },\r\n    analyzeCode: async (payload) => {\r\n        const response = await apiClient.post(\"/tools/analyze-code\", payload);\r\n        return response.data;\r\n    },\r\n    generateTestCases: async (payload) => {\r\n        const response = await apiClient.post(\r\n            \"/tools/generate-test-cases\",\r\n            payload\r\n        );\r\n        return response.data;\r\n    },\r\n    explainError: async (payload) => {\r\n        const response = await apiClient.post(\"/tools/explain-error\", payload);\r\n        return response.data;\r\n    },\r\n    getRecommendations: async (sessionId) => {\r\n        const response = await apiClient.get(\r\n            `/learning/recommendations/${sessionId}`\r\n        );\r\n        return response.data;\r\n    },\r\n\r\n    findDocumentForTopic: async (topic) => {\r\n        const response = await apiClient.post(\"/learning/find-document\", { topic });\r\n        return response.data;\r\n    },\r\n    getLearningPaths: async () => {\r\n        const response = await apiClient.get(\"/learning/paths\");\r\n        return response.data;\r\n    },\r\n\r\n    generateLearningPath: async (goal, context = null) => {\r\n        const response = await apiClient.post(\"/learning/paths/generate\", {\r\n            goal,\r\n            context,\r\n        });\r\n        return response.data;\r\n    },\r\n\r\n    updateModuleStatus: async (pathId, moduleId, status) => {\r\n        const response = await apiClient.put(\r\n            `/learning/paths/${pathId}/modules/${moduleId}`,\r\n            { status }\r\n        );\r\n        return response.data;\r\n    },\r\n\r\n    generateQuiz: async (file, quizOption) => {\r\n        const formData = new FormData();\r\n        formData.append(\"file\", file);\r\n        formData.append(\"quizOption\", quizOption); // <<< Send the descriptive string\r\n\r\n        const response = await apiClient.post(\"/tools/generate-quiz\", formData, {\r\n            headers: {\r\n                \"Content-Type\": \"multipart/form-data\",\r\n            },\r\n            timeout: 300000,\r\n        });\r\n        return response.data; // Should be { quiz: [...] }\r\n    },\r\n    analyzePrompt: async (promptText) => {\r\n        const response = await apiClient.post(\"/chat/analyze-prompt\", {\r\n            prompt: promptText,\r\n        });\r\n        return response.data; // Expects { improvedPrompt, explanation }\r\n    },\r\n    // --- Academic Integrity Tools ---\r\n    submitIntegrityCheck: async ({ text }) => {\r\n        const response = await apiClient.post(\"/tools/analyze-integrity/submit\", { text });\r\n        return response.data; // Expects { reportId, initialReport }\r\n    },\r\n\r\n    getIntegrityReport: async (reportId) => {\r\n        const response = await apiClient.get(`/tools/analyze-integrity/report/${reportId}`);\r\n        return response.data; // Expects the full report object with status updates\r\n    },\r\n    deleteLearningPath: async (pathId) => {\r\n        const response = await apiClient.delete(`/learning/paths/${pathId}`);\r\n        return response.data;\r\n    },\r\n    generateDocument: async (payload) => {\r\n        // This function now handles the entire download process, including error handling.\r\n        const response = await apiClient.post(\"/generate/document\", payload, {\r\n            responseType: \"blob\" // Crucial: expect a file blob\r\n        });\r\n\r\n        // --- THIS IS THE FIX ---\r\n        // If the server sent back a JSON error instead of a file, it will have this content type.\r\n        if (response.data.type === 'application/json') {\r\n            const errorText = await response.data.text();\r\n            const errorJson = JSON.parse(errorText);\r\n            throw new Error(errorJson.message || \"An unknown error occurred during generation.\");\r\n        }\r\n        // --- END OF FIX ---\r\n\r\n        const contentDisposition = response.headers[\"content-disposition\"];\r\n        let filename = `generated-document.${payload.docType}`;\r\n        if (contentDisposition) {\r\n            const filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/);\r\n            if (filenameMatch && filenameMatch.length > 1) {\r\n                filename = filenameMatch[1];\r\n            }\r\n        }\r\n\r\n        // Trigger browser download\r\n        const url = window.URL.createObjectURL(new Blob([response.data]));\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.setAttribute('download', filename);\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        link.parentNode.removeChild(link);\r\n        window.URL.revokeObjectURL(url);\r\n\r\n        return { success: true, filename }; // Return success for toast messages\r\n    },\r\n    generateDocumentFromTopic: async (payload) => {\r\n        const { topic, docType } = payload;\r\n        const response = await apiClient.post(\r\n            `/generate/document/from-topic`,\r\n            { topic, docType },\r\n            { responseType: \"blob\" } // CRITICAL: This tells axios to expect a file\r\n        );\r\n\r\n        if (response.data.type === 'application/json') {\r\n            const errorText = await response.data.text();\r\n            const errorJson = JSON.parse(errorText);\r\n            throw new Error(errorJson.message || \"An unknown error occurred during generation from topic.\");\r\n        }\r\n\r\n\r\n        // Extract filename from the 'Content-Disposition' header\r\n        const contentDisposition = response.headers[\"content-disposition\"];\r\n        let filename = `generated-document.${docType}`; // a fallback\r\n        if (contentDisposition) {\r\n            const filenameMatch = contentDisposition.match(/filename=\"?(.+)\"?/);\r\n            if (filenameMatch && filenameMatch.length > 1) {\r\n                filename = filenameMatch[1];\r\n            }\r\n        }\r\n\r\n        // Create a temporary link to trigger the browser's automatic download\r\n        const url = window.URL.createObjectURL(new Blob([response.data]));\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.setAttribute('download', filename);\r\n        document.body.appendChild(link);\r\n        link.click();\r\n\r\n        // Clean up the temporary link from memory\r\n        link.parentNode.removeChild(link);\r\n        window.URL.revokeObjectURL(url);\r\n\r\n        return { success: true, filename }; // Return success status for the toast\r\n    },\r\n    submitFeedback: async (logId, feedback) => {\r\n        const response = await apiClient.post(`/feedback/${logId}`, { feedback });\r\n        return response.data;\r\n    },\r\n\r\n    // ===== Admin Gamification APIs =====\r\n    getGamificationOverview: async () => {\r\n        const response = await apiClient.get('/admin/gamification/overview');\r\n        return response.data;\r\n    },\r\n\r\n    getActiveStreakUsers: async () => {\r\n        const response = await apiClient.get('/admin/gamification/active-streaks');\r\n        return response.data;\r\n    },\r\n\r\n    getGamificationUsers: async (page = 1, limit = 20) => {\r\n        const response = await apiClient.get('/admin/gamification/users', {\r\n            params: { page, limit }\r\n        });\r\n        return response.data;\r\n    },\r\n\r\n    awardXPToUser: async (userId, amount, reason) => {\r\n        const response = await apiClient.post('/admin/gamification/award-xp', {\r\n            userId,\r\n            amount,\r\n            reason\r\n        });\r\n        return response.data;\r\n    },\r\n\r\n    getAdminSkillTree: async () => {\r\n        const response = await apiClient.get('/admin/gamification/skill-tree');\r\n        return response.data;\r\n    },\r\n\r\n    createSkill: async (skillData) => {\r\n        const response = await apiClient.post('/admin/gamification/skill-tree', skillData);\r\n        return response.data;\r\n    },\r\n\r\n    updateSkill: async (skillId, skillData) => {\r\n        const response = await apiClient.put(`/admin/gamification/skill-tree/${skillId}`, skillData);\r\n        return response.data;\r\n    },\r\n\r\n    deleteSkill: async (skillId) => {\r\n        const response = await apiClient.delete(`/admin/gamification/skill-tree/${skillId}`);\r\n        return response.data;\r\n    },\r\n\r\n    getAdminBossBattles: async () => {\r\n        const response = await apiClient.get('/admin/gamification/boss-battles');\r\n        return response.data;\r\n    },\r\n\r\n    getAdminContributions: async () => {\r\n        const response = await apiClient.get('/admin/gamification/contributions');\r\n        return response.data;\r\n    },\r\n\r\n    approveContribution: async (contributionId) => {\r\n        const response = await apiClient.put(`/admin/gamification/contribution/${contributionId}/approve`);\r\n        return response.data;\r\n    },\r\n\r\n    rejectContribution: async (contributionId) => {\r\n        const response = await apiClient.put(`/admin/gamification/contribution/${contributionId}/reject`);\r\n        return response.data;\r\n    },\r\n\r\n    // Knowledge State\r\n    getKnowledgeState: async () => {\r\n        const response = await apiClient.get('/chat/knowledge-state');\r\n        return response.data;\r\n    },\r\n    resetKnowledgeState: async () => {\r\n        const response = await apiClient.post('/chat/knowledge-state/reset');\r\n        return response.data;\r\n    },\r\n    exportKnowledgeState: async () => {\r\n        const response = await apiClient.get('/chat/knowledge-state/export', {\r\n            responseType: 'blob'\r\n        });\r\n\r\n        const url = window.URL.createObjectURL(new Blob([response.data]));\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.setAttribute('download', 'learning_memory.json');\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        link.parentNode.removeChild(link);\r\n        window.URL.revokeObjectURL(url);\r\n\r\n        return { success: true };\r\n    },\r\n};\r\n\r\n\r\nexport default api;","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\services\\skillTreeService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\utils\\cn.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\utils\\helpers.js","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'lastRan' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":32,"column":9,"nodeType":"Identifier","messageId":"unusedVar","endLine":32,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Debounce function: Limits the rate at which a function can fire.\r\nimport { marked } from 'marked';\r\n\r\nexport const getPlainTextFromMarkdown = (markdown) => {\r\n  if (!markdown) return '';\r\n  try {\r\n    const html = marked.parse(markdown);\r\n    const tempDiv = document.createElement('div');\r\n    tempDiv.innerHTML = html;\r\n    // .textContent correctly extracts text and preserves line breaks from block elements\r\n    return tempDiv.textContent || '';\r\n  } catch (error) {\r\n    console.error(\"Error converting markdown to plain text:\", error);\r\n    return markdown; // Fallback to raw markdown on error\r\n  }\r\n};\r\n\r\n\r\nexport const debounce = (func, delay) => {\r\n    let timeoutId;\r\n    return function(...args) {\r\n        const context = this;\r\n        clearTimeout(timeoutId);\r\n        timeoutId = setTimeout(() => func.apply(context, args), delay);\r\n    };\r\n};\r\n\r\n// Throttle function: Ensures a function is called at most once in a specified time period.\r\nexport const throttle = (func, limit) => {\r\n    let inThrottle;\r\n    let lastFunc;\r\n    let lastRan;\r\n    return function(...args) {\r\n        const context = this;\r\n        if (!inThrottle) {\r\n            func.apply(context, args);\r\n            lastRan = Date.now();\r\n            inThrottle = true;\r\n            setTimeout(() => {\r\n                inThrottle = false;\r\n                if (lastFunc) {\r\n                    lastFunc.apply(context, args); // Call with latest args if throttled\r\n                    lastRan = Date.now();\r\n                }\r\n            }, limit);\r\n        } else {\r\n            lastFunc = func; // Store the latest call\r\n        }\r\n    };\r\n};\r\n\r\n// Simple function to format file size\r\nexport const formatFileSize = (bytes, decimals = 2) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const dm = decimals < 0 ? 0 : decimals;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\r\n};\r\n\r\n// Function to generate a simple unique ID (for client-side list keys, etc.)\r\nexport const generateUniqueId = (prefix = 'id') => {\r\n    return `${prefix}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\r\n};\r\n\r\n// Function to safely get nested property\r\nexport const getNestedValue = (obj, path, defaultValue = undefined) => {\r\n    const value = path.split('.').reduce((acc, part) => acc && acc[part], obj);\r\n    return value === undefined ? defaultValue : value;\r\n};\r\n\r\n// Basic HTML escape (can be more comprehensive)\r\nexport const escapeHtml = (unsafe) => {\r\n    if (typeof unsafe !== 'string') return '';\r\n    return unsafe\r\n         .replace(/&/g, \"&\")\r\n         .replace(/</g, \"<\")\r\n         .replace(/>/g, \">\")\r\n         .replace(/\"/g, `\"`)\r\n         .replace(/'/g, \"'\");\r\n};\r\n\r\n// You can add more utility functions here as your project grows.\r\n// For example, date formatting, string manipulation, etc.\r\n\r\n// Example: Truncate text\r\nexport const truncateText = (text, maxLength = 100) => {\r\n    if (!text || text.length <= maxLength) return text;\r\n    return text.substring(0, maxLength) + '...';\r\n};\r\n\r\n// Function to copy text to the clipboard with a fallback for insecure contexts.\r\nexport const copyToClipboard = async (text) => {\r\n  // Use modern clipboard API if available and in a secure context (HTTPS/localhost)\r\n  if (navigator.clipboard && window.isSecureContext) {\r\n    try {\r\n      await navigator.clipboard.writeText(text);\r\n      return true;\r\n    } catch (err) {\r\n      console.error('Async clipboard write failed:', err);\r\n      // Don't automatically fall back, as this could be a permissions error.\r\n      // The primary reason for the fallback is the API not being available at all.\r\n      return false; \r\n    }\r\n  }\r\n\r\n  // Fallback for insecure contexts (e.g., HTTP over LAN) or older browsers\r\n  console.warn('Using legacy document.execCommand for copy.');\r\n  const textArea = document.createElement(\"textarea\");\r\n  textArea.value = text;\r\n\r\n  // Make the textarea invisible and prevent screen from scrolling\r\n  textArea.style.position = 'fixed';\r\n  textArea.style.top = '-9999px';\r\n  textArea.style.left = '-9999px';\r\n\r\n  document.body.appendChild(textArea);\r\n  textArea.focus();\r\n  textArea.select();\r\n\r\n  let success = false;\r\n  try {\r\n    // execCommand is deprecated but has widespread support.\r\n    success = document.execCommand('copy');\r\n  } catch (err) {\r\n    console.error('Legacy clipboard copy failed:', err);\r\n  }\r\n\r\n  document.body.removeChild(textArea);\r\n  return success;\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\utils\\markdownUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\src\\utils\\markdownUtils.jsx","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\$.","line":32,"column":93,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":32,"endColumn":94,"suggestions":[{"messageId":"removeEscape","fix":{"range":[1206,1207],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[1206,1206],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// src/utils/markdownUtils.jsx\r\nimport katex from 'katex';\r\nimport DOMPurify from 'dompurify';\r\n\r\nconst decodeHtmlEntities = (encodedString) => {\r\n  if (typeof encodedString !== 'string') return encodedString;\r\n\r\n  const textarea = document.createElement('textarea');\r\n  textarea.innerHTML = encodedString;\r\n  return textarea.value;\r\n};\r\n\r\nexport const renderMathInHtml = (htmlString) => {\r\n  if (!htmlString || typeof htmlString !== 'string') return htmlString;\r\n\r\n  let processedString = htmlString;\r\n  processedString = processedString.replace(/(?<!\\\\)\\$\\$([\\s\\S]+?)(?<!\\\\)\\$\\$/g, (match, rawExpression) => {\r\n    const expression = decodeHtmlEntities(rawExpression.trim());\r\n    try {\r\n      const rendered = katex.renderToString(expression, { \r\n        displayMode: true, \r\n        throwOnError: false,\r\n        macros: {\"\\\\RR\": \"\\\\mathbb{R}\"} \r\n      });\r\n      return DOMPurify.sanitize(rendered, { USE_PROFILES: { mathMl: true, svg: true, html: true } });\r\n    } catch (e) { \r\n      console.warn(`KaTeX (display) error: ${e.message} for expression: ${expression}`); \r\n      return match; \r\n    }\r\n  });\r\n\r\n  processedString = processedString.replace(/(^|[^$\\\\])\\$(?![\\s$])([^$\\n]+?)(?<![\\s\\\\])\\$([^\\$]|$)/g, (fullMatch, prefix, rawExpression, suffix) => {\r\n    const expression = decodeHtmlEntities(rawExpression.trim());\r\n    if (!expression) return fullMatch; \r\n    try {\r\n      const rendered = katex.renderToString(expression, { \r\n        displayMode: false, \r\n        throwOnError: false,\r\n        macros: {\"\\\\RR\": \"\\\\mathbb{R}\"}\r\n      });\r\n      return prefix + DOMPurify.sanitize(rendered, { USE_PROFILES: { mathMl: true, svg: true, html: true } }) + suffix;\r\n    } catch (e) { \r\n      console.warn(`KaTeX (inline) error: ${e.message} for expression: ${expression}`);\r\n      return fullMatch; \r\n    }\r\n  });\r\n  \r\n  return processedString;\r\n};","usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\tailwind.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"D:\\NIT intern\\iMentor-Team3\\frontend\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]